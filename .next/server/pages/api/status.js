"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/status";
exports.ids = ["pages/api/status"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "ioredis":
/*!**************************!*\
  !*** external "ioredis" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("ioredis");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

module.exports = require("react");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fstatus&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cstatus.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fstatus&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cstatus.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_status_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\status.js */ \"(api)/./pages/api/status.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_status_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_status_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/status\",\n        pathname: \"/api/status\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_status_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnN0YXR1cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDc3RhdHVzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ29EO0FBQ3BEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJpYW5nbGUtaW50ZWxsaWdlbmNlLXBsYXRmb3JtLz83YjMxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcc3RhdHVzLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc3RhdHVzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc3RhdHVzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fstatus&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cstatus.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/environment-validation.js":
/*!***************************************!*\
  !*** ./lib/environment-validation.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getEnvVar: () => (/* binding */ getEnvVar),\n/* harmony export */   getSecurityStatus: () => (/* binding */ getSecurityStatus),\n/* harmony export */   getSupabaseConfig: () => (/* binding */ getSupabaseConfig),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   safeLog: () => (/* binding */ safeLog),\n/* harmony export */   validateAPIKeysSecurity: () => (/* binding */ validateAPIKeysSecurity),\n/* harmony export */   validateEnvironment: () => (/* binding */ validateEnvironment),\n/* harmony export */   validateSecretSecurity: () => (/* binding */ validateSecretSecurity)\n/* harmony export */ });\n/**\n * Environment Variable Validation and Configuration\n * Centralized validation for production readiness\n */ // Required environment variables for production\n// Split by client/server because client can't see server-only vars\nconst CLIENT_REQUIRED_ENV_VARS = [\n    \"NEXT_PUBLIC_SUPABASE_URL\",\n    \"NEXT_PUBLIC_SUPABASE_ANON_KEY\"\n];\nconst SERVER_REQUIRED_ENV_VARS = [\n    \"NEXT_PUBLIC_SUPABASE_URL\",\n    \"NEXT_PUBLIC_SUPABASE_ANON_KEY\",\n    \"SUPABASE_SERVICE_ROLE_KEY\",\n    \"JWT_SECRET\",\n    \"NEXTAUTH_SECRET\"\n];\nconst SERVER_RECOMMENDED_ENV_VARS = [\n    \"ANTHROPIC_API_KEY\",\n    \"COMTRADE_API_KEY\",\n    \"SHIPPO_API_KEY\",\n    \"STRIPE_SECRET_KEY\"\n];\n// Optional environment variables with defaults\nconst OPTIONAL_ENV_VARS = {\n    NODE_ENV: \"development\",\n    NEXT_PUBLIC_APP_URL: \"http://localhost:3000\"\n};\n/**\n * Validate all required environment variables are present\n * @throws {Error} If any required variable is missing\n */ function validateEnvironment() {\n    // Skip validation entirely on client-side to avoid errors\n    if (false) {}\n    // Server-side validation\n    const missing = SERVER_REQUIRED_ENV_VARS.filter((key)=>!process.env[key]);\n    if (missing.length > 0) {\n        throw new Error(`Missing required server-side environment variables: ${missing.join(\", \")}`);\n    }\n    // Note: Using console.log here as this runs before logger is initialized\n    console.log(\"✅ All required environment variables are present\");\n}\n/**\n * Get environment variable with validation\n * @param {string} key - Environment variable key\n * @param {boolean} required - Whether the variable is required\n * @returns {string} Environment variable value\n */ function getEnvVar(key, required = true) {\n    const value = process.env[key];\n    if (required && !value) {\n        throw new Error(`Missing required environment variable: ${key}`);\n    }\n    return value || OPTIONAL_ENV_VARS[key];\n}\n/**\n * Check if running in production\n */ function isProduction() {\n    return \"development\" === \"production\";\n}\n/**\n * Check if running in development\n */ function isDevelopment() {\n    return \"development\" === \"development\";\n}\n/**\n * Safe logging that respects environment\n * Only logs in development unless force is true\n */ function safeLog(message, data = null, force = false) {\n    if (isDevelopment() || force) {\n        if (data) {\n            // Note: Using console.log here as this is used for bootstrap logging\n            console.log(message, data);\n        } else {\n            console.log(message);\n        }\n    }\n}\n/**\n * Get Supabase configuration based on environment\n */ function getSupabaseConfig() {\n    const url = getEnvVar(\"NEXT_PUBLIC_SUPABASE_URL\");\n    // Use service role key on server, anon key on client\n    const key =  false ? 0 : getEnvVar(\"SUPABASE_SERVICE_ROLE_KEY\", false) || getEnvVar(\"NEXT_PUBLIC_SUPABASE_ANON_KEY\");\n    return {\n        url,\n        key\n    };\n}\n/**\n * Validate API keys are not exposed and check for security issues\n */ function validateAPIKeysSecurity() {\n    const sensitiveKeys = [\n        \"SUPABASE_SERVICE_ROLE_KEY\",\n        \"ANTHROPIC_API_KEY\",\n        \"STRIPE_SECRET_KEY\",\n        \"COMTRADE_API_KEY\",\n        \"SHIPPO_API_KEY\",\n        \"JWT_SECRET\",\n        \"NEXTAUTH_SECRET\",\n        \"ENTERPRISE_MASTER_KEY\"\n    ];\n    if (false) {}\n}\n/**\n * Check for dangerous default/template values\n */ function validateSecretSecurity() {\n    const dangerousPatterns = [\n        {\n            key: \"JWT_SECRET\",\n            patterns: [\n                \"your-super-secure\",\n                \"generate-new\",\n                \"REPLACE_WITH\"\n            ]\n        },\n        {\n            key: \"NEXTAUTH_SECRET\",\n            patterns: [\n                \"your-nextauth-secret\",\n                \"generate-new\",\n                \"REPLACE_WITH\"\n            ]\n        },\n        {\n            key: \"ENTERPRISE_MASTER_KEY\",\n            patterns: [\n                \"triangle-intelligence-enterprise\",\n                \"generate-new\",\n                \"REPLACE_WITH\"\n            ]\n        },\n        {\n            key: \"ANTHROPIC_API_KEY\",\n            patterns: [\n                \"your-key-here\",\n                \"REPLACE_WITH\"\n            ]\n        }\n    ];\n    const warnings = [];\n    dangerousPatterns.forEach(({ key, patterns })=>{\n        if (process.env[key]) {\n            patterns.forEach((pattern)=>{\n                if (process.env[key].includes(pattern)) {\n                    warnings.push(`${key} appears to use default/template value`);\n                }\n            });\n        }\n    });\n    // Check secret strength\n    if (process.env.JWT_SECRET && process.env.JWT_SECRET.length < 32) {\n        warnings.push(\"JWT_SECRET is too short (minimum 32 characters)\");\n    }\n    return warnings;\n}\n/**\n * Get comprehensive security status\n */ function getSecurityStatus() {\n    const warnings = validateSecretSecurity();\n    const requiredMissing = SERVER_REQUIRED_ENV_VARS.filter((key)=>!process.env[key]);\n    const recommendedMissing = SERVER_RECOMMENDED_ENV_VARS.filter((key)=>!process.env[key]);\n    return {\n        status: requiredMissing.length === 0 && warnings.length === 0 ? \"secure\" : \"needs_attention\",\n        requiredMissing,\n        recommendedMissing,\n        securityWarnings: warnings,\n        lastChecked: new Date().toISOString()\n    };\n}\n// Auto-validate on import in development (SERVER-SIDE ONLY)\nif (isDevelopment() && \"undefined\" === \"undefined\") {\n    try {\n        validateEnvironment();\n        validateAPIKeysSecurity();\n    } catch (error) {\n        // Note: Using console.error here as this is critical bootstrap error\n        console.error(\"❌ Environment validation failed:\", error.message);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUIsU0FBU0UsT0FBTyxDQUFDQyxDQUFBQTtnQkFDZixJQUFJekIsUUFBUUMsR0FBRyxDQUFDRixJQUFJLENBQUMyQixRQUFRLENBQUNELFVBQVU7b0JBQ3RDRixTQUFTSSxJQUFJLENBQUMsQ0FBQyxFQUFFNUIsSUFBSSxzQ0FBc0MsQ0FBQztnQkFDOUQ7WUFDRjtRQUNGO0lBQ0Y7SUFFQSx3QkFBd0I7SUFDeEIsSUFBSUMsUUFBUUMsR0FBRyxDQUFDMkIsVUFBVSxJQUFJNUIsUUFBUUMsR0FBRyxDQUFDMkIsVUFBVSxDQUFDMUIsTUFBTSxHQUFHLElBQUk7UUFDaEVxQixTQUFTSSxJQUFJLENBQUM7SUFDaEI7SUFFQSxPQUFPSjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxTQUFTTTtJQUNkLE1BQU1OLFdBQVdIO0lBQ2pCLE1BQU1VLGtCQUFrQnpDLHlCQUF5QlMsTUFBTSxDQUFDQyxDQUFBQSxNQUFPLENBQUNDLFFBQVFDLEdBQUcsQ0FBQ0YsSUFBSTtJQUNoRixNQUFNZ0MscUJBQXFCekMsNEJBQTRCUSxNQUFNLENBQUNDLENBQUFBLE1BQU8sQ0FBQ0MsUUFBUUMsR0FBRyxDQUFDRixJQUFJO0lBRXRGLE9BQU87UUFDTGlDLFFBQVFGLGdCQUFnQjVCLE1BQU0sS0FBSyxLQUFLcUIsU0FBU3JCLE1BQU0sS0FBSyxJQUFJLFdBQVc7UUFDM0U0QjtRQUNBQztRQUNBRSxrQkFBa0JWO1FBQ2xCVyxhQUFhLElBQUlDLE9BQU9DLFdBQVc7SUFDckM7QUFDRjtBQUVBLDREQUE0RDtBQUM1RCxJQUFJM0IsbUJBQW1CLGdCQUFrQixhQUFhO0lBQ3BELElBQUk7UUFDRmY7UUFDQXNCO0lBQ0YsRUFBRSxPQUFPcUIsT0FBTztRQUNkLHFFQUFxRTtRQUNyRTFDLFFBQVEwQyxLQUFLLENBQUMsb0NBQW9DQSxNQUFNMUIsT0FBTztJQUNqRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJpYW5nbGUtaW50ZWxsaWdlbmNlLXBsYXRmb3JtLy4vbGliL2Vudmlyb25tZW50LXZhbGlkYXRpb24uanM/OTk2YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVudmlyb25tZW50IFZhcmlhYmxlIFZhbGlkYXRpb24gYW5kIENvbmZpZ3VyYXRpb25cbiAqIENlbnRyYWxpemVkIHZhbGlkYXRpb24gZm9yIHByb2R1Y3Rpb24gcmVhZGluZXNzXG4gKi9cblxuLy8gUmVxdWlyZWQgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciBwcm9kdWN0aW9uXG4vLyBTcGxpdCBieSBjbGllbnQvc2VydmVyIGJlY2F1c2UgY2xpZW50IGNhbid0IHNlZSBzZXJ2ZXItb25seSB2YXJzXG5jb25zdCBDTElFTlRfUkVRVUlSRURfRU5WX1ZBUlMgPSBbXG4gICdORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwnLFxuICAnTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVknXG5dXG5cbmNvbnN0IFNFUlZFUl9SRVFVSVJFRF9FTlZfVkFSUyA9IFtcbiAgJ05FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCcsXG4gICdORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWScsIFxuICAnU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWScsXG4gICdKV1RfU0VDUkVUJyxcbiAgJ05FWFRBVVRIX1NFQ1JFVCdcbl1cblxuY29uc3QgU0VSVkVSX1JFQ09NTUVOREVEX0VOVl9WQVJTID0gW1xuICAnQU5USFJPUElDX0FQSV9LRVknLFxuICAnQ09NVFJBREVfQVBJX0tFWScsIFxuICAnU0hJUFBPX0FQSV9LRVknLFxuICAnU1RSSVBFX1NFQ1JFVF9LRVknXG5dXG5cbi8vIE9wdGlvbmFsIGVudmlyb25tZW50IHZhcmlhYmxlcyB3aXRoIGRlZmF1bHRzXG5jb25zdCBPUFRJT05BTF9FTlZfVkFSUyA9IHtcbiAgTk9ERV9FTlY6ICdkZXZlbG9wbWVudCcsXG4gIE5FWFRfUFVCTElDX0FQUF9VUkw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnXG59XG5cbi8qKlxuICogVmFsaWRhdGUgYWxsIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgcHJlc2VudFxuICogQHRocm93cyB7RXJyb3J9IElmIGFueSByZXF1aXJlZCB2YXJpYWJsZSBpcyBtaXNzaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUVudmlyb25tZW50KCkge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZW50aXJlbHkgb24gY2xpZW50LXNpZGUgdG8gYXZvaWQgZXJyb3JzXG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIGNvbnNvbGUubG9nKCfinIUgRW52aXJvbm1lbnQgdmFsaWRhdGlvbiBza2lwcGVkIG9uIGNsaWVudC1zaWRlJylcbiAgICByZXR1cm5cbiAgfVxuICBcbiAgLy8gU2VydmVyLXNpZGUgdmFsaWRhdGlvblxuICBjb25zdCBtaXNzaW5nID0gU0VSVkVSX1JFUVVJUkVEX0VOVl9WQVJTLmZpbHRlcihrZXkgPT4gIXByb2Nlc3MuZW52W2tleV0pXG4gIFxuICBpZiAobWlzc2luZy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIHJlcXVpcmVkIHNlcnZlci1zaWRlIGVudmlyb25tZW50IHZhcmlhYmxlczogJHttaXNzaW5nLmpvaW4oJywgJyl9YClcbiAgfVxuICBcbiAgLy8gTm90ZTogVXNpbmcgY29uc29sZS5sb2cgaGVyZSBhcyB0aGlzIHJ1bnMgYmVmb3JlIGxvZ2dlciBpcyBpbml0aWFsaXplZFxuICBjb25zb2xlLmxvZygn4pyFIEFsbCByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIHByZXNlbnQnKVxufVxuXG4vKipcbiAqIEdldCBlbnZpcm9ubWVudCB2YXJpYWJsZSB3aXRoIHZhbGlkYXRpb25cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBFbnZpcm9ubWVudCB2YXJpYWJsZSBrZXlcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gcmVxdWlyZWQgLSBXaGV0aGVyIHRoZSB2YXJpYWJsZSBpcyByZXF1aXJlZFxuICogQHJldHVybnMge3N0cmluZ30gRW52aXJvbm1lbnQgdmFyaWFibGUgdmFsdWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVudlZhcihrZXksIHJlcXVpcmVkID0gdHJ1ZSkge1xuICBjb25zdCB2YWx1ZSA9IHByb2Nlc3MuZW52W2tleV1cbiAgXG4gIGlmIChyZXF1aXJlZCAmJiAhdmFsdWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgcmVxdWlyZWQgZW52aXJvbm1lbnQgdmFyaWFibGU6ICR7a2V5fWApXG4gIH1cbiAgXG4gIHJldHVybiB2YWx1ZSB8fCBPUFRJT05BTF9FTlZfVkFSU1trZXldXG59XG5cbi8qKlxuICogQ2hlY2sgaWYgcnVubmluZyBpbiBwcm9kdWN0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb2R1Y3Rpb24oKSB7XG4gIHJldHVybiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nXG59XG5cbi8qKlxuICogQ2hlY2sgaWYgcnVubmluZyBpbiBkZXZlbG9wbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNEZXZlbG9wbWVudCgpIHtcbiAgcmV0dXJuIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnXG59XG5cbi8qKlxuICogU2FmZSBsb2dnaW5nIHRoYXQgcmVzcGVjdHMgZW52aXJvbm1lbnRcbiAqIE9ubHkgbG9ncyBpbiBkZXZlbG9wbWVudCB1bmxlc3MgZm9yY2UgaXMgdHJ1ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2FmZUxvZyhtZXNzYWdlLCBkYXRhID0gbnVsbCwgZm9yY2UgPSBmYWxzZSkge1xuICBpZiAoaXNEZXZlbG9wbWVudCgpIHx8IGZvcmNlKSB7XG4gICAgaWYgKGRhdGEpIHtcbiAgICAgIC8vIE5vdGU6IFVzaW5nIGNvbnNvbGUubG9nIGhlcmUgYXMgdGhpcyBpcyB1c2VkIGZvciBib290c3RyYXAgbG9nZ2luZ1xuICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgZGF0YSlcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2cobWVzc2FnZSlcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgU3VwYWJhc2UgY29uZmlndXJhdGlvbiBiYXNlZCBvbiBlbnZpcm9ubWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3VwYWJhc2VDb25maWcoKSB7XG4gIGNvbnN0IHVybCA9IGdldEVudlZhcignTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMJylcbiAgXG4gIC8vIFVzZSBzZXJ2aWNlIHJvbGUga2V5IG9uIHNlcnZlciwgYW5vbiBrZXkgb24gY2xpZW50XG4gIGNvbnN0IGtleSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgPyBnZXRFbnZWYXIoJ05FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZJylcbiAgICA6IGdldEVudlZhcignU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWScsIGZhbHNlKSB8fCBnZXRFbnZWYXIoJ05FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZJylcbiAgXG4gIHJldHVybiB7IHVybCwga2V5IH1cbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSBBUEkga2V5cyBhcmUgbm90IGV4cG9zZWQgYW5kIGNoZWNrIGZvciBzZWN1cml0eSBpc3N1ZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQVBJS2V5c1NlY3VyaXR5KCkge1xuICBjb25zdCBzZW5zaXRpdmVLZXlzID0gW1xuICAgICdTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZJyxcbiAgICAnQU5USFJPUElDX0FQSV9LRVknLFxuICAgICdTVFJJUEVfU0VDUkVUX0tFWScsXG4gICAgJ0NPTVRSQURFX0FQSV9LRVknLFxuICAgICdTSElQUE9fQVBJX0tFWScsXG4gICAgJ0pXVF9TRUNSRVQnLFxuICAgICdORVhUQVVUSF9TRUNSRVQnLFxuICAgICdFTlRFUlBSSVNFX01BU1RFUl9LRVknXG4gIF1cbiAgXG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIENoZWNrIGlmIGFueSBzZW5zaXRpdmUga2V5cyBhcmUgYWNjZXNzaWJsZSBvbiBjbGllbnRcbiAgICBjb25zdCBleHBvc2VkS2V5cyA9IHNlbnNpdGl2ZUtleXMuZmlsdGVyKGtleSA9PiB3aW5kb3cucHJvY2Vzcz8uZW52Py5ba2V5XSlcbiAgICBcbiAgICBpZiAoZXhwb3NlZEtleXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBTRUNVUklUWSBWSU9MQVRJT046IFNlbnNpdGl2ZSBrZXlzIGV4cG9zZWQgdG8gY2xpZW50OiAke2V4cG9zZWRLZXlzLmpvaW4oJywgJyl9YClcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBmb3IgZGFuZ2Vyb3VzIGRlZmF1bHQvdGVtcGxhdGUgdmFsdWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVNlY3JldFNlY3VyaXR5KCkge1xuICBjb25zdCBkYW5nZXJvdXNQYXR0ZXJucyA9IFtcbiAgICB7IGtleTogJ0pXVF9TRUNSRVQnLCBwYXR0ZXJuczogWyd5b3VyLXN1cGVyLXNlY3VyZScsICdnZW5lcmF0ZS1uZXcnLCAnUkVQTEFDRV9XSVRIJ10gfSxcbiAgICB7IGtleTogJ05FWFRBVVRIX1NFQ1JFVCcsIHBhdHRlcm5zOiBbJ3lvdXItbmV4dGF1dGgtc2VjcmV0JywgJ2dlbmVyYXRlLW5ldycsICdSRVBMQUNFX1dJVEgnXSB9LFxuICAgIHsga2V5OiAnRU5URVJQUklTRV9NQVNURVJfS0VZJywgcGF0dGVybnM6IFsndHJpYW5nbGUtaW50ZWxsaWdlbmNlLWVudGVycHJpc2UnLCAnZ2VuZXJhdGUtbmV3JywgJ1JFUExBQ0VfV0lUSCddIH0sXG4gICAgeyBrZXk6ICdBTlRIUk9QSUNfQVBJX0tFWScsIHBhdHRlcm5zOiBbJ3lvdXIta2V5LWhlcmUnLCAnUkVQTEFDRV9XSVRIJ10gfVxuICBdXG5cbiAgY29uc3Qgd2FybmluZ3MgPSBbXVxuICBcbiAgZGFuZ2Vyb3VzUGF0dGVybnMuZm9yRWFjaCgoeyBrZXksIHBhdHRlcm5zIH0pID0+IHtcbiAgICBpZiAocHJvY2Vzcy5lbnZba2V5XSkge1xuICAgICAgcGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52W2tleV0uaW5jbHVkZXMocGF0dGVybikpIHtcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGAke2tleX0gYXBwZWFycyB0byB1c2UgZGVmYXVsdC90ZW1wbGF0ZSB2YWx1ZWApXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9KVxuXG4gIC8vIENoZWNrIHNlY3JldCBzdHJlbmd0aFxuICBpZiAocHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCAmJiBwcm9jZXNzLmVudi5KV1RfU0VDUkVULmxlbmd0aCA8IDMyKSB7XG4gICAgd2FybmluZ3MucHVzaCgnSldUX1NFQ1JFVCBpcyB0b28gc2hvcnQgKG1pbmltdW0gMzIgY2hhcmFjdGVycyknKVxuICB9XG5cbiAgcmV0dXJuIHdhcm5pbmdzXG59XG5cbi8qKlxuICogR2V0IGNvbXByZWhlbnNpdmUgc2VjdXJpdHkgc3RhdHVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZWN1cml0eVN0YXR1cygpIHtcbiAgY29uc3Qgd2FybmluZ3MgPSB2YWxpZGF0ZVNlY3JldFNlY3VyaXR5KClcbiAgY29uc3QgcmVxdWlyZWRNaXNzaW5nID0gU0VSVkVSX1JFUVVJUkVEX0VOVl9WQVJTLmZpbHRlcihrZXkgPT4gIXByb2Nlc3MuZW52W2tleV0pXG4gIGNvbnN0IHJlY29tbWVuZGVkTWlzc2luZyA9IFNFUlZFUl9SRUNPTU1FTkRFRF9FTlZfVkFSUy5maWx0ZXIoa2V5ID0+ICFwcm9jZXNzLmVudltrZXldKVxuICBcbiAgcmV0dXJuIHtcbiAgICBzdGF0dXM6IHJlcXVpcmVkTWlzc2luZy5sZW5ndGggPT09IDAgJiYgd2FybmluZ3MubGVuZ3RoID09PSAwID8gJ3NlY3VyZScgOiAnbmVlZHNfYXR0ZW50aW9uJyxcbiAgICByZXF1aXJlZE1pc3NpbmcsXG4gICAgcmVjb21tZW5kZWRNaXNzaW5nLFxuICAgIHNlY3VyaXR5V2FybmluZ3M6IHdhcm5pbmdzLFxuICAgIGxhc3RDaGVja2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgfVxufVxuXG4vLyBBdXRvLXZhbGlkYXRlIG9uIGltcG9ydCBpbiBkZXZlbG9wbWVudCAoU0VSVkVSLVNJREUgT05MWSlcbmlmIChpc0RldmVsb3BtZW50KCkgJiYgdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdHJ5IHtcbiAgICB2YWxpZGF0ZUVudmlyb25tZW50KClcbiAgICB2YWxpZGF0ZUFQSUtleXNTZWN1cml0eSgpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gTm90ZTogVXNpbmcgY29uc29sZS5lcnJvciBoZXJlIGFzIHRoaXMgaXMgY3JpdGljYWwgYm9vdHN0cmFwIGVycm9yXG4gICAgY29uc29sZS5lcnJvcign4p2MIEVudmlyb25tZW50IHZhbGlkYXRpb24gZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gIH1cbn0iXSwibmFtZXMiOlsiQ0xJRU5UX1JFUVVJUkVEX0VOVl9WQVJTIiwiU0VSVkVSX1JFUVVJUkVEX0VOVl9WQVJTIiwiU0VSVkVSX1JFQ09NTUVOREVEX0VOVl9WQVJTIiwiT1BUSU9OQUxfRU5WX1ZBUlMiLCJOT0RFX0VOViIsIk5FWFRfUFVCTElDX0FQUF9VUkwiLCJ2YWxpZGF0ZUVudmlyb25tZW50IiwiY29uc29sZSIsImxvZyIsIm1pc3NpbmciLCJmaWx0ZXIiLCJrZXkiLCJwcm9jZXNzIiwiZW52IiwibGVuZ3RoIiwiRXJyb3IiLCJqb2luIiwiZ2V0RW52VmFyIiwicmVxdWlyZWQiLCJ2YWx1ZSIsImlzUHJvZHVjdGlvbiIsImlzRGV2ZWxvcG1lbnQiLCJzYWZlTG9nIiwibWVzc2FnZSIsImRhdGEiLCJmb3JjZSIsImdldFN1cGFiYXNlQ29uZmlnIiwidXJsIiwidmFsaWRhdGVBUElLZXlzU2VjdXJpdHkiLCJzZW5zaXRpdmVLZXlzIiwiZXhwb3NlZEtleXMiLCJ3aW5kb3ciLCJ2YWxpZGF0ZVNlY3JldFNlY3VyaXR5IiwiZGFuZ2Vyb3VzUGF0dGVybnMiLCJwYXR0ZXJucyIsIndhcm5pbmdzIiwiZm9yRWFjaCIsInBhdHRlcm4iLCJpbmNsdWRlcyIsInB1c2giLCJKV1RfU0VDUkVUIiwiZ2V0U2VjdXJpdHlTdGF0dXMiLCJyZXF1aXJlZE1pc3NpbmciLCJyZWNvbW1lbmRlZE1pc3NpbmciLCJzdGF0dXMiLCJzZWN1cml0eVdhcm5pbmdzIiwibGFzdENoZWNrZWQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/environment-validation.js\n");

/***/ }),

/***/ "(api)/./lib/memory-optimizer.js":
/*!*********************************!*\
  !*** ./lib/memory-optimizer.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getMemoryOptimizer: () => (/* binding */ getMemoryOptimizer),\n/* harmony export */   memoryOptimizedAPICall: () => (/* binding */ memoryOptimizedAPICall),\n/* harmony export */   useMemoryOptimizedEffect: () => (/* binding */ useMemoryOptimizedEffect)\n/* harmony export */ });\n/* harmony import */ var _production_logger_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./production-logger.js */ \"(api)/./lib/production-logger.js\");\n/**\n * 🧠 MEMORY OPTIMIZER - PRODUCTION MEMORY MANAGEMENT\n * \n * Comprehensive memory management system for Triangle Intelligence Platform\n * Eliminates memory leaks while maintaining 30-second real-time updates\n * \n * KEY FEATURES:\n * ✅ Process event listener cleanup\n * ✅ React component unmount handlers  \n * ✅ API call cancellation with AbortController\n * ✅ RSS monitoring cleanup\n * ✅ Beast Master resource management\n * ✅ Database connection pooling optimization\n * ✅ Automatic memory pressure detection\n */ \nclass MemoryOptimizer {\n    constructor(){\n        this.lastLogTime = 0;\n        this.cleanupHandlers = new Map();\n        this.intervalCleanup = new Map();\n        this.timeoutCleanup = new Map();\n        this.eventListeners = new Map();\n        this.abortControllers = new Set();\n        // Environment-based configuration (CRITICAL FIX)\n        this.memoryPressureThreshold = (parseInt(process.env.MEMORY_PRESSURE_THRESHOLD_MB) || 512) * 1024 * 1024;\n        this.gcThreshold = (parseInt(process.env.MEMORY_GC_THRESHOLD_MB) || 768) * 1024 * 1024;\n        this.monitorInterval = parseInt(process.env.MEMORY_MONITOR_INTERVAL_MS) || 60000;\n        this.isInitialized = false;\n        this.lastCleanupTime = 0;\n        this.initializeMemoryMonitoring();\n    }\n    /**\n   * Initialize memory monitoring and cleanup systems\n   */ initializeMemoryMonitoring() {\n        if (this.isInitialized) return;\n        // Only run in server environment\n        if (typeof process === \"undefined\" || \"undefined\" !== \"undefined\") {\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(\"Memory Optimizer: Browser environment detected, limited functionality enabled\");\n            this.isInitialized = true;\n            return;\n        }\n        // Monitor memory usage based on environment configuration\n        const memoryMonitor = setInterval(()=>{\n            this.checkMemoryPressure();\n        }, this.monitorInterval);\n        this.registerCleanup(\"memoryMonitor\", ()=>clearInterval(memoryMonitor));\n        // Process cleanup handlers\n        const processCleanup = ()=>{\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(\"Memory Optimizer: Initiating graceful shutdown\");\n            this.performGlobalCleanup();\n            process.exit(0);\n        };\n        // Register process event listeners with proper cleanup\n        process.removeAllListeners(\"SIGTERM\");\n        process.removeAllListeners(\"SIGINT\");\n        process.removeAllListeners(\"uncaughtException\");\n        process.removeAllListeners(\"unhandledRejection\");\n        process.once(\"SIGTERM\", processCleanup);\n        process.once(\"SIGINT\", processCleanup);\n        process.on(\"uncaughtException\", (error)=>{\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logError)(\"Uncaught Exception - initiating cleanup\", {\n                error: error.message\n            });\n            this.performGlobalCleanup();\n            process.exit(1);\n        });\n        process.on(\"unhandledRejection\", (reason, promise)=>{\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logError)(\"Unhandled Promise Rejection - cleaning up\", {\n                reason: reason?.message || reason,\n                stack: reason?.stack\n            });\n        });\n        this.isInitialized = true;\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(\"Memory Optimizer initialized successfully\");\n    }\n    /**\n   * Register cleanup handler for a specific resource\n   */ registerCleanup(id, cleanupFunction) {\n        if (this.cleanupHandlers.has(id)) {\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(`Cleanup handler already registered for: ${id}`);\n            this.cleanupHandlers.get(id)(); // Clean up old one first\n        }\n        this.cleanupHandlers.set(id, cleanupFunction);\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(`Registered cleanup handler: ${id}`);\n    }\n    /**\n   * Register interval with automatic cleanup\n   */ registerInterval(id, intervalId) {\n        if (this.intervalCleanup.has(id)) {\n            clearInterval(this.intervalCleanup.get(id));\n        }\n        this.intervalCleanup.set(id, intervalId);\n        // Auto-cleanup after 10 minutes to prevent accumulation\n        setTimeout(()=>{\n            if (this.intervalCleanup.has(id)) {\n                clearInterval(this.intervalCleanup.get(id));\n                this.intervalCleanup.delete(id);\n                (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(`Auto-cleaned interval: ${id}`);\n            }\n        }, 600000); // 10 minutes\n    }\n    /**\n   * Register timeout with automatic cleanup\n   */ registerTimeout(id, timeoutId) {\n        if (this.timeoutCleanup.has(id)) {\n            clearTimeout(this.timeoutCleanup.get(id));\n        }\n        this.timeoutCleanup.set(id, timeoutId);\n    }\n    /**\n   * Create and register AbortController for API calls\n   */ createAbortController(timeoutMs = 30000) {\n        const controller = new AbortController();\n        this.abortControllers.add(controller);\n        // Auto-abort after timeout to prevent hanging requests\n        const timeoutId = setTimeout(()=>{\n            if (!controller.signal.aborted) {\n                controller.abort();\n                this.abortControllers.delete(controller);\n                (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(\"Auto-aborted API request due to timeout\");\n            }\n        }, timeoutMs);\n        // Clean up timeout when controller is aborted\n        controller.signal.addEventListener(\"abort\", ()=>{\n            clearTimeout(timeoutId);\n            this.abortControllers.delete(controller);\n        });\n        return controller;\n    }\n    /**\n   * React useEffect cleanup helper\n   */ createReactCleanup() {\n        const cleanupFunctions = [];\n        return {\n            register: (cleanupFn)=>{\n                cleanupFunctions.push(cleanupFn);\n            },\n            cleanup: ()=>{\n                cleanupFunctions.forEach((fn, index)=>{\n                    try {\n                        fn();\n                    } catch (error) {\n                        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logError)(`React cleanup function ${index} failed`, {\n                            error: error.message\n                        });\n                    }\n                });\n                cleanupFunctions.length = 0;\n            }\n        };\n    }\n    /**\n   * Check memory pressure and trigger cleanup if needed - OPTIMIZED\n   */ checkMemoryPressure() {\n        // Only run memory checks in server environment\n        if (typeof process === \"undefined\" || \"undefined\" !== \"undefined\") {\n            return;\n        }\n        const memUsage = process.memoryUsage();\n        const heapUsed = memUsage.heapUsed;\n        const external = memUsage.external;\n        const totalMemory = heapUsed + external;\n        const totalMemoryMB = Math.round(totalMemory / 1024 / 1024);\n        const thresholdMB = Math.round(this.memoryPressureThreshold / 1024 / 1024);\n        const gcThresholdMB = Math.round(this.gcThreshold / 1024 / 1024);\n        // CRITICAL FIX: Only log when threshold exceeded or every 5 minutes\n        const now = Date.now();\n        const shouldLog = totalMemory > this.memoryPressureThreshold || now - this.lastLogTime > 300000;\n        if (shouldLog) {\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(\"Memory usage check\", {\n                heapUsed: Math.round(heapUsed / 1024 / 1024) + \"MB\",\n                external: Math.round(external / 1024 / 1024) + \"MB\",\n                total: totalMemoryMB + \"MB\",\n                threshold: thresholdMB + \"MB\",\n                gcThreshold: gcThresholdMB + \"MB\"\n            });\n            this.lastLogTime = now;\n        }\n        // Trigger cleanup if memory usage is high AND enough time has passed\n        if (totalMemory > this.memoryPressureThreshold && now - this.lastCleanupTime > 60000) {\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(\"Memory pressure detected, triggering cleanup\", {\n                memoryMB: totalMemoryMB,\n                thresholdMB: thresholdMB\n            });\n            this.performMemoryCleanup();\n            this.lastCleanupTime = now;\n        }\n        // Force garbage collection if memory is very high\n        if (totalMemory > this.gcThreshold && global.gc) {\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(\"High memory usage, forcing garbage collection\", {\n                memoryMB: totalMemoryMB,\n                gcThresholdMB: gcThresholdMB\n            });\n            global.gc();\n        }\n    }\n    /**\n   * Perform memory cleanup operations\n   */ performMemoryCleanup() {\n        let cleaned = 0;\n        // Clean up old intervals (older than 5 minutes)\n        const now = Date.now();\n        for (const [id, data] of this.intervalCleanup.entries()){\n            if (typeof data === \"object\" && data.timestamp && now - data.timestamp > 300000) {\n                clearInterval(data.intervalId);\n                this.intervalCleanup.delete(id);\n                cleaned++;\n            }\n        }\n        // Clean up old timeouts\n        for (const [id, timeoutId] of this.timeoutCleanup.entries()){\n            clearTimeout(timeoutId);\n            this.timeoutCleanup.delete(id);\n            cleaned++;\n        }\n        // Abort old API requests\n        for (const controller of this.abortControllers){\n            if (!controller.signal.aborted) {\n                controller.abort();\n                cleaned++;\n            }\n        }\n        this.abortControllers.clear();\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(`Memory cleanup completed, cleaned ${cleaned} resources`);\n    }\n    /**\n   * Perform global cleanup on shutdown\n   */ performGlobalCleanup() {\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(\"Performing global cleanup\");\n        // Run all registered cleanup handlers\n        for (const [id, cleanupFn] of this.cleanupHandlers.entries()){\n            try {\n                cleanupFn();\n                (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(`Cleaned up: ${id}`);\n            } catch (error) {\n                (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logError)(`Cleanup failed for: ${id}`, {\n                    error: error.message\n                });\n            }\n        }\n        // Clear all intervals and timeouts\n        for (const intervalId of this.intervalCleanup.values()){\n            clearInterval(typeof intervalId === \"object\" ? intervalId.intervalId : intervalId);\n        }\n        for (const timeoutId of this.timeoutCleanup.values()){\n            clearTimeout(timeoutId);\n        }\n        // Abort all pending requests\n        for (const controller of this.abortControllers){\n            controller.abort();\n        }\n        // Clear maps\n        this.cleanupHandlers.clear();\n        this.intervalCleanup.clear();\n        this.timeoutCleanup.clear();\n        this.abortControllers.clear();\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(\"Global cleanup completed\");\n    }\n    /**\n   * Get memory statistics\n   */ getMemoryStats() {\n        if (typeof process === \"undefined\" || \"undefined\" !== \"undefined\") {\n            return {\n                available: false,\n                environment: \"browser\",\n                cleanupHandlers: this.cleanupHandlers.size,\n                activeIntervals: this.intervalCleanup.size,\n                activeTimeouts: this.timeoutCleanup.size,\n                activeRequests: this.abortControllers.size\n            };\n        }\n        const memUsage = process.memoryUsage();\n        return {\n            available: true,\n            environment: \"server\",\n            heap: {\n                used: Math.round(memUsage.heapUsed / 1024 / 1024),\n                total: Math.round(memUsage.heapTotal / 1024 / 1024)\n            },\n            external: Math.round(memUsage.external / 1024 / 1024),\n            cleanupHandlers: this.cleanupHandlers.size,\n            activeIntervals: this.intervalCleanup.size,\n            activeTimeouts: this.timeoutCleanup.size,\n            activeRequests: this.abortControllers.size\n        };\n    }\n}\n// Global singleton instance\nlet memoryOptimizer = null;\nfunction getMemoryOptimizer() {\n    if (!memoryOptimizer) {\n        memoryOptimizer = new MemoryOptimizer();\n    }\n    return memoryOptimizer;\n}\n// React hook for memory-optimized effects\nfunction useMemoryOptimizedEffect(effect, deps) {\n    const React = __webpack_require__(/*! react */ \"react\");\n    React.useEffect(()=>{\n        const optimizer = getMemoryOptimizer();\n        const reactCleanup = optimizer.createReactCleanup();\n        const cleanup = effect(reactCleanup.register);\n        return ()=>{\n            reactCleanup.cleanup();\n            if (cleanup) cleanup();\n        };\n    }, deps);\n}\n// API call helper with automatic cleanup\nasync function memoryOptimizedAPICall(url, options = {}, timeoutMs = 30000) {\n    const optimizer = getMemoryOptimizer();\n    const controller = optimizer.createAbortController(timeoutMs);\n    try {\n        const response = await fetch(url, {\n            ...options,\n            signal: controller.signal\n        });\n        return response;\n    } catch (error) {\n        if (error.name === \"AbortError\") {\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(\"API call was aborted\", {\n                url\n            });\n            throw new Error(\"Request timeout\");\n        }\n        throw error;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (getMemoryOptimizer);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTXNGLElBQUksS0FBSyxjQUFjO1lBQy9CeEgsOERBQU9BLENBQUMsd0JBQXdCO2dCQUFFb0g7WUFBSTtZQUN0QyxNQUFNLElBQUlLLE1BQU07UUFDbEI7UUFDQSxNQUFNdkY7SUFDUjtBQUNGO0FBRUEsaUVBQWV3RSxrQkFBa0JBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmlhbmdsZS1pbnRlbGxpZ2VuY2UtcGxhdGZvcm0vLi9saWIvbWVtb3J5LW9wdGltaXplci5qcz85Y2Q1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog8J+noCBNRU1PUlkgT1BUSU1JWkVSIC0gUFJPRFVDVElPTiBNRU1PUlkgTUFOQUdFTUVOVFxuICogXG4gKiBDb21wcmVoZW5zaXZlIG1lbW9yeSBtYW5hZ2VtZW50IHN5c3RlbSBmb3IgVHJpYW5nbGUgSW50ZWxsaWdlbmNlIFBsYXRmb3JtXG4gKiBFbGltaW5hdGVzIG1lbW9yeSBsZWFrcyB3aGlsZSBtYWludGFpbmluZyAzMC1zZWNvbmQgcmVhbC10aW1lIHVwZGF0ZXNcbiAqIFxuICogS0VZIEZFQVRVUkVTOlxuICog4pyFIFByb2Nlc3MgZXZlbnQgbGlzdGVuZXIgY2xlYW51cFxuICog4pyFIFJlYWN0IGNvbXBvbmVudCB1bm1vdW50IGhhbmRsZXJzICBcbiAqIOKchSBBUEkgY2FsbCBjYW5jZWxsYXRpb24gd2l0aCBBYm9ydENvbnRyb2xsZXJcbiAqIOKchSBSU1MgbW9uaXRvcmluZyBjbGVhbnVwXG4gKiDinIUgQmVhc3QgTWFzdGVyIHJlc291cmNlIG1hbmFnZW1lbnRcbiAqIOKchSBEYXRhYmFzZSBjb25uZWN0aW9uIHBvb2xpbmcgb3B0aW1pemF0aW9uXG4gKiDinIUgQXV0b21hdGljIG1lbW9yeSBwcmVzc3VyZSBkZXRlY3Rpb25cbiAqL1xuXG5pbXBvcnQgeyBsb2dJbmZvLCBsb2dFcnJvciwgbG9nV2FybiB9IGZyb20gJy4vcHJvZHVjdGlvbi1sb2dnZXIuanMnO1xuXG5jbGFzcyBNZW1vcnlPcHRpbWl6ZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmxhc3RMb2dUaW1lID0gMDtcbiAgICB0aGlzLmNsZWFudXBIYW5kbGVycyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLmludGVydmFsQ2xlYW51cCA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLnRpbWVvdXRDbGVhbnVwID0gbmV3IE1hcCgpO1xuICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMgPSBuZXcgTWFwKCk7XG4gICAgdGhpcy5hYm9ydENvbnRyb2xsZXJzID0gbmV3IFNldCgpO1xuICAgIFxuICAgIC8vIEVudmlyb25tZW50LWJhc2VkIGNvbmZpZ3VyYXRpb24gKENSSVRJQ0FMIEZJWClcbiAgICB0aGlzLm1lbW9yeVByZXNzdXJlVGhyZXNob2xkID0gKHBhcnNlSW50KHByb2Nlc3MuZW52Lk1FTU9SWV9QUkVTU1VSRV9USFJFU0hPTERfTUIpIHx8IDUxMikgKiAxMDI0ICogMTAyNDtcbiAgICB0aGlzLmdjVGhyZXNob2xkID0gKHBhcnNlSW50KHByb2Nlc3MuZW52Lk1FTU9SWV9HQ19USFJFU0hPTERfTUIpIHx8IDc2OCkgKiAxMDI0ICogMTAyNDtcbiAgICB0aGlzLm1vbml0b3JJbnRlcnZhbCA9IHBhcnNlSW50KHByb2Nlc3MuZW52Lk1FTU9SWV9NT05JVE9SX0lOVEVSVkFMX01TKSB8fCA2MDAwMDtcbiAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmxhc3RDbGVhbnVwVGltZSA9IDA7XG4gICAgXG4gICAgdGhpcy5pbml0aWFsaXplTWVtb3J5TW9uaXRvcmluZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgbWVtb3J5IG1vbml0b3JpbmcgYW5kIGNsZWFudXAgc3lzdGVtc1xuICAgKi9cbiAgaW5pdGlhbGl6ZU1lbW9yeU1vbml0b3JpbmcoKSB7XG4gICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZCkgcmV0dXJuO1xuXG4gICAgLy8gT25seSBydW4gaW4gc2VydmVyIGVudmlyb25tZW50XG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgbG9nSW5mbygnTWVtb3J5IE9wdGltaXplcjogQnJvd3NlciBlbnZpcm9ubWVudCBkZXRlY3RlZCwgbGltaXRlZCBmdW5jdGlvbmFsaXR5IGVuYWJsZWQnKTtcbiAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gTW9uaXRvciBtZW1vcnkgdXNhZ2UgYmFzZWQgb24gZW52aXJvbm1lbnQgY29uZmlndXJhdGlvblxuICAgIGNvbnN0IG1lbW9yeU1vbml0b3IgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLmNoZWNrTWVtb3J5UHJlc3N1cmUoKTtcbiAgICB9LCB0aGlzLm1vbml0b3JJbnRlcnZhbCk7XG4gICAgXG4gICAgdGhpcy5yZWdpc3RlckNsZWFudXAoJ21lbW9yeU1vbml0b3InLCAoKSA9PiBjbGVhckludGVydmFsKG1lbW9yeU1vbml0b3IpKTtcblxuICAgIC8vIFByb2Nlc3MgY2xlYW51cCBoYW5kbGVyc1xuICAgIGNvbnN0IHByb2Nlc3NDbGVhbnVwID0gKCkgPT4ge1xuICAgICAgbG9nSW5mbygnTWVtb3J5IE9wdGltaXplcjogSW5pdGlhdGluZyBncmFjZWZ1bCBzaHV0ZG93bicpO1xuICAgICAgdGhpcy5wZXJmb3JtR2xvYmFsQ2xlYW51cCgpO1xuICAgICAgcHJvY2Vzcy5leGl0KDApO1xuICAgIH07XG5cbiAgICAvLyBSZWdpc3RlciBwcm9jZXNzIGV2ZW50IGxpc3RlbmVycyB3aXRoIHByb3BlciBjbGVhbnVwXG4gICAgcHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ1NJR1RFUk0nKTtcbiAgICBwcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycygnU0lHSU5UJyk7XG4gICAgcHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3VuY2F1Z2h0RXhjZXB0aW9uJyk7XG4gICAgcHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3VuaGFuZGxlZFJlamVjdGlvbicpO1xuXG4gICAgcHJvY2Vzcy5vbmNlKCdTSUdURVJNJywgcHJvY2Vzc0NsZWFudXApO1xuICAgIHByb2Nlc3Mub25jZSgnU0lHSU5UJywgcHJvY2Vzc0NsZWFudXApO1xuICAgIFxuICAgIHByb2Nlc3Mub24oJ3VuY2F1Z2h0RXhjZXB0aW9uJywgKGVycm9yKSA9PiB7XG4gICAgICBsb2dFcnJvcignVW5jYXVnaHQgRXhjZXB0aW9uIC0gaW5pdGlhdGluZyBjbGVhbnVwJywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcbiAgICAgIHRoaXMucGVyZm9ybUdsb2JhbENsZWFudXAoKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9KTtcblxuICAgIHByb2Nlc3Mub24oJ3VuaGFuZGxlZFJlamVjdGlvbicsIChyZWFzb24sIHByb21pc2UpID0+IHtcbiAgICAgIGxvZ0Vycm9yKCdVbmhhbmRsZWQgUHJvbWlzZSBSZWplY3Rpb24gLSBjbGVhbmluZyB1cCcsIHsgXG4gICAgICAgIHJlYXNvbjogcmVhc29uPy5tZXNzYWdlIHx8IHJlYXNvbixcbiAgICAgICAgc3RhY2s6IHJlYXNvbj8uc3RhY2sgXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgbG9nSW5mbygnTWVtb3J5IE9wdGltaXplciBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHknKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBjbGVhbnVwIGhhbmRsZXIgZm9yIGEgc3BlY2lmaWMgcmVzb3VyY2VcbiAgICovXG4gIHJlZ2lzdGVyQ2xlYW51cChpZCwgY2xlYW51cEZ1bmN0aW9uKSB7XG4gICAgaWYgKHRoaXMuY2xlYW51cEhhbmRsZXJzLmhhcyhpZCkpIHtcbiAgICAgIGxvZ1dhcm4oYENsZWFudXAgaGFuZGxlciBhbHJlYWR5IHJlZ2lzdGVyZWQgZm9yOiAke2lkfWApO1xuICAgICAgdGhpcy5jbGVhbnVwSGFuZGxlcnMuZ2V0KGlkKSgpOyAvLyBDbGVhbiB1cCBvbGQgb25lIGZpcnN0XG4gICAgfVxuICAgIFxuICAgIHRoaXMuY2xlYW51cEhhbmRsZXJzLnNldChpZCwgY2xlYW51cEZ1bmN0aW9uKTtcbiAgICBsb2dJbmZvKGBSZWdpc3RlcmVkIGNsZWFudXAgaGFuZGxlcjogJHtpZH1gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBpbnRlcnZhbCB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwXG4gICAqL1xuICByZWdpc3RlckludGVydmFsKGlkLCBpbnRlcnZhbElkKSB7XG4gICAgaWYgKHRoaXMuaW50ZXJ2YWxDbGVhbnVwLmhhcyhpZCkpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbENsZWFudXAuZ2V0KGlkKSk7XG4gICAgfVxuICAgIFxuICAgIHRoaXMuaW50ZXJ2YWxDbGVhbnVwLnNldChpZCwgaW50ZXJ2YWxJZCk7XG4gICAgXG4gICAgLy8gQXV0by1jbGVhbnVwIGFmdGVyIDEwIG1pbnV0ZXMgdG8gcHJldmVudCBhY2N1bXVsYXRpb25cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmICh0aGlzLmludGVydmFsQ2xlYW51cC5oYXMoaWQpKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbENsZWFudXAuZ2V0KGlkKSk7XG4gICAgICAgIHRoaXMuaW50ZXJ2YWxDbGVhbnVwLmRlbGV0ZShpZCk7XG4gICAgICAgIGxvZ0luZm8oYEF1dG8tY2xlYW5lZCBpbnRlcnZhbDogJHtpZH1gKTtcbiAgICAgIH1cbiAgICB9LCA2MDAwMDApOyAvLyAxMCBtaW51dGVzXG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgdGltZW91dCB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwXG4gICAqL1xuICByZWdpc3RlclRpbWVvdXQoaWQsIHRpbWVvdXRJZCkge1xuICAgIGlmICh0aGlzLnRpbWVvdXRDbGVhbnVwLmhhcyhpZCkpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRDbGVhbnVwLmdldChpZCkpO1xuICAgIH1cbiAgICBcbiAgICB0aGlzLnRpbWVvdXRDbGVhbnVwLnNldChpZCwgdGltZW91dElkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYW5kIHJlZ2lzdGVyIEFib3J0Q29udHJvbGxlciBmb3IgQVBJIGNhbGxzXG4gICAqL1xuICBjcmVhdGVBYm9ydENvbnRyb2xsZXIodGltZW91dE1zID0gMzAwMDApIHtcbiAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgIHRoaXMuYWJvcnRDb250cm9sbGVycy5hZGQoY29udHJvbGxlcik7XG5cbiAgICAvLyBBdXRvLWFib3J0IGFmdGVyIHRpbWVvdXQgdG8gcHJldmVudCBoYW5naW5nIHJlcXVlc3RzXG4gICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoIWNvbnRyb2xsZXIuc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICB0aGlzLmFib3J0Q29udHJvbGxlcnMuZGVsZXRlKGNvbnRyb2xsZXIpO1xuICAgICAgICBsb2dJbmZvKCdBdXRvLWFib3J0ZWQgQVBJIHJlcXVlc3QgZHVlIHRvIHRpbWVvdXQnKTtcbiAgICAgIH1cbiAgICB9LCB0aW1lb3V0TXMpO1xuXG4gICAgLy8gQ2xlYW4gdXAgdGltZW91dCB3aGVuIGNvbnRyb2xsZXIgaXMgYWJvcnRlZFxuICAgIGNvbnRyb2xsZXIuc2lnbmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgKCkgPT4ge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICB0aGlzLmFib3J0Q29udHJvbGxlcnMuZGVsZXRlKGNvbnRyb2xsZXIpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNvbnRyb2xsZXI7XG4gIH1cblxuICAvKipcbiAgICogUmVhY3QgdXNlRWZmZWN0IGNsZWFudXAgaGVscGVyXG4gICAqL1xuICBjcmVhdGVSZWFjdENsZWFudXAoKSB7XG4gICAgY29uc3QgY2xlYW51cEZ1bmN0aW9ucyA9IFtdO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICByZWdpc3RlcjogKGNsZWFudXBGbikgPT4ge1xuICAgICAgICBjbGVhbnVwRnVuY3Rpb25zLnB1c2goY2xlYW51cEZuKTtcbiAgICAgIH0sXG4gICAgICBjbGVhbnVwOiAoKSA9PiB7XG4gICAgICAgIGNsZWFudXBGdW5jdGlvbnMuZm9yRWFjaCgoZm4sIGluZGV4KSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGxvZ0Vycm9yKGBSZWFjdCBjbGVhbnVwIGZ1bmN0aW9uICR7aW5kZXh9IGZhaWxlZGAsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY2xlYW51cEZ1bmN0aW9ucy5sZW5ndGggPSAwO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgbWVtb3J5IHByZXNzdXJlIGFuZCB0cmlnZ2VyIGNsZWFudXAgaWYgbmVlZGVkIC0gT1BUSU1JWkVEXG4gICAqL1xuICBjaGVja01lbW9yeVByZXNzdXJlKCkge1xuICAgIC8vIE9ubHkgcnVuIG1lbW9yeSBjaGVja3MgaW4gc2VydmVyIGVudmlyb25tZW50XG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG1lbVVzYWdlID0gcHJvY2Vzcy5tZW1vcnlVc2FnZSgpO1xuICAgIGNvbnN0IGhlYXBVc2VkID0gbWVtVXNhZ2UuaGVhcFVzZWQ7XG4gICAgY29uc3QgZXh0ZXJuYWwgPSBtZW1Vc2FnZS5leHRlcm5hbDtcbiAgICBjb25zdCB0b3RhbE1lbW9yeSA9IGhlYXBVc2VkICsgZXh0ZXJuYWw7XG4gICAgXG4gICAgY29uc3QgdG90YWxNZW1vcnlNQiA9IE1hdGgucm91bmQodG90YWxNZW1vcnkgLyAxMDI0IC8gMTAyNCk7XG4gICAgY29uc3QgdGhyZXNob2xkTUIgPSBNYXRoLnJvdW5kKHRoaXMubWVtb3J5UHJlc3N1cmVUaHJlc2hvbGQgLyAxMDI0IC8gMTAyNCk7XG4gICAgY29uc3QgZ2NUaHJlc2hvbGRNQiA9IE1hdGgucm91bmQodGhpcy5nY1RocmVzaG9sZCAvIDEwMjQgLyAxMDI0KTtcblxuICAgIC8vIENSSVRJQ0FMIEZJWDogT25seSBsb2cgd2hlbiB0aHJlc2hvbGQgZXhjZWVkZWQgb3IgZXZlcnkgNSBtaW51dGVzXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBzaG91bGRMb2cgPSB0b3RhbE1lbW9yeSA+IHRoaXMubWVtb3J5UHJlc3N1cmVUaHJlc2hvbGQgfHwgKG5vdyAtIHRoaXMubGFzdExvZ1RpbWUgPiAzMDAwMDApO1xuICAgIFxuICAgIGlmIChzaG91bGRMb2cpIHtcbiAgICAgIGxvZ0luZm8oJ01lbW9yeSB1c2FnZSBjaGVjaycsIHtcbiAgICAgICAgaGVhcFVzZWQ6IE1hdGgucm91bmQoaGVhcFVzZWQgLyAxMDI0IC8gMTAyNCkgKyAnTUInLFxuICAgICAgICBleHRlcm5hbDogTWF0aC5yb3VuZChleHRlcm5hbCAvIDEwMjQgLyAxMDI0KSArICdNQicsXG4gICAgICAgIHRvdGFsOiB0b3RhbE1lbW9yeU1CICsgJ01CJyxcbiAgICAgICAgdGhyZXNob2xkOiB0aHJlc2hvbGRNQiArICdNQicsXG4gICAgICAgIGdjVGhyZXNob2xkOiBnY1RocmVzaG9sZE1CICsgJ01CJ1xuICAgICAgfSk7XG4gICAgICB0aGlzLmxhc3RMb2dUaW1lID0gbm93O1xuICAgIH1cblxuICAgIC8vIFRyaWdnZXIgY2xlYW51cCBpZiBtZW1vcnkgdXNhZ2UgaXMgaGlnaCBBTkQgZW5vdWdoIHRpbWUgaGFzIHBhc3NlZFxuICAgIGlmICh0b3RhbE1lbW9yeSA+IHRoaXMubWVtb3J5UHJlc3N1cmVUaHJlc2hvbGQgJiYgKG5vdyAtIHRoaXMubGFzdENsZWFudXBUaW1lID4gNjAwMDApKSB7XG4gICAgICBsb2dXYXJuKCdNZW1vcnkgcHJlc3N1cmUgZGV0ZWN0ZWQsIHRyaWdnZXJpbmcgY2xlYW51cCcsIHtcbiAgICAgICAgbWVtb3J5TUI6IHRvdGFsTWVtb3J5TUIsXG4gICAgICAgIHRocmVzaG9sZE1COiB0aHJlc2hvbGRNQlxuICAgICAgfSk7XG4gICAgICB0aGlzLnBlcmZvcm1NZW1vcnlDbGVhbnVwKCk7XG4gICAgICB0aGlzLmxhc3RDbGVhbnVwVGltZSA9IG5vdztcbiAgICB9XG5cbiAgICAvLyBGb3JjZSBnYXJiYWdlIGNvbGxlY3Rpb24gaWYgbWVtb3J5IGlzIHZlcnkgaGlnaFxuICAgIGlmICh0b3RhbE1lbW9yeSA+IHRoaXMuZ2NUaHJlc2hvbGQgJiYgZ2xvYmFsLmdjKSB7XG4gICAgICBsb2dXYXJuKCdIaWdoIG1lbW9yeSB1c2FnZSwgZm9yY2luZyBnYXJiYWdlIGNvbGxlY3Rpb24nLCB7XG4gICAgICAgIG1lbW9yeU1COiB0b3RhbE1lbW9yeU1CLFxuICAgICAgICBnY1RocmVzaG9sZE1COiBnY1RocmVzaG9sZE1CXG4gICAgICB9KTtcbiAgICAgIGdsb2JhbC5nYygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtIG1lbW9yeSBjbGVhbnVwIG9wZXJhdGlvbnNcbiAgICovXG4gIHBlcmZvcm1NZW1vcnlDbGVhbnVwKCkge1xuICAgIGxldCBjbGVhbmVkID0gMDtcblxuICAgIC8vIENsZWFuIHVwIG9sZCBpbnRlcnZhbHMgKG9sZGVyIHRoYW4gNSBtaW51dGVzKVxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgZm9yIChjb25zdCBbaWQsIGRhdGFdIG9mIHRoaXMuaW50ZXJ2YWxDbGVhbnVwLmVudHJpZXMoKSkge1xuICAgICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhLnRpbWVzdGFtcCAmJiBub3cgLSBkYXRhLnRpbWVzdGFtcCA+IDMwMDAwMCkge1xuICAgICAgICBjbGVhckludGVydmFsKGRhdGEuaW50ZXJ2YWxJZCk7XG4gICAgICAgIHRoaXMuaW50ZXJ2YWxDbGVhbnVwLmRlbGV0ZShpZCk7XG4gICAgICAgIGNsZWFuZWQrKztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDbGVhbiB1cCBvbGQgdGltZW91dHNcbiAgICBmb3IgKGNvbnN0IFtpZCwgdGltZW91dElkXSBvZiB0aGlzLnRpbWVvdXRDbGVhbnVwLmVudHJpZXMoKSkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICB0aGlzLnRpbWVvdXRDbGVhbnVwLmRlbGV0ZShpZCk7XG4gICAgICBjbGVhbmVkKys7XG4gICAgfVxuXG4gICAgLy8gQWJvcnQgb2xkIEFQSSByZXF1ZXN0c1xuICAgIGZvciAoY29uc3QgY29udHJvbGxlciBvZiB0aGlzLmFib3J0Q29udHJvbGxlcnMpIHtcbiAgICAgIGlmICghY29udHJvbGxlci5zaWduYWwuYWJvcnRlZCkge1xuICAgICAgICBjb250cm9sbGVyLmFib3J0KCk7XG4gICAgICAgIGNsZWFuZWQrKztcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5hYm9ydENvbnRyb2xsZXJzLmNsZWFyKCk7XG5cbiAgICBsb2dJbmZvKGBNZW1vcnkgY2xlYW51cCBjb21wbGV0ZWQsIGNsZWFuZWQgJHtjbGVhbmVkfSByZXNvdXJjZXNgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtIGdsb2JhbCBjbGVhbnVwIG9uIHNodXRkb3duXG4gICAqL1xuICBwZXJmb3JtR2xvYmFsQ2xlYW51cCgpIHtcbiAgICBsb2dJbmZvKCdQZXJmb3JtaW5nIGdsb2JhbCBjbGVhbnVwJyk7XG5cbiAgICAvLyBSdW4gYWxsIHJlZ2lzdGVyZWQgY2xlYW51cCBoYW5kbGVyc1xuICAgIGZvciAoY29uc3QgW2lkLCBjbGVhbnVwRm5dIG9mIHRoaXMuY2xlYW51cEhhbmRsZXJzLmVudHJpZXMoKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY2xlYW51cEZuKCk7XG4gICAgICAgIGxvZ0luZm8oYENsZWFuZWQgdXA6ICR7aWR9YCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dFcnJvcihgQ2xlYW51cCBmYWlsZWQgZm9yOiAke2lkfWAsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgYWxsIGludGVydmFscyBhbmQgdGltZW91dHNcbiAgICBmb3IgKGNvbnN0IGludGVydmFsSWQgb2YgdGhpcy5pbnRlcnZhbENsZWFudXAudmFsdWVzKCkpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodHlwZW9mIGludGVydmFsSWQgPT09ICdvYmplY3QnID8gaW50ZXJ2YWxJZC5pbnRlcnZhbElkIDogaW50ZXJ2YWxJZCk7XG4gICAgfVxuICAgIFxuICAgIGZvciAoY29uc3QgdGltZW91dElkIG9mIHRoaXMudGltZW91dENsZWFudXAudmFsdWVzKCkpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgIH1cblxuICAgIC8vIEFib3J0IGFsbCBwZW5kaW5nIHJlcXVlc3RzXG4gICAgZm9yIChjb25zdCBjb250cm9sbGVyIG9mIHRoaXMuYWJvcnRDb250cm9sbGVycykge1xuICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgIH1cblxuICAgIC8vIENsZWFyIG1hcHNcbiAgICB0aGlzLmNsZWFudXBIYW5kbGVycy5jbGVhcigpO1xuICAgIHRoaXMuaW50ZXJ2YWxDbGVhbnVwLmNsZWFyKCk7XG4gICAgdGhpcy50aW1lb3V0Q2xlYW51cC5jbGVhcigpO1xuICAgIHRoaXMuYWJvcnRDb250cm9sbGVycy5jbGVhcigpO1xuXG4gICAgbG9nSW5mbygnR2xvYmFsIGNsZWFudXAgY29tcGxldGVkJyk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IG1lbW9yeSBzdGF0aXN0aWNzXG4gICAqL1xuICBnZXRNZW1vcnlTdGF0cygpIHtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICByZXR1cm4geyBcbiAgICAgICAgYXZhaWxhYmxlOiBmYWxzZSxcbiAgICAgICAgZW52aXJvbm1lbnQ6ICdicm93c2VyJyxcbiAgICAgICAgY2xlYW51cEhhbmRsZXJzOiB0aGlzLmNsZWFudXBIYW5kbGVycy5zaXplLFxuICAgICAgICBhY3RpdmVJbnRlcnZhbHM6IHRoaXMuaW50ZXJ2YWxDbGVhbnVwLnNpemUsXG4gICAgICAgIGFjdGl2ZVRpbWVvdXRzOiB0aGlzLnRpbWVvdXRDbGVhbnVwLnNpemUsXG4gICAgICAgIGFjdGl2ZVJlcXVlc3RzOiB0aGlzLmFib3J0Q29udHJvbGxlcnMuc2l6ZVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBtZW1Vc2FnZSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKTtcbiAgICByZXR1cm4ge1xuICAgICAgYXZhaWxhYmxlOiB0cnVlLFxuICAgICAgZW52aXJvbm1lbnQ6ICdzZXJ2ZXInLFxuICAgICAgaGVhcDoge1xuICAgICAgICB1c2VkOiBNYXRoLnJvdW5kKG1lbVVzYWdlLmhlYXBVc2VkIC8gMTAyNCAvIDEwMjQpLFxuICAgICAgICB0b3RhbDogTWF0aC5yb3VuZChtZW1Vc2FnZS5oZWFwVG90YWwgLyAxMDI0IC8gMTAyNClcbiAgICAgIH0sXG4gICAgICBleHRlcm5hbDogTWF0aC5yb3VuZChtZW1Vc2FnZS5leHRlcm5hbCAvIDEwMjQgLyAxMDI0KSxcbiAgICAgIGNsZWFudXBIYW5kbGVyczogdGhpcy5jbGVhbnVwSGFuZGxlcnMuc2l6ZSxcbiAgICAgIGFjdGl2ZUludGVydmFsczogdGhpcy5pbnRlcnZhbENsZWFudXAuc2l6ZSxcbiAgICAgIGFjdGl2ZVRpbWVvdXRzOiB0aGlzLnRpbWVvdXRDbGVhbnVwLnNpemUsXG4gICAgICBhY3RpdmVSZXF1ZXN0czogdGhpcy5hYm9ydENvbnRyb2xsZXJzLnNpemVcbiAgICB9O1xuICB9XG59XG5cbi8vIEdsb2JhbCBzaW5nbGV0b24gaW5zdGFuY2VcbmxldCBtZW1vcnlPcHRpbWl6ZXIgPSBudWxsO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWVtb3J5T3B0aW1pemVyKCkge1xuICBpZiAoIW1lbW9yeU9wdGltaXplcikge1xuICAgIG1lbW9yeU9wdGltaXplciA9IG5ldyBNZW1vcnlPcHRpbWl6ZXIoKTtcbiAgfVxuICByZXR1cm4gbWVtb3J5T3B0aW1pemVyO1xufVxuXG4vLyBSZWFjdCBob29rIGZvciBtZW1vcnktb3B0aW1pemVkIGVmZmVjdHNcbmV4cG9ydCBmdW5jdGlvbiB1c2VNZW1vcnlPcHRpbWl6ZWRFZmZlY3QoZWZmZWN0LCBkZXBzKSB7XG4gIGNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcbiAgXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgb3B0aW1pemVyID0gZ2V0TWVtb3J5T3B0aW1pemVyKCk7XG4gICAgY29uc3QgcmVhY3RDbGVhbnVwID0gb3B0aW1pemVyLmNyZWF0ZVJlYWN0Q2xlYW51cCgpO1xuICAgIFxuICAgIGNvbnN0IGNsZWFudXAgPSBlZmZlY3QocmVhY3RDbGVhbnVwLnJlZ2lzdGVyKTtcbiAgICBcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgcmVhY3RDbGVhbnVwLmNsZWFudXAoKTtcbiAgICAgIGlmIChjbGVhbnVwKSBjbGVhbnVwKCk7XG4gICAgfTtcbiAgfSwgZGVwcyk7XG59XG5cbi8vIEFQSSBjYWxsIGhlbHBlciB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWVtb3J5T3B0aW1pemVkQVBJQ2FsbCh1cmwsIG9wdGlvbnMgPSB7fSwgdGltZW91dE1zID0gMzAwMDApIHtcbiAgY29uc3Qgb3B0aW1pemVyID0gZ2V0TWVtb3J5T3B0aW1pemVyKCk7XG4gIGNvbnN0IGNvbnRyb2xsZXIgPSBvcHRpbWl6ZXIuY3JlYXRlQWJvcnRDb250cm9sbGVyKHRpbWVvdXRNcyk7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbFxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICBsb2dXYXJuKCdBUEkgY2FsbCB3YXMgYWJvcnRlZCcsIHsgdXJsIH0pO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1ZXN0IHRpbWVvdXQnKTtcbiAgICB9XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgZ2V0TWVtb3J5T3B0aW1pemVyOyJdLCJuYW1lcyI6WyJsb2dJbmZvIiwibG9nRXJyb3IiLCJsb2dXYXJuIiwiTWVtb3J5T3B0aW1pemVyIiwiY29uc3RydWN0b3IiLCJsYXN0TG9nVGltZSIsImNsZWFudXBIYW5kbGVycyIsIk1hcCIsImludGVydmFsQ2xlYW51cCIsInRpbWVvdXRDbGVhbnVwIiwiZXZlbnRMaXN0ZW5lcnMiLCJhYm9ydENvbnRyb2xsZXJzIiwiU2V0IiwibWVtb3J5UHJlc3N1cmVUaHJlc2hvbGQiLCJwYXJzZUludCIsInByb2Nlc3MiLCJlbnYiLCJNRU1PUllfUFJFU1NVUkVfVEhSRVNIT0xEX01CIiwiZ2NUaHJlc2hvbGQiLCJNRU1PUllfR0NfVEhSRVNIT0xEX01CIiwibW9uaXRvckludGVydmFsIiwiTUVNT1JZX01PTklUT1JfSU5URVJWQUxfTVMiLCJpc0luaXRpYWxpemVkIiwibGFzdENsZWFudXBUaW1lIiwiaW5pdGlhbGl6ZU1lbW9yeU1vbml0b3JpbmciLCJtZW1vcnlNb25pdG9yIiwic2V0SW50ZXJ2YWwiLCJjaGVja01lbW9yeVByZXNzdXJlIiwicmVnaXN0ZXJDbGVhbnVwIiwiY2xlYXJJbnRlcnZhbCIsInByb2Nlc3NDbGVhbnVwIiwicGVyZm9ybUdsb2JhbENsZWFudXAiLCJleGl0IiwicmVtb3ZlQWxsTGlzdGVuZXJzIiwib25jZSIsIm9uIiwiZXJyb3IiLCJtZXNzYWdlIiwicmVhc29uIiwicHJvbWlzZSIsInN0YWNrIiwiaWQiLCJjbGVhbnVwRnVuY3Rpb24iLCJoYXMiLCJnZXQiLCJzZXQiLCJyZWdpc3RlckludGVydmFsIiwiaW50ZXJ2YWxJZCIsInNldFRpbWVvdXQiLCJkZWxldGUiLCJyZWdpc3RlclRpbWVvdXQiLCJ0aW1lb3V0SWQiLCJjbGVhclRpbWVvdXQiLCJjcmVhdGVBYm9ydENvbnRyb2xsZXIiLCJ0aW1lb3V0TXMiLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwiYWRkIiwic2lnbmFsIiwiYWJvcnRlZCIsImFib3J0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNyZWF0ZVJlYWN0Q2xlYW51cCIsImNsZWFudXBGdW5jdGlvbnMiLCJyZWdpc3RlciIsImNsZWFudXBGbiIsInB1c2giLCJjbGVhbnVwIiwiZm9yRWFjaCIsImZuIiwiaW5kZXgiLCJsZW5ndGgiLCJtZW1Vc2FnZSIsIm1lbW9yeVVzYWdlIiwiaGVhcFVzZWQiLCJleHRlcm5hbCIsInRvdGFsTWVtb3J5IiwidG90YWxNZW1vcnlNQiIsIk1hdGgiLCJyb3VuZCIsInRocmVzaG9sZE1CIiwiZ2NUaHJlc2hvbGRNQiIsIm5vdyIsIkRhdGUiLCJzaG91bGRMb2ciLCJ0b3RhbCIsInRocmVzaG9sZCIsIm1lbW9yeU1CIiwicGVyZm9ybU1lbW9yeUNsZWFudXAiLCJnbG9iYWwiLCJnYyIsImNsZWFuZWQiLCJkYXRhIiwiZW50cmllcyIsInRpbWVzdGFtcCIsImNsZWFyIiwidmFsdWVzIiwiZ2V0TWVtb3J5U3RhdHMiLCJhdmFpbGFibGUiLCJlbnZpcm9ubWVudCIsInNpemUiLCJhY3RpdmVJbnRlcnZhbHMiLCJhY3RpdmVUaW1lb3V0cyIsImFjdGl2ZVJlcXVlc3RzIiwiaGVhcCIsInVzZWQiLCJoZWFwVG90YWwiLCJtZW1vcnlPcHRpbWl6ZXIiLCJnZXRNZW1vcnlPcHRpbWl6ZXIiLCJ1c2VNZW1vcnlPcHRpbWl6ZWRFZmZlY3QiLCJlZmZlY3QiLCJkZXBzIiwiUmVhY3QiLCJyZXF1aXJlIiwidXNlRWZmZWN0Iiwib3B0aW1pemVyIiwicmVhY3RDbGVhbnVwIiwibWVtb3J5T3B0aW1pemVkQVBJQ2FsbCIsInVybCIsIm9wdGlvbnMiLCJyZXNwb25zZSIsImZldGNoIiwibmFtZSIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/memory-optimizer.js\n");

/***/ }),

/***/ "(api)/./lib/middleware/redis-rate-limiter.js":
/*!**********************************************!*\
  !*** ./lib/middleware/redis-rate-limiter.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createRateLimiter: () => (/* binding */ createRateLimiter),\n/* harmony export */   getRateLimitStatus: () => (/* binding */ getRateLimitStatus),\n/* harmony export */   rateLimitMiddleware: () => (/* binding */ rateLimitMiddleware)\n/* harmony export */ });\n/* harmony import */ var _redis_client_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../redis-client.js */ \"(api)/./lib/redis-client.js\");\n/* harmony import */ var _utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/production-logger.js */ \"(api)/./lib/utils/production-logger.js\");\n/* harmony import */ var _security_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../security.js */ \"(api)/./lib/security.js\");\n/**\n * Redis-Based Rate Limiter Middleware\n * Scalable, distributed rate limiting with intelligent fallback\n */ \n\n\n/**\n * Rate limiting configurations for different endpoint types\n */ const RATE_LIMIT_CONFIGS = {\n    // API endpoints by category\n    \"api_general\": {\n        windowMs: 900000,\n        maxRequests: 100,\n        skipSuccessfulRequests: false,\n        skipFailedRequests: false,\n        description: \"General API endpoints\"\n    },\n    \"api_intelligence\": {\n        windowMs: 900000,\n        maxRequests: 50,\n        skipSuccessfulRequests: false,\n        skipFailedRequests: true,\n        description: \"Intelligence APIs (more expensive)\"\n    },\n    \"api_volatile\": {\n        windowMs: 3600000,\n        maxRequests: 25,\n        skipSuccessfulRequests: false,\n        skipFailedRequests: true,\n        description: \"Volatile data APIs (external API calls)\"\n    },\n    \"api_auth\": {\n        windowMs: 900000,\n        maxRequests: 20,\n        skipSuccessfulRequests: true,\n        skipFailedRequests: false,\n        description: \"Authentication endpoints\"\n    },\n    // Page requests\n    \"page_requests\": {\n        windowMs: 300000,\n        maxRequests: 200,\n        skipSuccessfulRequests: true,\n        skipFailedRequests: true,\n        description: \"Page requests\"\n    },\n    // Default fallback\n    \"default\": {\n        windowMs: 900000,\n        maxRequests: 75,\n        skipSuccessfulRequests: false,\n        skipFailedRequests: false,\n        description: \"Default rate limiting\"\n    }\n};\n/**\n * Memory-based fallback for when Redis is unavailable\n */ class MemoryFallbackLimiter {\n    constructor(){\n        this.store = new Map();\n        this.cleanupInterval = setInterval(()=>this.cleanup(), 300000) // 5 minutes\n        ;\n    }\n    async checkRateLimit(identifier, config) {\n        const now = Date.now();\n        const windowStart = now - config.windowMs;\n        if (!this.store.has(identifier)) {\n            this.store.set(identifier, []);\n        }\n        const requests = this.store.get(identifier);\n        // Remove expired requests\n        const validRequests = requests.filter((timestamp)=>timestamp > windowStart);\n        if (validRequests.length >= config.maxRequests) {\n            return {\n                allowed: false,\n                totalHits: validRequests.length,\n                remainingPoints: 0,\n                msBeforeNext: config.windowMs - (now - Math.min(...validRequests)),\n                fallbackMode: true\n            };\n        }\n        // Add current request\n        validRequests.push(now);\n        this.store.set(identifier, validRequests);\n        return {\n            allowed: true,\n            totalHits: validRequests.length,\n            remainingPoints: config.maxRequests - validRequests.length,\n            msBeforeNext: config.windowMs,\n            fallbackMode: true\n        };\n    }\n    cleanup() {\n        const now = Date.now();\n        for (const [identifier, requests] of this.store.entries()){\n            const validRequests = requests.filter((timestamp)=>timestamp > now - 3600000) // Keep 1 hour\n            ;\n            if (validRequests.length === 0) {\n                this.store.delete(identifier);\n            } else {\n                this.store.set(identifier, validRequests);\n            }\n        }\n        (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logDebug)(\"Memory fallback rate limiter cleanup completed\", {\n            identifiers: this.store.size\n        });\n    }\n    destroy() {\n        clearInterval(this.cleanupInterval);\n        this.store.clear();\n    }\n}\nconst memoryFallback = new MemoryFallbackLimiter();\n/**\n * Redis-based rate limiter implementation\n */ class RedisRateLimiter {\n    /**\n   * Check rate limit using Redis with sliding window algorithm\n   */ static async checkRateLimit(identifier, config) {\n        try {\n            const redis = await (0,_redis_client_js__WEBPACK_IMPORTED_MODULE_0__.getRedisClient)();\n            const key = `rate_limit:${identifier}`;\n            const now = Date.now();\n            const windowStart = now - config.windowMs;\n            // Use Redis pipeline for atomic operations\n            const pipeline = redis.pipeline();\n            // Remove expired entries\n            pipeline.zremrangebyscore(key, 0, windowStart);\n            // Count current entries\n            pipeline.zcard(key);\n            // Add current request\n            pipeline.zadd(key, now, `${now}-${Math.random()}`);\n            // Set expiration\n            pipeline.expire(key, Math.ceil(config.windowMs / 1000));\n            const results = await pipeline.exec();\n            if (!results || results.some(([err])=>err)) {\n                throw new Error(\"Redis pipeline execution failed\");\n            }\n            const currentCount = results[1][1] // Count after removal, before adding new\n            ;\n            const allowed = currentCount < config.maxRequests;\n            if (!allowed) {\n                // Remove the request we just added since it's not allowed\n                await redis.zrem(key, `${now}-${Math.random()}`);\n            }\n            return {\n                allowed,\n                totalHits: allowed ? currentCount + 1 : currentCount,\n                remainingPoints: Math.max(0, config.maxRequests - (allowed ? currentCount + 1 : currentCount)),\n                msBeforeNext: allowed ? config.windowMs : await this.getTimeUntilNextAllowed(redis, key, config.windowMs),\n                fallbackMode: false\n            };\n        } catch (error) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)(\"Redis rate limiter failed, using memory fallback\", {\n                error: error.message,\n                identifier: identifier.substring(0, 20) + \"...\"\n            });\n            // Fallback to memory-based rate limiting\n            return await memoryFallback.checkRateLimit(identifier, config);\n        }\n    }\n    /**\n   * Calculate time until next request is allowed\n   */ static async getTimeUntilNextAllowed(redis, key, windowMs) {\n        try {\n            const oldestEntry = await redis.zrange(key, 0, 0, \"WITHSCORES\");\n            if (oldestEntry.length === 0) return 0;\n            const oldestTimestamp = parseInt(oldestEntry[1]);\n            const timeUntilExpiry = windowMs - (Date.now() - oldestTimestamp);\n            return Math.max(0, timeUntilExpiry);\n        } catch (error) {\n            return windowMs // Conservative estimate\n            ;\n        }\n    }\n}\n/**\n * Get rate limit configuration based on request path\n */ function getRateLimitConfig(req) {\n    const path = req.url || req.nextUrl?.pathname || \"\";\n    // API endpoints\n    if (path.startsWith(\"/api/\")) {\n        if (path.includes(\"/intelligence/\") || path.includes(\"/ai/\")) {\n            return RATE_LIMIT_CONFIGS.api_intelligence;\n        }\n        if (path.includes(\"/volatile-data/\") || path.includes(\"/external/\")) {\n            return RATE_LIMIT_CONFIGS.api_volatile;\n        }\n        if (path.includes(\"/auth/\") || path.includes(\"/login\") || path.includes(\"/register\")) {\n            return RATE_LIMIT_CONFIGS.api_auth;\n        }\n        return RATE_LIMIT_CONFIGS.api_general;\n    }\n    // Page requests\n    if (path.startsWith(\"/\") && !path.startsWith(\"/api/\")) {\n        return RATE_LIMIT_CONFIGS.page_requests;\n    }\n    return RATE_LIMIT_CONFIGS.default;\n}\n/**\n * Generate rate limit identifier from request\n */ function getRateLimitIdentifier(req) {\n    // Try multiple sources for client identification\n    const clientIP = req.headers[\"x-forwarded-for\"]?.split(\",\")[0]?.trim() || req.headers[\"x-real-ip\"] || req.connection?.remoteAddress || req.socket?.remoteAddress || \"unknown-client\";\n    const userAgent = req.headers[\"user-agent\"] || \"unknown-agent\";\n    const path = req.url || req.nextUrl?.pathname || \"unknown-path\";\n    // Create composite identifier for better accuracy\n    const sanitizedIP = _security_js__WEBPACK_IMPORTED_MODULE_2__.SecurityValidator.sanitizeString(clientIP, 50);\n    const sanitizedUA = _security_js__WEBPACK_IMPORTED_MODULE_2__.SecurityValidator.sanitizeString(userAgent.substring(0, 50), 50);\n    const sanitizedPath = _security_js__WEBPACK_IMPORTED_MODULE_2__.SecurityValidator.sanitizeString(path.split(\"?\")[0], 100) // Remove query params\n    ;\n    return `${sanitizedIP}:${sanitizedPath}:${Buffer.from(sanitizedUA).toString(\"base64\").substring(0, 20)}`;\n}\n/**\n * Main rate limiting middleware\n */ async function rateLimitMiddleware(req, res, next) {\n    const startTime = Date.now();\n    try {\n        // Skip rate limiting in development if desired\n        if ( true && process.env.SKIP_RATE_LIMIT === \"true\") {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logDebug)(\"Rate limiting skipped for development\");\n            return next();\n        }\n        const config = getRateLimitConfig(req);\n        const identifier = getRateLimitIdentifier(req);\n        (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logDebug)(\"Rate limiting check\", {\n            path: req.url,\n            identifier: identifier.substring(0, 30) + \"...\",\n            config: config.description,\n            fallbackMode: (0,_redis_client_js__WEBPACK_IMPORTED_MODULE_0__.shouldUseFallbackMode)()\n        });\n        const result = (0,_redis_client_js__WEBPACK_IMPORTED_MODULE_0__.shouldUseFallbackMode)() ? await memoryFallback.checkRateLimit(identifier, config) : await RedisRateLimiter.checkRateLimit(identifier, config);\n        // Add rate limit headers\n        res.setHeader(\"X-RateLimit-Limit\", config.maxRequests);\n        res.setHeader(\"X-RateLimit-Remaining\", result.remainingPoints);\n        res.setHeader(\"X-RateLimit-Reset\", new Date(Date.now() + result.msBeforeNext).toISOString());\n        res.setHeader(\"X-RateLimit-RetryAfter\", Math.ceil(result.msBeforeNext / 1000));\n        res.setHeader(\"X-RateLimit-Policy\", config.description);\n        res.setHeader(\"X-RateLimit-Mode\", result.fallbackMode ? \"memory\" : \"redis\");\n        if (!result.allowed) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)(\"Rate limit exceeded\", {\n                identifier: identifier.substring(0, 20) + \"...\",\n                path: req.url,\n                totalHits: result.totalHits,\n                limit: config.maxRequests,\n                retryAfter: Math.ceil(result.msBeforeNext / 1000),\n                fallbackMode: result.fallbackMode\n            });\n            return res.status(429).json({\n                error: \"Rate limit exceeded\",\n                message: `Too many requests. Limit: ${config.maxRequests} per ${Math.round(config.windowMs / 60000)} minutes`,\n                retryAfter: Math.ceil(result.msBeforeNext / 1000),\n                limit: config.maxRequests,\n                remaining: result.remainingPoints,\n                resetTime: new Date(Date.now() + result.msBeforeNext).toISOString(),\n                policy: config.description\n            });\n        }\n        const duration = Date.now() - startTime;\n        (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logDebug)(\"Rate limit check passed\", {\n            duration,\n            remaining: result.remainingPoints,\n            totalHits: result.totalHits,\n            fallbackMode: result.fallbackMode\n        });\n        next();\n    } catch (error) {\n        const duration = Date.now() - startTime;\n        (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Rate limiting middleware error\", {\n            error: error.message,\n            duration,\n            fallback: \"allowing request\"\n        });\n        // On error, allow the request but log the issue\n        next();\n    }\n}\n/**\n * Rate limiting middleware factory for custom configurations\n */ function createRateLimiter(customConfig) {\n    return async (req, res, next)=>{\n        const config = {\n            ...RATE_LIMIT_CONFIGS.default,\n            ...customConfig\n        };\n        const identifier = getRateLimitIdentifier(req);\n        try {\n            const result = (0,_redis_client_js__WEBPACK_IMPORTED_MODULE_0__.shouldUseFallbackMode)() ? await memoryFallback.checkRateLimit(identifier, config) : await RedisRateLimiter.checkRateLimit(identifier, config);\n            res.setHeader(\"X-RateLimit-Limit\", config.maxRequests);\n            res.setHeader(\"X-RateLimit-Remaining\", result.remainingPoints);\n            res.setHeader(\"X-RateLimit-Reset\", new Date(Date.now() + result.msBeforeNext).toISOString());\n            if (!result.allowed) {\n                return res.status(429).json({\n                    error: \"Rate limit exceeded\",\n                    retryAfter: Math.ceil(result.msBeforeNext / 1000)\n                });\n            }\n            next();\n        } catch (error) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Custom rate limiter error\", {\n                error: error.message\n            });\n            next() // Allow request on error\n            ;\n        }\n    };\n}\n/**\n * Get rate limit status for monitoring\n */ async function getRateLimitStatus(identifier, config = RATE_LIMIT_CONFIGS.default) {\n    try {\n        if ((0,_redis_client_js__WEBPACK_IMPORTED_MODULE_0__.shouldUseFallbackMode)()) {\n            return {\n                mode: \"memory\",\n                status: \"operational\",\n                note: \"Using memory fallback\"\n            };\n        }\n        const redis = await (0,_redis_client_js__WEBPACK_IMPORTED_MODULE_0__.getRedisClient)();\n        const key = `rate_limit:${identifier}`;\n        const count = await redis.zcard(key);\n        return {\n            mode: \"redis\",\n            status: \"operational\",\n            currentCount: count,\n            limit: config.maxRequests,\n            remaining: Math.max(0, config.maxRequests - count)\n        };\n    } catch (error) {\n        return {\n            mode: \"error\",\n            status: \"degraded\",\n            error: error.message\n        };\n    }\n}\n// Cleanup on shutdown\nprocess.on(\"SIGTERM\", ()=>memoryFallback.destroy());\nprocess.on(\"SIGINT\", ()=>memoryFallback.destroy());\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbWlkZGxld2FyZS9yZWRpcy1yYXRlLWxpbWl0ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7OztDQUdDLEdBRXlFO0FBQ1U7QUFDbEM7QUFFbEQ7O0NBRUMsR0FDRCxNQUFNTyxxQkFBcUI7SUFDekIsNEJBQTRCO0lBQzVCLGVBQWU7UUFDYkMsVUFBVTtRQUNWQyxhQUFhO1FBQ2JDLHdCQUF3QjtRQUN4QkMsb0JBQW9CO1FBQ3BCQyxhQUFhO0lBQ2Y7SUFFQSxvQkFBb0I7UUFDbEJKLFVBQVU7UUFDVkMsYUFBYTtRQUNiQyx3QkFBd0I7UUFDeEJDLG9CQUFvQjtRQUNwQkMsYUFBYTtJQUNmO0lBRUEsZ0JBQWdCO1FBQ2RKLFVBQVU7UUFDVkMsYUFBYTtRQUNiQyx3QkFBd0I7UUFDeEJDLG9CQUFvQjtRQUNwQkMsYUFBYTtJQUNmO0lBRUEsWUFBWTtRQUNWSixVQUFVO1FBQ1ZDLGFBQWE7UUFDYkMsd0JBQXdCO1FBQ3hCQyxvQkFBb0I7UUFDcEJDLGFBQWE7SUFDZjtJQUVBLGdCQUFnQjtJQUNoQixpQkFBaUI7UUFDZkosVUFBVTtRQUNWQyxhQUFhO1FBQ2JDLHdCQUF3QjtRQUN4QkMsb0JBQW9CO1FBQ3BCQyxhQUFhO0lBQ2Y7SUFFQSxtQkFBbUI7SUFDbkIsV0FBVztRQUNUSixVQUFVO1FBQ1ZDLGFBQWE7UUFDYkMsd0JBQXdCO1FBQ3hCQyxvQkFBb0I7UUFDcEJDLGFBQWE7SUFDZjtBQUNGO0FBRUE7O0NBRUMsR0FDRCxNQUFNQztJQUNKQyxhQUFjO1FBQ1osSUFBSSxDQUFDQyxLQUFLLEdBQUcsSUFBSUM7UUFDakIsSUFBSSxDQUFDQyxlQUFlLEdBQUdDLFlBQVksSUFBTSxJQUFJLENBQUNDLE9BQU8sSUFBSSxRQUFRLFlBQVk7O0lBQy9FO0lBRUEsTUFBTUMsZUFBZUMsVUFBVSxFQUFFQyxNQUFNLEVBQUU7UUFDdkMsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztRQUNwQixNQUFNRSxjQUFjRixNQUFNRCxPQUFPZCxRQUFRO1FB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LFFBQVFzQixFQUFFLENBQUMsV0FBVyxJQUFNcEYsZUFBZUgsT0FBTztBQUNsRGlFLFFBQVFzQixFQUFFLENBQUMsVUFBVSxJQUFNcEYsZUFBZUgsT0FBTyIsInNvdXJjZXMiOlsid2VicGFjazovL3RyaWFuZ2xlLWludGVsbGlnZW5jZS1wbGF0Zm9ybS8uL2xpYi9taWRkbGV3YXJlL3JlZGlzLXJhdGUtbGltaXRlci5qcz8yNmQ1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUmVkaXMtQmFzZWQgUmF0ZSBMaW1pdGVyIE1pZGRsZXdhcmVcbiAqIFNjYWxhYmxlLCBkaXN0cmlidXRlZCByYXRlIGxpbWl0aW5nIHdpdGggaW50ZWxsaWdlbnQgZmFsbGJhY2tcbiAqL1xuXG5pbXBvcnQgeyBnZXRSZWRpc0NsaWVudCwgc2hvdWxkVXNlRmFsbGJhY2tNb2RlIH0gZnJvbSAnLi4vcmVkaXMtY2xpZW50LmpzJ1xuaW1wb3J0IHsgbG9nSW5mbywgbG9nRXJyb3IsIGxvZ1dhcm4sIGxvZ0RlYnVnIH0gZnJvbSAnLi4vdXRpbHMvcHJvZHVjdGlvbi1sb2dnZXIuanMnXG5pbXBvcnQgeyBTZWN1cml0eVZhbGlkYXRvciB9IGZyb20gJy4uL3NlY3VyaXR5LmpzJ1xuXG4vKipcbiAqIFJhdGUgbGltaXRpbmcgY29uZmlndXJhdGlvbnMgZm9yIGRpZmZlcmVudCBlbmRwb2ludCB0eXBlc1xuICovXG5jb25zdCBSQVRFX0xJTUlUX0NPTkZJR1MgPSB7XG4gIC8vIEFQSSBlbmRwb2ludHMgYnkgY2F0ZWdvcnlcbiAgJ2FwaV9nZW5lcmFsJzoge1xuICAgIHdpbmRvd01zOiA5MDAwMDAsIC8vIDE1IG1pbnV0ZXNcbiAgICBtYXhSZXF1ZXN0czogMTAwLFxuICAgIHNraXBTdWNjZXNzZnVsUmVxdWVzdHM6IGZhbHNlLFxuICAgIHNraXBGYWlsZWRSZXF1ZXN0czogZmFsc2UsXG4gICAgZGVzY3JpcHRpb246ICdHZW5lcmFsIEFQSSBlbmRwb2ludHMnXG4gIH0sXG4gIFxuICAnYXBpX2ludGVsbGlnZW5jZSc6IHtcbiAgICB3aW5kb3dNczogOTAwMDAwLCAvLyAxNSBtaW51dGVzXG4gICAgbWF4UmVxdWVzdHM6IDUwLFxuICAgIHNraXBTdWNjZXNzZnVsUmVxdWVzdHM6IGZhbHNlLFxuICAgIHNraXBGYWlsZWRSZXF1ZXN0czogdHJ1ZSxcbiAgICBkZXNjcmlwdGlvbjogJ0ludGVsbGlnZW5jZSBBUElzIChtb3JlIGV4cGVuc2l2ZSknXG4gIH0sXG4gIFxuICAnYXBpX3ZvbGF0aWxlJzoge1xuICAgIHdpbmRvd01zOiAzNjAwMDAwLCAvLyAxIGhvdXJcbiAgICBtYXhSZXF1ZXN0czogMjUsXG4gICAgc2tpcFN1Y2Nlc3NmdWxSZXF1ZXN0czogZmFsc2UsXG4gICAgc2tpcEZhaWxlZFJlcXVlc3RzOiB0cnVlLFxuICAgIGRlc2NyaXB0aW9uOiAnVm9sYXRpbGUgZGF0YSBBUElzIChleHRlcm5hbCBBUEkgY2FsbHMpJ1xuICB9LFxuICBcbiAgJ2FwaV9hdXRoJzoge1xuICAgIHdpbmRvd01zOiA5MDAwMDAsIC8vIDE1IG1pbnV0ZXNcbiAgICBtYXhSZXF1ZXN0czogMjAsXG4gICAgc2tpcFN1Y2Nlc3NmdWxSZXF1ZXN0czogdHJ1ZSxcbiAgICBza2lwRmFpbGVkUmVxdWVzdHM6IGZhbHNlLFxuICAgIGRlc2NyaXB0aW9uOiAnQXV0aGVudGljYXRpb24gZW5kcG9pbnRzJ1xuICB9LFxuICBcbiAgLy8gUGFnZSByZXF1ZXN0c1xuICAncGFnZV9yZXF1ZXN0cyc6IHtcbiAgICB3aW5kb3dNczogMzAwMDAwLCAvLyA1IG1pbnV0ZXNcbiAgICBtYXhSZXF1ZXN0czogMjAwLFxuICAgIHNraXBTdWNjZXNzZnVsUmVxdWVzdHM6IHRydWUsXG4gICAgc2tpcEZhaWxlZFJlcXVlc3RzOiB0cnVlLFxuICAgIGRlc2NyaXB0aW9uOiAnUGFnZSByZXF1ZXN0cydcbiAgfSxcbiAgXG4gIC8vIERlZmF1bHQgZmFsbGJhY2tcbiAgJ2RlZmF1bHQnOiB7XG4gICAgd2luZG93TXM6IDkwMDAwMCwgLy8gMTUgbWludXRlc1xuICAgIG1heFJlcXVlc3RzOiA3NSxcbiAgICBza2lwU3VjY2Vzc2Z1bFJlcXVlc3RzOiBmYWxzZSxcbiAgICBza2lwRmFpbGVkUmVxdWVzdHM6IGZhbHNlLFxuICAgIGRlc2NyaXB0aW9uOiAnRGVmYXVsdCByYXRlIGxpbWl0aW5nJ1xuICB9XG59XG5cbi8qKlxuICogTWVtb3J5LWJhc2VkIGZhbGxiYWNrIGZvciB3aGVuIFJlZGlzIGlzIHVuYXZhaWxhYmxlXG4gKi9cbmNsYXNzIE1lbW9yeUZhbGxiYWNrTGltaXRlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3RvcmUgPSBuZXcgTWFwKClcbiAgICB0aGlzLmNsZWFudXBJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHRoaXMuY2xlYW51cCgpLCAzMDAwMDApIC8vIDUgbWludXRlc1xuICB9XG5cbiAgYXN5bmMgY2hlY2tSYXRlTGltaXQoaWRlbnRpZmllciwgY29uZmlnKSB7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxuICAgIGNvbnN0IHdpbmRvd1N0YXJ0ID0gbm93IC0gY29uZmlnLndpbmRvd01zXG4gICAgXG4gICAgaWYgKCF0aGlzLnN0b3JlLmhhcyhpZGVudGlmaWVyKSkge1xuICAgICAgdGhpcy5zdG9yZS5zZXQoaWRlbnRpZmllciwgW10pXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHJlcXVlc3RzID0gdGhpcy5zdG9yZS5nZXQoaWRlbnRpZmllcilcbiAgICBcbiAgICAvLyBSZW1vdmUgZXhwaXJlZCByZXF1ZXN0c1xuICAgIGNvbnN0IHZhbGlkUmVxdWVzdHMgPSByZXF1ZXN0cy5maWx0ZXIodGltZXN0YW1wID0+IHRpbWVzdGFtcCA+IHdpbmRvd1N0YXJ0KVxuICAgIFxuICAgIGlmICh2YWxpZFJlcXVlc3RzLmxlbmd0aCA+PSBjb25maWcubWF4UmVxdWVzdHMpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICB0b3RhbEhpdHM6IHZhbGlkUmVxdWVzdHMubGVuZ3RoLFxuICAgICAgICByZW1haW5pbmdQb2ludHM6IDAsXG4gICAgICAgIG1zQmVmb3JlTmV4dDogY29uZmlnLndpbmRvd01zIC0gKG5vdyAtIE1hdGgubWluKC4uLnZhbGlkUmVxdWVzdHMpKSxcbiAgICAgICAgZmFsbGJhY2tNb2RlOiB0cnVlXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEFkZCBjdXJyZW50IHJlcXVlc3RcbiAgICB2YWxpZFJlcXVlc3RzLnB1c2gobm93KVxuICAgIHRoaXMuc3RvcmUuc2V0KGlkZW50aWZpZXIsIHZhbGlkUmVxdWVzdHMpXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGFsbG93ZWQ6IHRydWUsXG4gICAgICB0b3RhbEhpdHM6IHZhbGlkUmVxdWVzdHMubGVuZ3RoLFxuICAgICAgcmVtYWluaW5nUG9pbnRzOiBjb25maWcubWF4UmVxdWVzdHMgLSB2YWxpZFJlcXVlc3RzLmxlbmd0aCxcbiAgICAgIG1zQmVmb3JlTmV4dDogY29uZmlnLndpbmRvd01zLFxuICAgICAgZmFsbGJhY2tNb2RlOiB0cnVlXG4gICAgfVxuICB9XG4gIFxuICBjbGVhbnVwKCkge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBmb3IgKGNvbnN0IFtpZGVudGlmaWVyLCByZXF1ZXN0c10gb2YgdGhpcy5zdG9yZS5lbnRyaWVzKCkpIHtcbiAgICAgIGNvbnN0IHZhbGlkUmVxdWVzdHMgPSByZXF1ZXN0cy5maWx0ZXIodGltZXN0YW1wID0+IHRpbWVzdGFtcCA+IG5vdyAtIDM2MDAwMDApIC8vIEtlZXAgMSBob3VyXG4gICAgICBpZiAodmFsaWRSZXF1ZXN0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhpcy5zdG9yZS5kZWxldGUoaWRlbnRpZmllcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3RvcmUuc2V0KGlkZW50aWZpZXIsIHZhbGlkUmVxdWVzdHMpXG4gICAgICB9XG4gICAgfVxuICAgIGxvZ0RlYnVnKCdNZW1vcnkgZmFsbGJhY2sgcmF0ZSBsaW1pdGVyIGNsZWFudXAgY29tcGxldGVkJywgeyBcbiAgICAgIGlkZW50aWZpZXJzOiB0aGlzLnN0b3JlLnNpemUgXG4gICAgfSlcbiAgfVxuICBcbiAgZGVzdHJveSgpIHtcbiAgICBjbGVhckludGVydmFsKHRoaXMuY2xlYW51cEludGVydmFsKVxuICAgIHRoaXMuc3RvcmUuY2xlYXIoKVxuICB9XG59XG5cbmNvbnN0IG1lbW9yeUZhbGxiYWNrID0gbmV3IE1lbW9yeUZhbGxiYWNrTGltaXRlcigpXG5cbi8qKlxuICogUmVkaXMtYmFzZWQgcmF0ZSBsaW1pdGVyIGltcGxlbWVudGF0aW9uXG4gKi9cbmNsYXNzIFJlZGlzUmF0ZUxpbWl0ZXIge1xuICBcbiAgLyoqXG4gICAqIENoZWNrIHJhdGUgbGltaXQgdXNpbmcgUmVkaXMgd2l0aCBzbGlkaW5nIHdpbmRvdyBhbGdvcml0aG1cbiAgICovXG4gIHN0YXRpYyBhc3luYyBjaGVja1JhdGVMaW1pdChpZGVudGlmaWVyLCBjb25maWcpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVkaXMgPSBhd2FpdCBnZXRSZWRpc0NsaWVudCgpXG4gICAgICBjb25zdCBrZXkgPSBgcmF0ZV9saW1pdDoke2lkZW50aWZpZXJ9YFxuICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxuICAgICAgY29uc3Qgd2luZG93U3RhcnQgPSBub3cgLSBjb25maWcud2luZG93TXNcbiAgICAgIFxuICAgICAgLy8gVXNlIFJlZGlzIHBpcGVsaW5lIGZvciBhdG9taWMgb3BlcmF0aW9uc1xuICAgICAgY29uc3QgcGlwZWxpbmUgPSByZWRpcy5waXBlbGluZSgpXG4gICAgICBcbiAgICAgIC8vIFJlbW92ZSBleHBpcmVkIGVudHJpZXNcbiAgICAgIHBpcGVsaW5lLnpyZW1yYW5nZWJ5c2NvcmUoa2V5LCAwLCB3aW5kb3dTdGFydClcbiAgICAgIFxuICAgICAgLy8gQ291bnQgY3VycmVudCBlbnRyaWVzXG4gICAgICBwaXBlbGluZS56Y2FyZChrZXkpXG4gICAgICBcbiAgICAgIC8vIEFkZCBjdXJyZW50IHJlcXVlc3RcbiAgICAgIHBpcGVsaW5lLnphZGQoa2V5LCBub3csIGAke25vd30tJHtNYXRoLnJhbmRvbSgpfWApXG4gICAgICBcbiAgICAgIC8vIFNldCBleHBpcmF0aW9uXG4gICAgICBwaXBlbGluZS5leHBpcmUoa2V5LCBNYXRoLmNlaWwoY29uZmlnLndpbmRvd01zIC8gMTAwMCkpXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBwaXBlbGluZS5leGVjKClcbiAgICAgIFxuICAgICAgaWYgKCFyZXN1bHRzIHx8IHJlc3VsdHMuc29tZSgoW2Vycl0pID0+IGVycikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWRpcyBwaXBlbGluZSBleGVjdXRpb24gZmFpbGVkJylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgY3VycmVudENvdW50ID0gcmVzdWx0c1sxXVsxXSAvLyBDb3VudCBhZnRlciByZW1vdmFsLCBiZWZvcmUgYWRkaW5nIG5ld1xuICAgICAgY29uc3QgYWxsb3dlZCA9IGN1cnJlbnRDb3VudCA8IGNvbmZpZy5tYXhSZXF1ZXN0c1xuICAgICAgXG4gICAgICBpZiAoIWFsbG93ZWQpIHtcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSByZXF1ZXN0IHdlIGp1c3QgYWRkZWQgc2luY2UgaXQncyBub3QgYWxsb3dlZFxuICAgICAgICBhd2FpdCByZWRpcy56cmVtKGtleSwgYCR7bm93fS0ke01hdGgucmFuZG9tKCl9YClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYWxsb3dlZCxcbiAgICAgICAgdG90YWxIaXRzOiBhbGxvd2VkID8gY3VycmVudENvdW50ICsgMSA6IGN1cnJlbnRDb3VudCxcbiAgICAgICAgcmVtYWluaW5nUG9pbnRzOiBNYXRoLm1heCgwLCBjb25maWcubWF4UmVxdWVzdHMgLSAoYWxsb3dlZCA/IGN1cnJlbnRDb3VudCArIDEgOiBjdXJyZW50Q291bnQpKSxcbiAgICAgICAgbXNCZWZvcmVOZXh0OiBhbGxvd2VkID8gY29uZmlnLndpbmRvd01zIDogYXdhaXQgdGhpcy5nZXRUaW1lVW50aWxOZXh0QWxsb3dlZChyZWRpcywga2V5LCBjb25maWcud2luZG93TXMpLFxuICAgICAgICBmYWxsYmFja01vZGU6IGZhbHNlXG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nV2FybignUmVkaXMgcmF0ZSBsaW1pdGVyIGZhaWxlZCwgdXNpbmcgbWVtb3J5IGZhbGxiYWNrJywgeyBcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIGlkZW50aWZpZXI6IGlkZW50aWZpZXIuc3Vic3RyaW5nKDAsIDIwKSArICcuLi4nIFxuICAgICAgfSlcbiAgICAgIFxuICAgICAgLy8gRmFsbGJhY2sgdG8gbWVtb3J5LWJhc2VkIHJhdGUgbGltaXRpbmdcbiAgICAgIHJldHVybiBhd2FpdCBtZW1vcnlGYWxsYmFjay5jaGVja1JhdGVMaW1pdChpZGVudGlmaWVyLCBjb25maWcpXG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogQ2FsY3VsYXRlIHRpbWUgdW50aWwgbmV4dCByZXF1ZXN0IGlzIGFsbG93ZWRcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRUaW1lVW50aWxOZXh0QWxsb3dlZChyZWRpcywga2V5LCB3aW5kb3dNcykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvbGRlc3RFbnRyeSA9IGF3YWl0IHJlZGlzLnpyYW5nZShrZXksIDAsIDAsICdXSVRIU0NPUkVTJylcbiAgICAgIGlmIChvbGRlc3RFbnRyeS5sZW5ndGggPT09IDApIHJldHVybiAwXG4gICAgICBcbiAgICAgIGNvbnN0IG9sZGVzdFRpbWVzdGFtcCA9IHBhcnNlSW50KG9sZGVzdEVudHJ5WzFdKVxuICAgICAgY29uc3QgdGltZVVudGlsRXhwaXJ5ID0gd2luZG93TXMgLSAoRGF0ZS5ub3coKSAtIG9sZGVzdFRpbWVzdGFtcClcbiAgICAgIFxuICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIHRpbWVVbnRpbEV4cGlyeSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHdpbmRvd01zIC8vIENvbnNlcnZhdGl2ZSBlc3RpbWF0ZVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEdldCByYXRlIGxpbWl0IGNvbmZpZ3VyYXRpb24gYmFzZWQgb24gcmVxdWVzdCBwYXRoXG4gKi9cbmZ1bmN0aW9uIGdldFJhdGVMaW1pdENvbmZpZyhyZXEpIHtcbiAgY29uc3QgcGF0aCA9IHJlcS51cmwgfHwgcmVxLm5leHRVcmw/LnBhdGhuYW1lIHx8ICcnXG4gIFxuICAvLyBBUEkgZW5kcG9pbnRzXG4gIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hcGkvJykpIHtcbiAgICBpZiAocGF0aC5pbmNsdWRlcygnL2ludGVsbGlnZW5jZS8nKSB8fCBwYXRoLmluY2x1ZGVzKCcvYWkvJykpIHtcbiAgICAgIHJldHVybiBSQVRFX0xJTUlUX0NPTkZJR1MuYXBpX2ludGVsbGlnZW5jZVxuICAgIH1cbiAgICBpZiAocGF0aC5pbmNsdWRlcygnL3ZvbGF0aWxlLWRhdGEvJykgfHwgcGF0aC5pbmNsdWRlcygnL2V4dGVybmFsLycpKSB7XG4gICAgICByZXR1cm4gUkFURV9MSU1JVF9DT05GSUdTLmFwaV92b2xhdGlsZVxuICAgIH1cbiAgICBpZiAocGF0aC5pbmNsdWRlcygnL2F1dGgvJykgfHwgcGF0aC5pbmNsdWRlcygnL2xvZ2luJykgfHwgcGF0aC5pbmNsdWRlcygnL3JlZ2lzdGVyJykpIHtcbiAgICAgIHJldHVybiBSQVRFX0xJTUlUX0NPTkZJR1MuYXBpX2F1dGhcbiAgICB9XG4gICAgcmV0dXJuIFJBVEVfTElNSVRfQ09ORklHUy5hcGlfZ2VuZXJhbFxuICB9XG4gIFxuICAvLyBQYWdlIHJlcXVlc3RzXG4gIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy8nKSAmJiAhcGF0aC5zdGFydHNXaXRoKCcvYXBpLycpKSB7XG4gICAgcmV0dXJuIFJBVEVfTElNSVRfQ09ORklHUy5wYWdlX3JlcXVlc3RzXG4gIH1cbiAgXG4gIHJldHVybiBSQVRFX0xJTUlUX0NPTkZJR1MuZGVmYXVsdFxufVxuXG4vKipcbiAqIEdlbmVyYXRlIHJhdGUgbGltaXQgaWRlbnRpZmllciBmcm9tIHJlcXVlc3RcbiAqL1xuZnVuY3Rpb24gZ2V0UmF0ZUxpbWl0SWRlbnRpZmllcihyZXEpIHtcbiAgLy8gVHJ5IG11bHRpcGxlIHNvdXJjZXMgZm9yIGNsaWVudCBpZGVudGlmaWNhdGlvblxuICBjb25zdCBjbGllbnRJUCA9IHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXT8uc3BsaXQoJywnKVswXT8udHJpbSgpIHx8XG4gICAgICAgICAgICAgICAgICByZXEuaGVhZGVyc1sneC1yZWFsLWlwJ10gfHxcbiAgICAgICAgICAgICAgICAgIHJlcS5jb25uZWN0aW9uPy5yZW1vdGVBZGRyZXNzIHx8XG4gICAgICAgICAgICAgICAgICByZXEuc29ja2V0Py5yZW1vdGVBZGRyZXNzIHx8XG4gICAgICAgICAgICAgICAgICAndW5rbm93bi1jbGllbnQnXG4gIFxuICBjb25zdCB1c2VyQWdlbnQgPSByZXEuaGVhZGVyc1sndXNlci1hZ2VudCddIHx8ICd1bmtub3duLWFnZW50J1xuICBjb25zdCBwYXRoID0gcmVxLnVybCB8fCByZXEubmV4dFVybD8ucGF0aG5hbWUgfHwgJ3Vua25vd24tcGF0aCdcbiAgXG4gIC8vIENyZWF0ZSBjb21wb3NpdGUgaWRlbnRpZmllciBmb3IgYmV0dGVyIGFjY3VyYWN5XG4gIGNvbnN0IHNhbml0aXplZElQID0gU2VjdXJpdHlWYWxpZGF0b3Iuc2FuaXRpemVTdHJpbmcoY2xpZW50SVAsIDUwKVxuICBjb25zdCBzYW5pdGl6ZWRVQSA9IFNlY3VyaXR5VmFsaWRhdG9yLnNhbml0aXplU3RyaW5nKHVzZXJBZ2VudC5zdWJzdHJpbmcoMCwgNTApLCA1MClcbiAgY29uc3Qgc2FuaXRpemVkUGF0aCA9IFNlY3VyaXR5VmFsaWRhdG9yLnNhbml0aXplU3RyaW5nKHBhdGguc3BsaXQoJz8nKVswXSwgMTAwKSAvLyBSZW1vdmUgcXVlcnkgcGFyYW1zXG4gIFxuICByZXR1cm4gYCR7c2FuaXRpemVkSVB9OiR7c2FuaXRpemVkUGF0aH06JHtCdWZmZXIuZnJvbShzYW5pdGl6ZWRVQSkudG9TdHJpbmcoJ2Jhc2U2NCcpLnN1YnN0cmluZygwLCAyMCl9YFxufVxuXG4vKipcbiAqIE1haW4gcmF0ZSBsaW1pdGluZyBtaWRkbGV3YXJlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByYXRlTGltaXRNaWRkbGV3YXJlKHJlcSwgcmVzLCBuZXh0KSB7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KClcbiAgXG4gIHRyeSB7XG4gICAgLy8gU2tpcCByYXRlIGxpbWl0aW5nIGluIGRldmVsb3BtZW50IGlmIGRlc2lyZWRcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgJiYgcHJvY2Vzcy5lbnYuU0tJUF9SQVRFX0xJTUlUID09PSAndHJ1ZScpIHtcbiAgICAgIGxvZ0RlYnVnKCdSYXRlIGxpbWl0aW5nIHNraXBwZWQgZm9yIGRldmVsb3BtZW50JylcbiAgICAgIHJldHVybiBuZXh0KClcbiAgICB9XG4gICAgXG4gICAgY29uc3QgY29uZmlnID0gZ2V0UmF0ZUxpbWl0Q29uZmlnKHJlcSlcbiAgICBjb25zdCBpZGVudGlmaWVyID0gZ2V0UmF0ZUxpbWl0SWRlbnRpZmllcihyZXEpXG4gICAgXG4gICAgbG9nRGVidWcoJ1JhdGUgbGltaXRpbmcgY2hlY2snLCB7XG4gICAgICBwYXRoOiByZXEudXJsLFxuICAgICAgaWRlbnRpZmllcjogaWRlbnRpZmllci5zdWJzdHJpbmcoMCwgMzApICsgJy4uLicsXG4gICAgICBjb25maWc6IGNvbmZpZy5kZXNjcmlwdGlvbixcbiAgICAgIGZhbGxiYWNrTW9kZTogc2hvdWxkVXNlRmFsbGJhY2tNb2RlKClcbiAgICB9KVxuICAgIFxuICAgIGNvbnN0IHJlc3VsdCA9IHNob3VsZFVzZUZhbGxiYWNrTW9kZSgpIFxuICAgICAgPyBhd2FpdCBtZW1vcnlGYWxsYmFjay5jaGVja1JhdGVMaW1pdChpZGVudGlmaWVyLCBjb25maWcpXG4gICAgICA6IGF3YWl0IFJlZGlzUmF0ZUxpbWl0ZXIuY2hlY2tSYXRlTGltaXQoaWRlbnRpZmllciwgY29uZmlnKVxuICAgIFxuICAgIC8vIEFkZCByYXRlIGxpbWl0IGhlYWRlcnNcbiAgICByZXMuc2V0SGVhZGVyKCdYLVJhdGVMaW1pdC1MaW1pdCcsIGNvbmZpZy5tYXhSZXF1ZXN0cylcbiAgICByZXMuc2V0SGVhZGVyKCdYLVJhdGVMaW1pdC1SZW1haW5pbmcnLCByZXN1bHQucmVtYWluaW5nUG9pbnRzKVxuICAgIHJlcy5zZXRIZWFkZXIoJ1gtUmF0ZUxpbWl0LVJlc2V0JywgbmV3IERhdGUoRGF0ZS5ub3coKSArIHJlc3VsdC5tc0JlZm9yZU5leHQpLnRvSVNPU3RyaW5nKCkpXG4gICAgcmVzLnNldEhlYWRlcignWC1SYXRlTGltaXQtUmV0cnlBZnRlcicsIE1hdGguY2VpbChyZXN1bHQubXNCZWZvcmVOZXh0IC8gMTAwMCkpXG4gICAgcmVzLnNldEhlYWRlcignWC1SYXRlTGltaXQtUG9saWN5JywgY29uZmlnLmRlc2NyaXB0aW9uKVxuICAgIHJlcy5zZXRIZWFkZXIoJ1gtUmF0ZUxpbWl0LU1vZGUnLCByZXN1bHQuZmFsbGJhY2tNb2RlID8gJ21lbW9yeScgOiAncmVkaXMnKVxuICAgIFxuICAgIGlmICghcmVzdWx0LmFsbG93ZWQpIHtcbiAgICAgIGxvZ1dhcm4oJ1JhdGUgbGltaXQgZXhjZWVkZWQnLCB7XG4gICAgICAgIGlkZW50aWZpZXI6IGlkZW50aWZpZXIuc3Vic3RyaW5nKDAsIDIwKSArICcuLi4nLFxuICAgICAgICBwYXRoOiByZXEudXJsLFxuICAgICAgICB0b3RhbEhpdHM6IHJlc3VsdC50b3RhbEhpdHMsXG4gICAgICAgIGxpbWl0OiBjb25maWcubWF4UmVxdWVzdHMsXG4gICAgICAgIHJldHJ5QWZ0ZXI6IE1hdGguY2VpbChyZXN1bHQubXNCZWZvcmVOZXh0IC8gMTAwMCksXG4gICAgICAgIGZhbGxiYWNrTW9kZTogcmVzdWx0LmZhbGxiYWNrTW9kZVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDI5KS5qc29uKHtcbiAgICAgICAgZXJyb3I6ICdSYXRlIGxpbWl0IGV4Y2VlZGVkJyxcbiAgICAgICAgbWVzc2FnZTogYFRvbyBtYW55IHJlcXVlc3RzLiBMaW1pdDogJHtjb25maWcubWF4UmVxdWVzdHN9IHBlciAke01hdGgucm91bmQoY29uZmlnLndpbmRvd01zIC8gNjAwMDApfSBtaW51dGVzYCxcbiAgICAgICAgcmV0cnlBZnRlcjogTWF0aC5jZWlsKHJlc3VsdC5tc0JlZm9yZU5leHQgLyAxMDAwKSxcbiAgICAgICAgbGltaXQ6IGNvbmZpZy5tYXhSZXF1ZXN0cyxcbiAgICAgICAgcmVtYWluaW5nOiByZXN1bHQucmVtYWluaW5nUG9pbnRzLFxuICAgICAgICByZXNldFRpbWU6IG5ldyBEYXRlKERhdGUubm93KCkgKyByZXN1bHQubXNCZWZvcmVOZXh0KS50b0lTT1N0cmluZygpLFxuICAgICAgICBwb2xpY3k6IGNvbmZpZy5kZXNjcmlwdGlvblxuICAgICAgfSlcbiAgICB9XG4gICAgXG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgbG9nRGVidWcoJ1JhdGUgbGltaXQgY2hlY2sgcGFzc2VkJywge1xuICAgICAgZHVyYXRpb24sXG4gICAgICByZW1haW5pbmc6IHJlc3VsdC5yZW1haW5pbmdQb2ludHMsXG4gICAgICB0b3RhbEhpdHM6IHJlc3VsdC50b3RhbEhpdHMsXG4gICAgICBmYWxsYmFja01vZGU6IHJlc3VsdC5mYWxsYmFja01vZGVcbiAgICB9KVxuICAgIFxuICAgIG5leHQoKVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZVxuICAgIGxvZ0Vycm9yKCdSYXRlIGxpbWl0aW5nIG1pZGRsZXdhcmUgZXJyb3InLCB7IFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICBkdXJhdGlvbixcbiAgICAgIGZhbGxiYWNrOiAnYWxsb3dpbmcgcmVxdWVzdCdcbiAgICB9KVxuICAgIFxuICAgIC8vIE9uIGVycm9yLCBhbGxvdyB0aGUgcmVxdWVzdCBidXQgbG9nIHRoZSBpc3N1ZVxuICAgIG5leHQoKVxuICB9XG59XG5cbi8qKlxuICogUmF0ZSBsaW1pdGluZyBtaWRkbGV3YXJlIGZhY3RvcnkgZm9yIGN1c3RvbSBjb25maWd1cmF0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmF0ZUxpbWl0ZXIoY3VzdG9tQ29uZmlnKSB7XG4gIHJldHVybiBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBjb25zdCBjb25maWcgPSB7IC4uLlJBVEVfTElNSVRfQ09ORklHUy5kZWZhdWx0LCAuLi5jdXN0b21Db25maWcgfVxuICAgIGNvbnN0IGlkZW50aWZpZXIgPSBnZXRSYXRlTGltaXRJZGVudGlmaWVyKHJlcSlcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gc2hvdWxkVXNlRmFsbGJhY2tNb2RlKClcbiAgICAgICAgPyBhd2FpdCBtZW1vcnlGYWxsYmFjay5jaGVja1JhdGVMaW1pdChpZGVudGlmaWVyLCBjb25maWcpXG4gICAgICAgIDogYXdhaXQgUmVkaXNSYXRlTGltaXRlci5jaGVja1JhdGVMaW1pdChpZGVudGlmaWVyLCBjb25maWcpXG4gICAgICBcbiAgICAgIHJlcy5zZXRIZWFkZXIoJ1gtUmF0ZUxpbWl0LUxpbWl0JywgY29uZmlnLm1heFJlcXVlc3RzKVxuICAgICAgcmVzLnNldEhlYWRlcignWC1SYXRlTGltaXQtUmVtYWluaW5nJywgcmVzdWx0LnJlbWFpbmluZ1BvaW50cylcbiAgICAgIHJlcy5zZXRIZWFkZXIoJ1gtUmF0ZUxpbWl0LVJlc2V0JywgbmV3IERhdGUoRGF0ZS5ub3coKSArIHJlc3VsdC5tc0JlZm9yZU5leHQpLnRvSVNPU3RyaW5nKCkpXG4gICAgICBcbiAgICAgIGlmICghcmVzdWx0LmFsbG93ZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDI5KS5qc29uKHtcbiAgICAgICAgICBlcnJvcjogJ1JhdGUgbGltaXQgZXhjZWVkZWQnLFxuICAgICAgICAgIHJldHJ5QWZ0ZXI6IE1hdGguY2VpbChyZXN1bHQubXNCZWZvcmVOZXh0IC8gMTAwMClcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgbmV4dCgpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ0Vycm9yKCdDdXN0b20gcmF0ZSBsaW1pdGVyIGVycm9yJywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KVxuICAgICAgbmV4dCgpIC8vIEFsbG93IHJlcXVlc3Qgb24gZXJyb3JcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgcmF0ZSBsaW1pdCBzdGF0dXMgZm9yIG1vbml0b3JpbmdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFJhdGVMaW1pdFN0YXR1cyhpZGVudGlmaWVyLCBjb25maWcgPSBSQVRFX0xJTUlUX0NPTkZJR1MuZGVmYXVsdCkge1xuICB0cnkge1xuICAgIGlmIChzaG91bGRVc2VGYWxsYmFja01vZGUoKSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbW9kZTogJ21lbW9yeScsXG4gICAgICAgIHN0YXR1czogJ29wZXJhdGlvbmFsJyxcbiAgICAgICAgbm90ZTogJ1VzaW5nIG1lbW9yeSBmYWxsYmFjaydcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgY29uc3QgcmVkaXMgPSBhd2FpdCBnZXRSZWRpc0NsaWVudCgpXG4gICAgY29uc3Qga2V5ID0gYHJhdGVfbGltaXQ6JHtpZGVudGlmaWVyfWBcbiAgICBjb25zdCBjb3VudCA9IGF3YWl0IHJlZGlzLnpjYXJkKGtleSlcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgbW9kZTogJ3JlZGlzJyxcbiAgICAgIHN0YXR1czogJ29wZXJhdGlvbmFsJyxcbiAgICAgIGN1cnJlbnRDb3VudDogY291bnQsXG4gICAgICBsaW1pdDogY29uZmlnLm1heFJlcXVlc3RzLFxuICAgICAgcmVtYWluaW5nOiBNYXRoLm1heCgwLCBjb25maWcubWF4UmVxdWVzdHMgLSBjb3VudClcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1vZGU6ICdlcnJvcicsXG4gICAgICBzdGF0dXM6ICdkZWdyYWRlZCcsXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxuICAgIH1cbiAgfVxufVxuXG4vLyBDbGVhbnVwIG9uIHNodXRkb3duXG5wcm9jZXNzLm9uKCdTSUdURVJNJywgKCkgPT4gbWVtb3J5RmFsbGJhY2suZGVzdHJveSgpKVxucHJvY2Vzcy5vbignU0lHSU5UJywgKCkgPT4gbWVtb3J5RmFsbGJhY2suZGVzdHJveSgpKSJdLCJuYW1lcyI6WyJnZXRSZWRpc0NsaWVudCIsInNob3VsZFVzZUZhbGxiYWNrTW9kZSIsImxvZ0luZm8iLCJsb2dFcnJvciIsImxvZ1dhcm4iLCJsb2dEZWJ1ZyIsIlNlY3VyaXR5VmFsaWRhdG9yIiwiUkFURV9MSU1JVF9DT05GSUdTIiwid2luZG93TXMiLCJtYXhSZXF1ZXN0cyIsInNraXBTdWNjZXNzZnVsUmVxdWVzdHMiLCJza2lwRmFpbGVkUmVxdWVzdHMiLCJkZXNjcmlwdGlvbiIsIk1lbW9yeUZhbGxiYWNrTGltaXRlciIsImNvbnN0cnVjdG9yIiwic3RvcmUiLCJNYXAiLCJjbGVhbnVwSW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImNsZWFudXAiLCJjaGVja1JhdGVMaW1pdCIsImlkZW50aWZpZXIiLCJjb25maWciLCJub3ciLCJEYXRlIiwid2luZG93U3RhcnQiLCJoYXMiLCJzZXQiLCJyZXF1ZXN0cyIsImdldCIsInZhbGlkUmVxdWVzdHMiLCJmaWx0ZXIiLCJ0aW1lc3RhbXAiLCJsZW5ndGgiLCJhbGxvd2VkIiwidG90YWxIaXRzIiwicmVtYWluaW5nUG9pbnRzIiwibXNCZWZvcmVOZXh0IiwiTWF0aCIsIm1pbiIsImZhbGxiYWNrTW9kZSIsInB1c2giLCJlbnRyaWVzIiwiZGVsZXRlIiwiaWRlbnRpZmllcnMiLCJzaXplIiwiZGVzdHJveSIsImNsZWFySW50ZXJ2YWwiLCJjbGVhciIsIm1lbW9yeUZhbGxiYWNrIiwiUmVkaXNSYXRlTGltaXRlciIsInJlZGlzIiwia2V5IiwicGlwZWxpbmUiLCJ6cmVtcmFuZ2VieXNjb3JlIiwiemNhcmQiLCJ6YWRkIiwicmFuZG9tIiwiZXhwaXJlIiwiY2VpbCIsInJlc3VsdHMiLCJleGVjIiwic29tZSIsImVyciIsIkVycm9yIiwiY3VycmVudENvdW50IiwienJlbSIsIm1heCIsImdldFRpbWVVbnRpbE5leHRBbGxvd2VkIiwiZXJyb3IiLCJtZXNzYWdlIiwic3Vic3RyaW5nIiwib2xkZXN0RW50cnkiLCJ6cmFuZ2UiLCJvbGRlc3RUaW1lc3RhbXAiLCJwYXJzZUludCIsInRpbWVVbnRpbEV4cGlyeSIsImdldFJhdGVMaW1pdENvbmZpZyIsInJlcSIsInBhdGgiLCJ1cmwiLCJuZXh0VXJsIiwicGF0aG5hbWUiLCJzdGFydHNXaXRoIiwiaW5jbHVkZXMiLCJhcGlfaW50ZWxsaWdlbmNlIiwiYXBpX3ZvbGF0aWxlIiwiYXBpX2F1dGgiLCJhcGlfZ2VuZXJhbCIsInBhZ2VfcmVxdWVzdHMiLCJkZWZhdWx0IiwiZ2V0UmF0ZUxpbWl0SWRlbnRpZmllciIsImNsaWVudElQIiwiaGVhZGVycyIsInNwbGl0IiwidHJpbSIsImNvbm5lY3Rpb24iLCJyZW1vdGVBZGRyZXNzIiwic29ja2V0IiwidXNlckFnZW50Iiwic2FuaXRpemVkSVAiLCJzYW5pdGl6ZVN0cmluZyIsInNhbml0aXplZFVBIiwic2FuaXRpemVkUGF0aCIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsInJhdGVMaW1pdE1pZGRsZXdhcmUiLCJyZXMiLCJuZXh0Iiwic3RhcnRUaW1lIiwicHJvY2VzcyIsImVudiIsIlNLSVBfUkFURV9MSU1JVCIsInJlc3VsdCIsInNldEhlYWRlciIsInRvSVNPU3RyaW5nIiwibGltaXQiLCJyZXRyeUFmdGVyIiwic3RhdHVzIiwianNvbiIsInJvdW5kIiwicmVtYWluaW5nIiwicmVzZXRUaW1lIiwicG9saWN5IiwiZHVyYXRpb24iLCJmYWxsYmFjayIsImNyZWF0ZVJhdGVMaW1pdGVyIiwiY3VzdG9tQ29uZmlnIiwiZ2V0UmF0ZUxpbWl0U3RhdHVzIiwibW9kZSIsIm5vdGUiLCJjb3VudCIsIm9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/middleware/redis-rate-limiter.js\n");

/***/ }),

/***/ "(api)/./lib/monitoring.js":
/*!***************************!*\
  !*** ./lib/monitoring.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAlert: () => (/* binding */ createAlert),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getHealthMetrics: () => (/* binding */ getHealthMetrics),\n/* harmony export */   monitoring: () => (/* binding */ monitoring),\n/* harmony export */   trackAPICall: () => (/* binding */ trackAPICall),\n/* harmony export */   trackBusinessEvent: () => (/* binding */ trackBusinessEvent),\n/* harmony export */   trackDatabaseOperation: () => (/* binding */ trackDatabaseOperation),\n/* harmony export */   trackError: () => (/* binding */ trackError),\n/* harmony export */   trackMetric: () => (/* binding */ trackMetric)\n/* harmony export */ });\n/* harmony import */ var _production_logger_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./production-logger.js */ \"(api)/./lib/production-logger.js\");\n/* harmony import */ var _environment_validation_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./environment-validation.js */ \"(api)/./lib/environment-validation.js\");\n/**\n * Monitoring and Error Tracking System\n * Production-ready monitoring infrastructure\n */ \n\nclass MonitoringSystem {\n    constructor(){\n        this.metrics = new Map();\n        this.alerts = new Map();\n        this.startTime = Date.now();\n        this.errorCount = 0;\n        this.requestCount = 0;\n        // Initialize performance tracking\n        this.initializePerformanceTracking();\n    }\n    /**\n   * Initialize performance monitoring\n   */ initializePerformanceTracking() {\n        if (false) {}\n        // Server-side process monitoring\n        process.on(\"uncaughtException\", (error)=>{\n            this.trackError(\"uncaught_exception\", error);\n            process.exit(1);\n        });\n        process.on(\"unhandledRejection\", (reason, promise)=>{\n            this.trackError(\"unhandled_rejection\", reason);\n        });\n    }\n    /**\n   * Track Web Vitals for client performance\n   */ trackWebVitals() {\n        if (true) return;\n        // Largest Contentful Paint (LCP)\n        this.observePerformance(\"largest-contentful-paint\", (entry)=>{\n            this.trackMetric(\"web_vitals.lcp\", entry.value, {\n                url: window.location.pathname,\n                timestamp: Date.now()\n            });\n        });\n        // First Input Delay (FID)\n        this.observePerformance(\"first-input\", (entry)=>{\n            this.trackMetric(\"web_vitals.fid\", entry.processingStart - entry.startTime, {\n                url: window.location.pathname,\n                timestamp: Date.now()\n            });\n        });\n        // Cumulative Layout Shift (CLS)\n        this.observePerformance(\"layout-shift\", (entry)=>{\n            if (!entry.hadRecentInput) {\n                this.trackMetric(\"web_vitals.cls\", entry.value, {\n                    url: window.location.pathname,\n                    timestamp: Date.now()\n                });\n            }\n        });\n    }\n    /**\n   * Observe performance entries\n   */ observePerformance(entryType, callback) {\n        if (\"PerformanceObserver\" in window) {\n            const observer = new PerformanceObserver((list)=>{\n                list.getEntries().forEach(callback);\n            });\n            observer.observe({\n                entryTypes: [\n                    entryType\n                ]\n            });\n        }\n    }\n    /**\n   * Track custom metrics\n   */ trackMetric(name, value, metadata = {}) {\n        const metric = {\n            name,\n            value,\n            timestamp: Date.now(),\n            metadata\n        };\n        this.metrics.set(`${name}_${Date.now()}`, metric);\n        _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.info(`Metric: ${name}`, {\n            value,\n            metadata\n        });\n        // Send to external monitoring service in production\n        if ((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n            this.sendToMonitoringService(\"metric\", metric);\n        }\n    }\n    /**\n   * Track errors with context\n   */ trackError(type, error, context = {}) {\n        this.errorCount++;\n        const errorData = {\n            type,\n            message: error.message || error,\n            stack: error.stack,\n            timestamp: Date.now(),\n            context,\n            userAgent: typeof navigator !== \"undefined\" ? navigator.userAgent : \"Server\",\n            url:  false ? 0 : context.url || \"Unknown\"\n        };\n        _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.error(`Error tracked: ${type}`, errorData);\n        // Send to error tracking service\n        if ((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n            this.sendToErrorTracking(errorData);\n        }\n        // Create alert for critical errors\n        if (this.isCriticalError(error)) {\n            this.createAlert(\"critical_error\", `Critical error: ${error.message}`, errorData);\n        }\n    }\n    /**\n   * Track API performance\n   */ trackAPICall(method, endpoint, duration, statusCode, error = null) {\n        this.requestCount++;\n        const apiMetric = {\n            method,\n            endpoint,\n            duration,\n            statusCode,\n            timestamp: Date.now(),\n            success: !error && statusCode < 400,\n            error: error ? error.message : null\n        };\n        this.trackMetric(\"api.request\", duration, apiMetric);\n        if (error) {\n            this.trackError(\"api_error\", error, apiMetric);\n        }\n        // Alert on high latency\n        if (duration > 5000) {\n            this.createAlert(\"high_latency\", `Slow API call: ${method} ${endpoint}`, apiMetric);\n        }\n        // Alert on high error rate\n        this.checkErrorRate();\n    }\n    /**\n   * Track database operations\n   */ trackDatabaseOperation(table, operation, duration, recordCount = null, error = null) {\n        const dbMetric = {\n            table,\n            operation,\n            duration,\n            recordCount,\n            timestamp: Date.now(),\n            success: !error\n        };\n        this.trackMetric(\"db.query\", duration, dbMetric);\n        if (error) {\n            this.trackError(\"database_error\", error, dbMetric);\n        }\n        // Alert on slow queries\n        if (duration > 1000) {\n            this.createAlert(\"slow_query\", `Slow database query: ${operation} on ${table}`, dbMetric);\n        }\n    }\n    /**\n   * Track business events\n   */ trackBusinessEvent(event, data = {}) {\n        const businessEvent = {\n            event,\n            data,\n            timestamp: Date.now(),\n            session: this.getSessionId()\n        };\n        _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.business(event, businessEvent);\n        if ((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n            this.sendToAnalytics(businessEvent);\n        }\n    }\n    /**\n   * Create monitoring alerts\n   */ createAlert(type, message, data = {}) {\n        const alert = {\n            type,\n            message,\n            data,\n            timestamp: Date.now(),\n            severity: this.getAlertSeverity(type),\n            acknowledged: false\n        };\n        this.alerts.set(`${type}_${Date.now()}`, alert);\n        _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.warn(`Alert created: ${type}`, alert);\n        // Send to alerting system\n        if ((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n            this.sendAlert(alert);\n        }\n    }\n    /**\n   * Get system health metrics\n   */ getHealthMetrics() {\n        const uptime = Date.now() - this.startTime;\n        const memoryUsage = process.memoryUsage();\n        return {\n            uptime: Math.floor(uptime / 1000),\n            requests: {\n                total: this.requestCount,\n                errors: this.errorCount,\n                errorRate: this.requestCount > 0 ? this.errorCount / this.requestCount * 100 : 0\n            },\n            memory: {\n                heapUsed: Math.round(memoryUsage.heapUsed / 1024 / 1024),\n                heapTotal: Math.round(memoryUsage.heapTotal / 1024 / 1024),\n                external: Math.round(memoryUsage.external / 1024 / 1024) // MB\n            },\n            activeAlerts: Array.from(this.alerts.values()).filter((alert)=>!alert.acknowledged).length,\n            metricsCollected: this.metrics.size\n        };\n    }\n    /**\n   * Check error rate and create alerts\n   */ checkErrorRate() {\n        if (this.requestCount > 100) {\n            const errorRate = this.errorCount / this.requestCount * 100;\n            if (errorRate > 5) {\n                this.createAlert(\"high_error_rate\", `Error rate is ${errorRate.toFixed(2)}%`, {\n                    errorRate,\n                    totalRequests: this.requestCount,\n                    totalErrors: this.errorCount\n                });\n            }\n        }\n    }\n    /**\n   * Determine if error is critical\n   */ isCriticalError(error) {\n        const criticalPatterns = [\n            /database.*connection/i,\n            /payment.*failed/i,\n            /authentication.*failed/i,\n            /security.*violation/i,\n            /server.*error/i\n        ];\n        const errorMessage = error.message || error.toString();\n        return criticalPatterns.some((pattern)=>pattern.test(errorMessage));\n    }\n    /**\n   * Get alert severity level\n   */ getAlertSeverity(type) {\n        const severityMap = {\n            critical_error: \"critical\",\n            high_error_rate: \"high\",\n            high_latency: \"medium\",\n            slow_query: \"medium\",\n            security_violation: \"critical\",\n            payment_failure: \"critical\"\n        };\n        return severityMap[type] || \"low\";\n    }\n    /**\n   * Get session identifier\n   */ getSessionId() {\n        if (false) {}\n        return `server_${Date.now()}`;\n    }\n    /**\n   * Send data to external monitoring service\n   */ async sendToMonitoringService(type, data) {\n        try {\n            // Example integration with monitoring service\n            if (process.env.MONITORING_ENDPOINT) {\n                await fetch(process.env.MONITORING_ENDPOINT, {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\",\n                        \"Authorization\": `Bearer ${process.env.MONITORING_API_KEY}`\n                    },\n                    body: JSON.stringify({\n                        type,\n                        data,\n                        source: \"triangle-intelligence\"\n                    })\n                });\n            }\n        } catch (error) {\n            _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to send monitoring data\", {\n                error: error.message,\n                type,\n                data\n            });\n        }\n    }\n    /**\n   * Send error to tracking service\n   */ async sendToErrorTracking(errorData) {\n        try {\n            // Example Sentry integration\n            if (process.env.SENTRY_DSN) {\n                // Sentry.captureException would go here\n                _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.debug(\"Would send to Sentry\", {\n                    error: errorData\n                });\n            }\n        } catch (error) {\n            _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to send error tracking data\", {\n                error: error.message,\n                errorData\n            });\n        }\n    }\n    /**\n   * Send business event to analytics\n   */ async sendToAnalytics(event) {\n        try {\n            // Example analytics integration\n            if (process.env.ANALYTICS_ENDPOINT) {\n                await fetch(process.env.ANALYTICS_ENDPOINT, {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\",\n                        \"Authorization\": `Bearer ${process.env.ANALYTICS_API_KEY}`\n                    },\n                    body: JSON.stringify(event)\n                });\n            }\n        } catch (error) {\n            _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to send analytics data\", {\n                error: error.message,\n                event\n            });\n        }\n    }\n    /**\n   * Send alert notification\n   */ async sendAlert(alert) {\n        try {\n            // Example alert notification (Slack, PagerDuty, etc.)\n            if (process.env.ALERT_WEBHOOK_URL) {\n                await fetch(process.env.ALERT_WEBHOOK_URL, {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        text: `🚨 Triangle Intelligence Alert: ${alert.message}`,\n                        severity: alert.severity,\n                        timestamp: new Date(alert.timestamp).toISOString(),\n                        data: alert.data\n                    })\n                });\n            }\n        } catch (error) {\n            _production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to send alert\", {\n                error: error.message,\n                alert\n            });\n        }\n    }\n}\n// Create singleton monitoring instance\nconst monitoring = new MonitoringSystem();\n// Convenience functions\nconst trackMetric = (name, value, metadata)=>monitoring.trackMetric(name, value, metadata);\nconst trackError = (type, error, context)=>monitoring.trackError(type, error, context);\nconst trackAPICall = (method, endpoint, duration, statusCode, error)=>monitoring.trackAPICall(method, endpoint, duration, statusCode, error);\nconst trackDatabaseOperation = (table, operation, duration, recordCount, error)=>monitoring.trackDatabaseOperation(table, operation, duration, recordCount, error);\nconst trackBusinessEvent = (event, data)=>monitoring.trackBusinessEvent(event, data);\nconst createAlert = (type, message, data)=>monitoring.createAlert(type, message, data);\nconst getHealthMetrics = ()=>monitoring.getHealthMetrics();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (monitoring);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNyRTtJQUNGO0FBQ0Y7QUFFQSx1Q0FBdUM7QUFDaEMsTUFBTWtFLGFBQWEsSUFBSWhKLG1CQUFrQjtBQUVoRCx3QkFBd0I7QUFDakIsTUFBTXVCLGNBQWMsQ0FBQ2lCLE1BQU1oQixPQUFPaUIsV0FBYXVHLFdBQVd6SCxXQUFXLENBQUNpQixNQUFNaEIsT0FBT2lCLFVBQVM7QUFDNUYsTUFBTXhCLGFBQWEsQ0FBQzZCLE1BQU05QixPQUFPK0IsVUFBWWlHLFdBQVcvSCxVQUFVLENBQUM2QixNQUFNOUIsT0FBTytCLFNBQVE7QUFDeEYsTUFBTVUsZUFBZSxDQUFDQyxRQUFRQyxVQUFVQyxVQUFVQyxZQUFZN0MsUUFDbkVnSSxXQUFXdkYsWUFBWSxDQUFDQyxRQUFRQyxVQUFVQyxVQUFVQyxZQUFZN0MsT0FBTTtBQUNqRSxNQUFNaUQseUJBQXlCLENBQUNDLE9BQU9DLFdBQVdQLFVBQVVRLGFBQWFwRCxRQUM5RWdJLFdBQVcvRSxzQkFBc0IsQ0FBQ0MsT0FBT0MsV0FBV1AsVUFBVVEsYUFBYXBELE9BQU07QUFDNUUsTUFBTXNELHFCQUFxQixDQUFDQyxPQUFPQyxPQUFTd0UsV0FBVzFFLGtCQUFrQixDQUFDQyxPQUFPQyxNQUFLO0FBQ3RGLE1BQU1oQixjQUFjLENBQUNWLE1BQU1HLFNBQVN1QixPQUFTd0UsV0FBV3hGLFdBQVcsQ0FBQ1YsTUFBTUcsU0FBU3VCLE1BQUs7QUFDeEYsTUFBTVksbUJBQW1CLElBQU00RCxXQUFXNUQsZ0JBQWdCLEdBQUU7QUFFbkUsaUVBQWU0RCxVQUFVQSxFQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJpYW5nbGUtaW50ZWxsaWdlbmNlLXBsYXRmb3JtLy4vbGliL21vbml0b3JpbmcuanM/YzI5NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1vbml0b3JpbmcgYW5kIEVycm9yIFRyYWNraW5nIFN5c3RlbVxuICogUHJvZHVjdGlvbi1yZWFkeSBtb25pdG9yaW5nIGluZnJhc3RydWN0dXJlXG4gKi9cblxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi9wcm9kdWN0aW9uLWxvZ2dlci5qcydcbmltcG9ydCB7IGlzUHJvZHVjdGlvbiwgaXNEZXZlbG9wbWVudCB9IGZyb20gJy4vZW52aXJvbm1lbnQtdmFsaWRhdGlvbi5qcydcblxuY2xhc3MgTW9uaXRvcmluZ1N5c3RlbSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMubWV0cmljcyA9IG5ldyBNYXAoKVxuICAgIHRoaXMuYWxlcnRzID0gbmV3IE1hcCgpXG4gICAgdGhpcy5zdGFydFRpbWUgPSBEYXRlLm5vdygpXG4gICAgdGhpcy5lcnJvckNvdW50ID0gMFxuICAgIHRoaXMucmVxdWVzdENvdW50ID0gMFxuICAgIFxuICAgIC8vIEluaXRpYWxpemUgcGVyZm9ybWFuY2UgdHJhY2tpbmdcbiAgICB0aGlzLmluaXRpYWxpemVQZXJmb3JtYW5jZVRyYWNraW5nKClcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHBlcmZvcm1hbmNlIG1vbml0b3JpbmdcbiAgICovXG4gIGluaXRpYWxpemVQZXJmb3JtYW5jZVRyYWNraW5nKCkge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGVyZm9ybWFuY2UpIHtcbiAgICAgIC8vIENsaWVudC1zaWRlIHBlcmZvcm1hbmNlIG1vbml0b3JpbmdcbiAgICAgIHRoaXMudHJhY2tXZWJWaXRhbHMoKVxuICAgIH1cbiAgICBcbiAgICAvLyBTZXJ2ZXItc2lkZSBwcm9jZXNzIG1vbml0b3JpbmdcbiAgICBwcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsIChlcnJvcikgPT4ge1xuICAgICAgdGhpcy50cmFja0Vycm9yKCd1bmNhdWdodF9leGNlcHRpb24nLCBlcnJvcilcbiAgICAgIHByb2Nlc3MuZXhpdCgxKVxuICAgIH0pXG4gICAgXG4gICAgcHJvY2Vzcy5vbigndW5oYW5kbGVkUmVqZWN0aW9uJywgKHJlYXNvbiwgcHJvbWlzZSkgPT4ge1xuICAgICAgdGhpcy50cmFja0Vycm9yKCd1bmhhbmRsZWRfcmVqZWN0aW9uJywgcmVhc29uKVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogVHJhY2sgV2ViIFZpdGFscyBmb3IgY2xpZW50IHBlcmZvcm1hbmNlXG4gICAqL1xuICB0cmFja1dlYlZpdGFscygpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVyblxuXG4gICAgLy8gTGFyZ2VzdCBDb250ZW50ZnVsIFBhaW50IChMQ1ApXG4gICAgdGhpcy5vYnNlcnZlUGVyZm9ybWFuY2UoJ2xhcmdlc3QtY29udGVudGZ1bC1wYWludCcsIChlbnRyeSkgPT4ge1xuICAgICAgdGhpcy50cmFja01ldHJpYygnd2ViX3ZpdGFscy5sY3AnLCBlbnRyeS52YWx1ZSwge1xuICAgICAgICB1cmw6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICAvLyBGaXJzdCBJbnB1dCBEZWxheSAoRklEKVxuICAgIHRoaXMub2JzZXJ2ZVBlcmZvcm1hbmNlKCdmaXJzdC1pbnB1dCcsIChlbnRyeSkgPT4ge1xuICAgICAgdGhpcy50cmFja01ldHJpYygnd2ViX3ZpdGFscy5maWQnLCBlbnRyeS5wcm9jZXNzaW5nU3RhcnQgLSBlbnRyeS5zdGFydFRpbWUsIHtcbiAgICAgICAgdXJsOiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUsXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgLy8gQ3VtdWxhdGl2ZSBMYXlvdXQgU2hpZnQgKENMUylcbiAgICB0aGlzLm9ic2VydmVQZXJmb3JtYW5jZSgnbGF5b3V0LXNoaWZ0JywgKGVudHJ5KSA9PiB7XG4gICAgICBpZiAoIWVudHJ5LmhhZFJlY2VudElucHV0KSB7XG4gICAgICAgIHRoaXMudHJhY2tNZXRyaWMoJ3dlYl92aXRhbHMuY2xzJywgZW50cnkudmFsdWUsIHtcbiAgICAgICAgICB1cmw6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIE9ic2VydmUgcGVyZm9ybWFuY2UgZW50cmllc1xuICAgKi9cbiAgb2JzZXJ2ZVBlcmZvcm1hbmNlKGVudHJ5VHlwZSwgY2FsbGJhY2spIHtcbiAgICBpZiAoJ1BlcmZvcm1hbmNlT2JzZXJ2ZXInIGluIHdpbmRvdykge1xuICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgUGVyZm9ybWFuY2VPYnNlcnZlcigobGlzdCkgPT4ge1xuICAgICAgICBsaXN0LmdldEVudHJpZXMoKS5mb3JFYWNoKGNhbGxiYWNrKVxuICAgICAgfSlcbiAgICAgIG9ic2VydmVyLm9ic2VydmUoeyBlbnRyeVR5cGVzOiBbZW50cnlUeXBlXSB9KVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFjayBjdXN0b20gbWV0cmljc1xuICAgKi9cbiAgdHJhY2tNZXRyaWMobmFtZSwgdmFsdWUsIG1ldGFkYXRhID0ge30pIHtcbiAgICBjb25zdCBtZXRyaWMgPSB7XG4gICAgICBuYW1lLFxuICAgICAgdmFsdWUsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICBtZXRhZGF0YVxuICAgIH1cblxuICAgIHRoaXMubWV0cmljcy5zZXQoYCR7bmFtZX1fJHtEYXRlLm5vdygpfWAsIG1ldHJpYylcbiAgICBcbiAgICBsb2dnZXIuaW5mbyhgTWV0cmljOiAke25hbWV9YCwgeyB2YWx1ZSwgbWV0YWRhdGEgfSlcblxuICAgIC8vIFNlbmQgdG8gZXh0ZXJuYWwgbW9uaXRvcmluZyBzZXJ2aWNlIGluIHByb2R1Y3Rpb25cbiAgICBpZiAoaXNQcm9kdWN0aW9uKCkpIHtcbiAgICAgIHRoaXMuc2VuZFRvTW9uaXRvcmluZ1NlcnZpY2UoJ21ldHJpYycsIG1ldHJpYylcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVHJhY2sgZXJyb3JzIHdpdGggY29udGV4dFxuICAgKi9cbiAgdHJhY2tFcnJvcih0eXBlLCBlcnJvciwgY29udGV4dCA9IHt9KSB7XG4gICAgdGhpcy5lcnJvckNvdW50KytcbiAgICBcbiAgICBjb25zdCBlcnJvckRhdGEgPSB7XG4gICAgICB0eXBlLFxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCBlcnJvcixcbiAgICAgIHN0YWNrOiBlcnJvci5zdGFjayxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgIGNvbnRleHQsXG4gICAgICB1c2VyQWdlbnQ6IHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnID8gbmF2aWdhdG9yLnVzZXJBZ2VudCA6ICdTZXJ2ZXInLFxuICAgICAgdXJsOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdy5sb2NhdGlvbi5ocmVmIDogY29udGV4dC51cmwgfHwgJ1Vua25vd24nXG4gICAgfVxuXG4gICAgbG9nZ2VyLmVycm9yKGBFcnJvciB0cmFja2VkOiAke3R5cGV9YCwgZXJyb3JEYXRhKVxuXG4gICAgLy8gU2VuZCB0byBlcnJvciB0cmFja2luZyBzZXJ2aWNlXG4gICAgaWYgKGlzUHJvZHVjdGlvbigpKSB7XG4gICAgICB0aGlzLnNlbmRUb0Vycm9yVHJhY2tpbmcoZXJyb3JEYXRhKVxuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhbGVydCBmb3IgY3JpdGljYWwgZXJyb3JzXG4gICAgaWYgKHRoaXMuaXNDcml0aWNhbEVycm9yKGVycm9yKSkge1xuICAgICAgdGhpcy5jcmVhdGVBbGVydCgnY3JpdGljYWxfZXJyb3InLCBgQ3JpdGljYWwgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gLCBlcnJvckRhdGEpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRyYWNrIEFQSSBwZXJmb3JtYW5jZVxuICAgKi9cbiAgdHJhY2tBUElDYWxsKG1ldGhvZCwgZW5kcG9pbnQsIGR1cmF0aW9uLCBzdGF0dXNDb2RlLCBlcnJvciA9IG51bGwpIHtcbiAgICB0aGlzLnJlcXVlc3RDb3VudCsrXG4gICAgXG4gICAgY29uc3QgYXBpTWV0cmljID0ge1xuICAgICAgbWV0aG9kLFxuICAgICAgZW5kcG9pbnQsXG4gICAgICBkdXJhdGlvbixcbiAgICAgIHN0YXR1c0NvZGUsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICBzdWNjZXNzOiAhZXJyb3IgJiYgc3RhdHVzQ29kZSA8IDQwMCxcbiAgICAgIGVycm9yOiBlcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBudWxsXG4gICAgfVxuXG4gICAgdGhpcy50cmFja01ldHJpYygnYXBpLnJlcXVlc3QnLCBkdXJhdGlvbiwgYXBpTWV0cmljKVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICB0aGlzLnRyYWNrRXJyb3IoJ2FwaV9lcnJvcicsIGVycm9yLCBhcGlNZXRyaWMpXG4gICAgfVxuXG4gICAgLy8gQWxlcnQgb24gaGlnaCBsYXRlbmN5XG4gICAgaWYgKGR1cmF0aW9uID4gNTAwMCkge1xuICAgICAgdGhpcy5jcmVhdGVBbGVydCgnaGlnaF9sYXRlbmN5JywgYFNsb3cgQVBJIGNhbGw6ICR7bWV0aG9kfSAke2VuZHBvaW50fWAsIGFwaU1ldHJpYylcbiAgICB9XG5cbiAgICAvLyBBbGVydCBvbiBoaWdoIGVycm9yIHJhdGVcbiAgICB0aGlzLmNoZWNrRXJyb3JSYXRlKClcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFjayBkYXRhYmFzZSBvcGVyYXRpb25zXG4gICAqL1xuICB0cmFja0RhdGFiYXNlT3BlcmF0aW9uKHRhYmxlLCBvcGVyYXRpb24sIGR1cmF0aW9uLCByZWNvcmRDb3VudCA9IG51bGwsIGVycm9yID0gbnVsbCkge1xuICAgIGNvbnN0IGRiTWV0cmljID0ge1xuICAgICAgdGFibGUsXG4gICAgICBvcGVyYXRpb24sXG4gICAgICBkdXJhdGlvbixcbiAgICAgIHJlY29yZENvdW50LFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgc3VjY2VzczogIWVycm9yXG4gICAgfVxuXG4gICAgdGhpcy50cmFja01ldHJpYygnZGIucXVlcnknLCBkdXJhdGlvbiwgZGJNZXRyaWMpXG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHRoaXMudHJhY2tFcnJvcignZGF0YWJhc2VfZXJyb3InLCBlcnJvciwgZGJNZXRyaWMpXG4gICAgfVxuXG4gICAgLy8gQWxlcnQgb24gc2xvdyBxdWVyaWVzXG4gICAgaWYgKGR1cmF0aW9uID4gMTAwMCkge1xuICAgICAgdGhpcy5jcmVhdGVBbGVydCgnc2xvd19xdWVyeScsIGBTbG93IGRhdGFiYXNlIHF1ZXJ5OiAke29wZXJhdGlvbn0gb24gJHt0YWJsZX1gLCBkYk1ldHJpYylcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVHJhY2sgYnVzaW5lc3MgZXZlbnRzXG4gICAqL1xuICB0cmFja0J1c2luZXNzRXZlbnQoZXZlbnQsIGRhdGEgPSB7fSkge1xuICAgIGNvbnN0IGJ1c2luZXNzRXZlbnQgPSB7XG4gICAgICBldmVudCxcbiAgICAgIGRhdGEsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICBzZXNzaW9uOiB0aGlzLmdldFNlc3Npb25JZCgpXG4gICAgfVxuXG4gICAgbG9nZ2VyLmJ1c2luZXNzKGV2ZW50LCBidXNpbmVzc0V2ZW50KVxuXG4gICAgaWYgKGlzUHJvZHVjdGlvbigpKSB7XG4gICAgICB0aGlzLnNlbmRUb0FuYWx5dGljcyhidXNpbmVzc0V2ZW50KVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgbW9uaXRvcmluZyBhbGVydHNcbiAgICovXG4gIGNyZWF0ZUFsZXJ0KHR5cGUsIG1lc3NhZ2UsIGRhdGEgPSB7fSkge1xuICAgIGNvbnN0IGFsZXJ0ID0ge1xuICAgICAgdHlwZSxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBkYXRhLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgc2V2ZXJpdHk6IHRoaXMuZ2V0QWxlcnRTZXZlcml0eSh0eXBlKSxcbiAgICAgIGFja25vd2xlZGdlZDogZmFsc2VcbiAgICB9XG5cbiAgICB0aGlzLmFsZXJ0cy5zZXQoYCR7dHlwZX1fJHtEYXRlLm5vdygpfWAsIGFsZXJ0KVxuICAgIFxuICAgIGxvZ2dlci53YXJuKGBBbGVydCBjcmVhdGVkOiAke3R5cGV9YCwgYWxlcnQpXG5cbiAgICAvLyBTZW5kIHRvIGFsZXJ0aW5nIHN5c3RlbVxuICAgIGlmIChpc1Byb2R1Y3Rpb24oKSkge1xuICAgICAgdGhpcy5zZW5kQWxlcnQoYWxlcnQpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzeXN0ZW0gaGVhbHRoIG1ldHJpY3NcbiAgICovXG4gIGdldEhlYWx0aE1ldHJpY3MoKSB7XG4gICAgY29uc3QgdXB0aW1lID0gRGF0ZS5ub3coKSAtIHRoaXMuc3RhcnRUaW1lXG4gICAgY29uc3QgbWVtb3J5VXNhZ2UgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKClcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdXB0aW1lOiBNYXRoLmZsb29yKHVwdGltZSAvIDEwMDApLCAvLyBzZWNvbmRzXG4gICAgICByZXF1ZXN0czoge1xuICAgICAgICB0b3RhbDogdGhpcy5yZXF1ZXN0Q291bnQsXG4gICAgICAgIGVycm9yczogdGhpcy5lcnJvckNvdW50LFxuICAgICAgICBlcnJvclJhdGU6IHRoaXMucmVxdWVzdENvdW50ID4gMCA/ICh0aGlzLmVycm9yQ291bnQgLyB0aGlzLnJlcXVlc3RDb3VudCkgKiAxMDAgOiAwXG4gICAgICB9LFxuICAgICAgbWVtb3J5OiB7XG4gICAgICAgIGhlYXBVc2VkOiBNYXRoLnJvdW5kKG1lbW9yeVVzYWdlLmhlYXBVc2VkIC8gMTAyNCAvIDEwMjQpLCAvLyBNQlxuICAgICAgICBoZWFwVG90YWw6IE1hdGgucm91bmQobWVtb3J5VXNhZ2UuaGVhcFRvdGFsIC8gMTAyNCAvIDEwMjQpLCAvLyBNQlxuICAgICAgICBleHRlcm5hbDogTWF0aC5yb3VuZChtZW1vcnlVc2FnZS5leHRlcm5hbCAvIDEwMjQgLyAxMDI0KSAvLyBNQlxuICAgICAgfSxcbiAgICAgIGFjdGl2ZUFsZXJ0czogQXJyYXkuZnJvbSh0aGlzLmFsZXJ0cy52YWx1ZXMoKSkuZmlsdGVyKGFsZXJ0ID0+ICFhbGVydC5hY2tub3dsZWRnZWQpLmxlbmd0aCxcbiAgICAgIG1ldHJpY3NDb2xsZWN0ZWQ6IHRoaXMubWV0cmljcy5zaXplXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGVycm9yIHJhdGUgYW5kIGNyZWF0ZSBhbGVydHNcbiAgICovXG4gIGNoZWNrRXJyb3JSYXRlKCkge1xuICAgIGlmICh0aGlzLnJlcXVlc3RDb3VudCA+IDEwMCkgeyAvLyBPbmx5IGNoZWNrIGFmdGVyIG1pbmltdW0gcmVxdWVzdHNcbiAgICAgIGNvbnN0IGVycm9yUmF0ZSA9ICh0aGlzLmVycm9yQ291bnQgLyB0aGlzLnJlcXVlc3RDb3VudCkgKiAxMDBcbiAgICAgIFxuICAgICAgaWYgKGVycm9yUmF0ZSA+IDUpIHsgLy8gNSUgZXJyb3IgcmF0ZSB0aHJlc2hvbGRcbiAgICAgICAgdGhpcy5jcmVhdGVBbGVydCgnaGlnaF9lcnJvcl9yYXRlJywgYEVycm9yIHJhdGUgaXMgJHtlcnJvclJhdGUudG9GaXhlZCgyKX0lYCwge1xuICAgICAgICAgIGVycm9yUmF0ZSxcbiAgICAgICAgICB0b3RhbFJlcXVlc3RzOiB0aGlzLnJlcXVlc3RDb3VudCxcbiAgICAgICAgICB0b3RhbEVycm9yczogdGhpcy5lcnJvckNvdW50XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBpZiBlcnJvciBpcyBjcml0aWNhbFxuICAgKi9cbiAgaXNDcml0aWNhbEVycm9yKGVycm9yKSB7XG4gICAgY29uc3QgY3JpdGljYWxQYXR0ZXJucyA9IFtcbiAgICAgIC9kYXRhYmFzZS4qY29ubmVjdGlvbi9pLFxuICAgICAgL3BheW1lbnQuKmZhaWxlZC9pLFxuICAgICAgL2F1dGhlbnRpY2F0aW9uLipmYWlsZWQvaSxcbiAgICAgIC9zZWN1cml0eS4qdmlvbGF0aW9uL2ksXG4gICAgICAvc2VydmVyLiplcnJvci9pXG4gICAgXVxuXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZSB8fCBlcnJvci50b1N0cmluZygpXG4gICAgcmV0dXJuIGNyaXRpY2FsUGF0dGVybnMuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdChlcnJvck1lc3NhZ2UpKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGVydCBzZXZlcml0eSBsZXZlbFxuICAgKi9cbiAgZ2V0QWxlcnRTZXZlcml0eSh0eXBlKSB7XG4gICAgY29uc3Qgc2V2ZXJpdHlNYXAgPSB7XG4gICAgICBjcml0aWNhbF9lcnJvcjogJ2NyaXRpY2FsJyxcbiAgICAgIGhpZ2hfZXJyb3JfcmF0ZTogJ2hpZ2gnLFxuICAgICAgaGlnaF9sYXRlbmN5OiAnbWVkaXVtJyxcbiAgICAgIHNsb3dfcXVlcnk6ICdtZWRpdW0nLFxuICAgICAgc2VjdXJpdHlfdmlvbGF0aW9uOiAnY3JpdGljYWwnLFxuICAgICAgcGF5bWVudF9mYWlsdXJlOiAnY3JpdGljYWwnXG4gICAgfVxuXG4gICAgcmV0dXJuIHNldmVyaXR5TWFwW3R5cGVdIHx8ICdsb3cnXG4gIH1cblxuICAvKipcbiAgICogR2V0IHNlc3Npb24gaWRlbnRpZmllclxuICAgKi9cbiAgZ2V0U2Vzc2lvbklkKCkge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UpIHtcbiAgICAgIGxldCBzZXNzaW9uSWQgPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbW9uaXRvcmluZ19zZXNzaW9uX2lkJylcbiAgICAgIGlmICghc2Vzc2lvbklkKSB7XG4gICAgICAgIHNlc3Npb25JZCA9IGBzZXNzaW9uXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YFxuICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnbW9uaXRvcmluZ19zZXNzaW9uX2lkJywgc2Vzc2lvbklkKVxuICAgICAgfVxuICAgICAgcmV0dXJuIHNlc3Npb25JZFxuICAgIH1cbiAgICByZXR1cm4gYHNlcnZlcl8ke0RhdGUubm93KCl9YFxuICB9XG5cbiAgLyoqXG4gICAqIFNlbmQgZGF0YSB0byBleHRlcm5hbCBtb25pdG9yaW5nIHNlcnZpY2VcbiAgICovXG4gIGFzeW5jIHNlbmRUb01vbml0b3JpbmdTZXJ2aWNlKHR5cGUsIGRhdGEpIHtcbiAgICB0cnkge1xuICAgICAgLy8gRXhhbXBsZSBpbnRlZ3JhdGlvbiB3aXRoIG1vbml0b3Jpbmcgc2VydmljZVxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk1PTklUT1JJTkdfRU5EUE9JTlQpIHtcbiAgICAgICAgYXdhaXQgZmV0Y2gocHJvY2Vzcy5lbnYuTU9OSVRPUklOR19FTkRQT0lOVCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwcm9jZXNzLmVudi5NT05JVE9SSU5HX0FQSV9LRVl9YFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB0eXBlLCBkYXRhLCBzb3VyY2U6ICd0cmlhbmdsZS1pbnRlbGxpZ2VuY2UnIH0pXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHNlbmQgbW9uaXRvcmluZyBkYXRhJywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSwgdHlwZSwgZGF0YSB9KVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kIGVycm9yIHRvIHRyYWNraW5nIHNlcnZpY2VcbiAgICovXG4gIGFzeW5jIHNlbmRUb0Vycm9yVHJhY2tpbmcoZXJyb3JEYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEV4YW1wbGUgU2VudHJ5IGludGVncmF0aW9uXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuU0VOVFJZX0RTTikge1xuICAgICAgICAvLyBTZW50cnkuY2FwdHVyZUV4Y2VwdGlvbiB3b3VsZCBnbyBoZXJlXG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnV291bGQgc2VuZCB0byBTZW50cnknLCB7IGVycm9yOiBlcnJvckRhdGEgfSlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gc2VuZCBlcnJvciB0cmFja2luZyBkYXRhJywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSwgZXJyb3JEYXRhIH0pXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNlbmQgYnVzaW5lc3MgZXZlbnQgdG8gYW5hbHl0aWNzXG4gICAqL1xuICBhc3luYyBzZW5kVG9BbmFseXRpY3MoZXZlbnQpIHtcbiAgICB0cnkge1xuICAgICAgLy8gRXhhbXBsZSBhbmFseXRpY3MgaW50ZWdyYXRpb25cbiAgICAgIGlmIChwcm9jZXNzLmVudi5BTkFMWVRJQ1NfRU5EUE9JTlQpIHtcbiAgICAgICAgYXdhaXQgZmV0Y2gocHJvY2Vzcy5lbnYuQU5BTFlUSUNTX0VORFBPSU5ULCB7XG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Byb2Nlc3MuZW52LkFOQUxZVElDU19BUElfS0VZfWBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGV2ZW50KVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBzZW5kIGFuYWx5dGljcyBkYXRhJywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSwgZXZlbnQgfSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBhbGVydCBub3RpZmljYXRpb25cbiAgICovXG4gIGFzeW5jIHNlbmRBbGVydChhbGVydCkge1xuICAgIHRyeSB7XG4gICAgICAvLyBFeGFtcGxlIGFsZXJ0IG5vdGlmaWNhdGlvbiAoU2xhY2ssIFBhZ2VyRHV0eSwgZXRjLilcbiAgICAgIGlmIChwcm9jZXNzLmVudi5BTEVSVF9XRUJIT09LX1VSTCkge1xuICAgICAgICBhd2FpdCBmZXRjaChwcm9jZXNzLmVudi5BTEVSVF9XRUJIT09LX1VSTCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHRleHQ6IGDwn5qoIFRyaWFuZ2xlIEludGVsbGlnZW5jZSBBbGVydDogJHthbGVydC5tZXNzYWdlfWAsXG4gICAgICAgICAgICBzZXZlcml0eTogYWxlcnQuc2V2ZXJpdHksXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKGFsZXJ0LnRpbWVzdGFtcCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIGRhdGE6IGFsZXJ0LmRhdGFcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBzZW5kIGFsZXJ0JywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSwgYWxlcnQgfSlcbiAgICB9XG4gIH1cbn1cblxuLy8gQ3JlYXRlIHNpbmdsZXRvbiBtb25pdG9yaW5nIGluc3RhbmNlXG5leHBvcnQgY29uc3QgbW9uaXRvcmluZyA9IG5ldyBNb25pdG9yaW5nU3lzdGVtKClcblxuLy8gQ29udmVuaWVuY2UgZnVuY3Rpb25zXG5leHBvcnQgY29uc3QgdHJhY2tNZXRyaWMgPSAobmFtZSwgdmFsdWUsIG1ldGFkYXRhKSA9PiBtb25pdG9yaW5nLnRyYWNrTWV0cmljKG5hbWUsIHZhbHVlLCBtZXRhZGF0YSlcbmV4cG9ydCBjb25zdCB0cmFja0Vycm9yID0gKHR5cGUsIGVycm9yLCBjb250ZXh0KSA9PiBtb25pdG9yaW5nLnRyYWNrRXJyb3IodHlwZSwgZXJyb3IsIGNvbnRleHQpXG5leHBvcnQgY29uc3QgdHJhY2tBUElDYWxsID0gKG1ldGhvZCwgZW5kcG9pbnQsIGR1cmF0aW9uLCBzdGF0dXNDb2RlLCBlcnJvcikgPT4gXG4gIG1vbml0b3JpbmcudHJhY2tBUElDYWxsKG1ldGhvZCwgZW5kcG9pbnQsIGR1cmF0aW9uLCBzdGF0dXNDb2RlLCBlcnJvcilcbmV4cG9ydCBjb25zdCB0cmFja0RhdGFiYXNlT3BlcmF0aW9uID0gKHRhYmxlLCBvcGVyYXRpb24sIGR1cmF0aW9uLCByZWNvcmRDb3VudCwgZXJyb3IpID0+XG4gIG1vbml0b3JpbmcudHJhY2tEYXRhYmFzZU9wZXJhdGlvbih0YWJsZSwgb3BlcmF0aW9uLCBkdXJhdGlvbiwgcmVjb3JkQ291bnQsIGVycm9yKVxuZXhwb3J0IGNvbnN0IHRyYWNrQnVzaW5lc3NFdmVudCA9IChldmVudCwgZGF0YSkgPT4gbW9uaXRvcmluZy50cmFja0J1c2luZXNzRXZlbnQoZXZlbnQsIGRhdGEpXG5leHBvcnQgY29uc3QgY3JlYXRlQWxlcnQgPSAodHlwZSwgbWVzc2FnZSwgZGF0YSkgPT4gbW9uaXRvcmluZy5jcmVhdGVBbGVydCh0eXBlLCBtZXNzYWdlLCBkYXRhKVxuZXhwb3J0IGNvbnN0IGdldEhlYWx0aE1ldHJpY3MgPSAoKSA9PiBtb25pdG9yaW5nLmdldEhlYWx0aE1ldHJpY3MoKVxuXG5leHBvcnQgZGVmYXVsdCBtb25pdG9yaW5nIl0sIm5hbWVzIjpbImxvZ2dlciIsImlzUHJvZHVjdGlvbiIsImlzRGV2ZWxvcG1lbnQiLCJNb25pdG9yaW5nU3lzdGVtIiwiY29uc3RydWN0b3IiLCJtZXRyaWNzIiwiTWFwIiwiYWxlcnRzIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImVycm9yQ291bnQiLCJyZXF1ZXN0Q291bnQiLCJpbml0aWFsaXplUGVyZm9ybWFuY2VUcmFja2luZyIsIndpbmRvdyIsInBlcmZvcm1hbmNlIiwidHJhY2tXZWJWaXRhbHMiLCJwcm9jZXNzIiwib24iLCJlcnJvciIsInRyYWNrRXJyb3IiLCJleGl0IiwicmVhc29uIiwicHJvbWlzZSIsIm9ic2VydmVQZXJmb3JtYW5jZSIsImVudHJ5IiwidHJhY2tNZXRyaWMiLCJ2YWx1ZSIsInVybCIsImxvY2F0aW9uIiwicGF0aG5hbWUiLCJ0aW1lc3RhbXAiLCJwcm9jZXNzaW5nU3RhcnQiLCJoYWRSZWNlbnRJbnB1dCIsImVudHJ5VHlwZSIsImNhbGxiYWNrIiwib2JzZXJ2ZXIiLCJQZXJmb3JtYW5jZU9ic2VydmVyIiwibGlzdCIsImdldEVudHJpZXMiLCJmb3JFYWNoIiwib2JzZXJ2ZSIsImVudHJ5VHlwZXMiLCJuYW1lIiwibWV0YWRhdGEiLCJtZXRyaWMiLCJzZXQiLCJpbmZvIiwic2VuZFRvTW9uaXRvcmluZ1NlcnZpY2UiLCJ0eXBlIiwiY29udGV4dCIsImVycm9yRGF0YSIsIm1lc3NhZ2UiLCJzdGFjayIsInVzZXJBZ2VudCIsIm5hdmlnYXRvciIsImhyZWYiLCJzZW5kVG9FcnJvclRyYWNraW5nIiwiaXNDcml0aWNhbEVycm9yIiwiY3JlYXRlQWxlcnQiLCJ0cmFja0FQSUNhbGwiLCJtZXRob2QiLCJlbmRwb2ludCIsImR1cmF0aW9uIiwic3RhdHVzQ29kZSIsImFwaU1ldHJpYyIsInN1Y2Nlc3MiLCJjaGVja0Vycm9yUmF0ZSIsInRyYWNrRGF0YWJhc2VPcGVyYXRpb24iLCJ0YWJsZSIsIm9wZXJhdGlvbiIsInJlY29yZENvdW50IiwiZGJNZXRyaWMiLCJ0cmFja0J1c2luZXNzRXZlbnQiLCJldmVudCIsImRhdGEiLCJidXNpbmVzc0V2ZW50Iiwic2Vzc2lvbiIsImdldFNlc3Npb25JZCIsImJ1c2luZXNzIiwic2VuZFRvQW5hbHl0aWNzIiwiYWxlcnQiLCJzZXZlcml0eSIsImdldEFsZXJ0U2V2ZXJpdHkiLCJhY2tub3dsZWRnZWQiLCJ3YXJuIiwic2VuZEFsZXJ0IiwiZ2V0SGVhbHRoTWV0cmljcyIsInVwdGltZSIsIm1lbW9yeVVzYWdlIiwiTWF0aCIsImZsb29yIiwicmVxdWVzdHMiLCJ0b3RhbCIsImVycm9ycyIsImVycm9yUmF0ZSIsIm1lbW9yeSIsImhlYXBVc2VkIiwicm91bmQiLCJoZWFwVG90YWwiLCJleHRlcm5hbCIsImFjdGl2ZUFsZXJ0cyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImZpbHRlciIsImxlbmd0aCIsIm1ldHJpY3NDb2xsZWN0ZWQiLCJzaXplIiwidG9GaXhlZCIsInRvdGFsUmVxdWVzdHMiLCJ0b3RhbEVycm9ycyIsImNyaXRpY2FsUGF0dGVybnMiLCJlcnJvck1lc3NhZ2UiLCJ0b1N0cmluZyIsInNvbWUiLCJwYXR0ZXJuIiwidGVzdCIsInNldmVyaXR5TWFwIiwiY3JpdGljYWxfZXJyb3IiLCJoaWdoX2Vycm9yX3JhdGUiLCJoaWdoX2xhdGVuY3kiLCJzbG93X3F1ZXJ5Iiwic2VjdXJpdHlfdmlvbGF0aW9uIiwicGF5bWVudF9mYWlsdXJlIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXNzaW9uSWQiLCJnZXRJdGVtIiwicmFuZG9tIiwic3Vic3RyIiwic2V0SXRlbSIsImVudiIsIk1PTklUT1JJTkdfRU5EUE9JTlQiLCJmZXRjaCIsImhlYWRlcnMiLCJNT05JVE9SSU5HX0FQSV9LRVkiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInNvdXJjZSIsIlNFTlRSWV9EU04iLCJkZWJ1ZyIsIkFOQUxZVElDU19FTkRQT0lOVCIsIkFOQUxZVElDU19BUElfS0VZIiwiQUxFUlRfV0VCSE9PS19VUkwiLCJ0ZXh0IiwidG9JU09TdHJpbmciLCJtb25pdG9yaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/monitoring.js\n");

/***/ }),

/***/ "(api)/./lib/production-logger.js":
/*!**********************************!*\
  !*** ./lib/production-logger.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   logAPICall: () => (/* binding */ logAPICall),\n/* harmony export */   logBusiness: () => (/* binding */ logBusiness),\n/* harmony export */   logDBQuery: () => (/* binding */ logDBQuery),\n/* harmony export */   logDebug: () => (/* binding */ logDebug),\n/* harmony export */   logError: () => (/* binding */ logError),\n/* harmony export */   logInfo: () => (/* binding */ logInfo),\n/* harmony export */   logPerformance: () => (/* binding */ logPerformance),\n/* harmony export */   logSecurity: () => (/* binding */ logSecurity),\n/* harmony export */   logWarn: () => (/* binding */ logWarn),\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\n/* harmony import */ var _environment_validation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./environment-validation.js */ \"(api)/./lib/environment-validation.js\");\n/**\n * Production-Safe Logging System\n * Handles logging with environment awareness and security\n */ \n// Log levels\nconst LOG_LEVELS = {\n    ERROR: 0,\n    WARN: 1,\n    INFO: 2,\n    DEBUG: 3,\n    TRACE: 4\n};\nclass ProductionLogger {\n    constructor(){\n        this.level = (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? LOG_LEVELS.WARN : LOG_LEVELS.DEBUG;\n        this.sensitivePatterns = [\n            /sk-[a-zA-Z0-9_-]+/,\n            /pk_[a-zA-Z0-9_-]+/,\n            /eyJ[a-zA-Z0-9_-]+/,\n            /password/i,\n            /secret/i,\n            /token/i,\n            /key.*=.*[a-zA-Z0-9_-]{20,}/ // Key-value pairs with long values\n        ];\n        // Asynchronous logging queue for performance\n        this.logQueue = [];\n        this.maxQueueSize = 1000;\n        this.flushInterval = 5000 // 5 seconds\n        ;\n        this.isFlushingLogs = false;\n        // Start periodic log flushing in production\n        if ((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)()) {\n            setInterval(()=>{\n                this.flushLogsAsync();\n            }, this.flushInterval);\n        }\n    }\n    /**\n   * Sanitize sensitive data from logs\n   */ sanitize(data) {\n        if (typeof data === \"string\") {\n            let sanitized = data;\n            this.sensitivePatterns.forEach((pattern)=>{\n                sanitized = sanitized.replace(pattern, \"[REDACTED]\");\n            });\n            return sanitized;\n        }\n        if (typeof data === \"object\" && data !== null) {\n            const sanitized = Array.isArray(data) ? [] : {};\n            for (const [key, value] of Object.entries(data)){\n                const keyLower = key.toLowerCase();\n                if (keyLower.includes(\"password\") || keyLower.includes(\"secret\") || keyLower.includes(\"token\") || keyLower.includes(\"key\")) {\n                    sanitized[key] = \"[REDACTED]\";\n                } else {\n                    sanitized[key] = this.sanitize(value);\n                }\n            }\n            return sanitized;\n        }\n        return data;\n    }\n    /**\n   * Format log message\n   */ formatMessage(level, message, data, metadata) {\n        const timestamp = new Date().toISOString();\n        const sanitizedData = data ? this.sanitize(data) : null;\n        const logEntry = {\n            timestamp,\n            level,\n            message,\n            ...sanitizedData && {\n                data: sanitizedData\n            },\n            ...metadata && {\n                metadata\n            }\n        };\n        return (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? JSON.stringify(logEntry) : logEntry;\n    }\n    /**\n   * Log error messages (always synchronous for errors)\n   */ error(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.ERROR) {\n            const formatted = this.formatMessage(\"ERROR\", message, data, metadata);\n            console.error((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? formatted : \"❌\", (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : message, (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : this.sanitize(data));\n        }\n    }\n    /**\n   * Log warning messages (asynchronous in production)\n   */ warn(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.WARN) {\n            const logEntry = {\n                level: \"WARN\",\n                message,\n                data: this.sanitize(data),\n                metadata,\n                timestamp: new Date().toISOString()\n            };\n            if ((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)()) {\n                this.queueLog(logEntry);\n            } else {\n                console.warn(\"⚠️\", message, this.sanitize(data));\n            }\n        }\n    }\n    /**\n   * Log info messages (asynchronous in production)\n   */ info(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.INFO) {\n            const logEntry = {\n                level: \"INFO\",\n                message,\n                data: this.sanitize(data),\n                metadata,\n                timestamp: new Date().toISOString()\n            };\n            if ((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)()) {\n                this.queueLog(logEntry);\n            } else {\n                console.log(\"ℹ️\", message, this.sanitize(data));\n            }\n        }\n    }\n    /**\n   * Log debug messages (only in development, always synchronous)\n   */ debug(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.DEBUG && (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isDevelopment)()) {\n            console.log(\"\\uD83D\\uDC1B\", message, this.sanitize(data));\n        }\n    }\n    /**\n   * Log trace messages (only in development)\n   */ trace(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.TRACE && (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isDevelopment)()) {\n            const formatted = this.formatMessage(\"TRACE\", message, data, metadata);\n            console.log((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? formatted : \"\\uD83D\\uDD0D\", (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : message, (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : this.sanitize(data));\n        }\n    }\n    /**\n   * Log performance metrics\n   */ performance(operation, duration, metadata = null) {\n        this.info(`Performance: ${operation}`, {\n            duration: `${duration}ms`\n        }, metadata);\n    }\n    /**\n   * Log API calls\n   */ apiCall(method, endpoint, duration, status) {\n        this.info(`API: ${method} ${endpoint}`, {\n            duration: `${duration}ms`,\n            status,\n            type: \"api_call\"\n        });\n    }\n    /**\n   * Log database queries\n   */ dbQuery(table, operation, duration, recordCount = null) {\n        this.debug(`DB: ${operation} on ${table}`, {\n            duration: `${duration}ms`,\n            recordCount,\n            type: \"db_query\"\n        });\n    }\n    /**\n   * Log security events\n   */ security(event, details = null) {\n        this.warn(`Security: ${event}`, details, {\n            type: \"security_event\"\n        });\n    }\n    /**\n   * Log business events\n   */ business(event, details = null) {\n        this.info(`Business: ${event}`, details, {\n            type: \"business_event\"\n        });\n    }\n}\n// Create singleton instance\nconst logger = new ProductionLogger();\n// Convenience functions for common use cases\nconst logError = (message, data, metadata)=>logger.error(message, data, metadata);\nconst logWarn = (message, data, metadata)=>logger.warn(message, data, metadata);\nconst logInfo = (message, data, metadata)=>logger.info(message, data, metadata);\nconst logDebug = (message, data, metadata)=>logger.debug(message, data, metadata);\nconst logPerformance = (operation, duration, metadata)=>logger.performance(operation, duration, metadata);\nconst logAPICall = (method, endpoint, duration, status)=>logger.apiCall(method, endpoint, duration, status);\nconst logDBQuery = (table, operation, duration, recordCount)=>logger.dbQuery(table, operation, duration, recordCount);\nconst logSecurity = (event, details)=>logger.security(event, details);\nconst logBusiness = (event, details)=>logger.business(event, details);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (logger);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBTyxDQUFDQyxRQUFRQyxVQUFVSCxVQUFVSSxRQUFPO0FBQzdHLE1BQU1nQixhQUFhLENBQUNiLE9BQU9SLFdBQVdDLFVBQVVRLGNBQWdCSyxPQUFPUCxPQUFPLENBQUNDLE9BQU9SLFdBQVdDLFVBQVVRLGFBQVk7QUFDdkgsTUFBTWEsY0FBYyxDQUFDWCxPQUFPQyxVQUFZRSxPQUFPSixRQUFRLENBQUNDLE9BQU9DLFNBQVE7QUFDdkUsTUFBTVcsY0FBYyxDQUFDWixPQUFPQyxVQUFZRSxPQUFPRCxRQUFRLENBQUNGLE9BQU9DLFNBQVE7QUFFOUUsaUVBQWVFLE1BQU1BLEVBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmlhbmdsZS1pbnRlbGxpZ2VuY2UtcGxhdGZvcm0vLi9saWIvcHJvZHVjdGlvbi1sb2dnZXIuanM/ZTgzYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFByb2R1Y3Rpb24tU2FmZSBMb2dnaW5nIFN5c3RlbVxuICogSGFuZGxlcyBsb2dnaW5nIHdpdGggZW52aXJvbm1lbnQgYXdhcmVuZXNzIGFuZCBzZWN1cml0eVxuICovXG5cbmltcG9ydCB7IGlzRGV2ZWxvcG1lbnQsIGlzUHJvZHVjdGlvbiB9IGZyb20gJy4vZW52aXJvbm1lbnQtdmFsaWRhdGlvbi5qcydcblxuLy8gTG9nIGxldmVsc1xuY29uc3QgTE9HX0xFVkVMUyA9IHtcbiAgRVJST1I6IDAsXG4gIFdBUk46IDEsXG4gIElORk86IDIsXG4gIERFQlVHOiAzLFxuICBUUkFDRTogNFxufVxuXG5jbGFzcyBQcm9kdWN0aW9uTG9nZ2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5sZXZlbCA9IGlzUHJvZHVjdGlvbigpID8gTE9HX0xFVkVMUy5XQVJOIDogTE9HX0xFVkVMUy5ERUJVR1xuICAgIHRoaXMuc2Vuc2l0aXZlUGF0dGVybnMgPSBbXG4gICAgICAvc2stW2EtekEtWjAtOV8tXSsvLCAvLyBBUEkga2V5cyBzdGFydGluZyB3aXRoIHNrLVxuICAgICAgL3BrX1thLXpBLVowLTlfLV0rLywgLy8gU3RyaXBlIHB1YmxpYyBrZXlzXG4gICAgICAvZXlKW2EtekEtWjAtOV8tXSsvLCAvLyBKV1QgdG9rZW5zXG4gICAgICAvcGFzc3dvcmQvaSxcbiAgICAgIC9zZWNyZXQvaSxcbiAgICAgIC90b2tlbi9pLFxuICAgICAgL2tleS4qPS4qW2EtekEtWjAtOV8tXXsyMCx9LyAvLyBLZXktdmFsdWUgcGFpcnMgd2l0aCBsb25nIHZhbHVlc1xuICAgIF1cbiAgICBcbiAgICAvLyBBc3luY2hyb25vdXMgbG9nZ2luZyBxdWV1ZSBmb3IgcGVyZm9ybWFuY2VcbiAgICB0aGlzLmxvZ1F1ZXVlID0gW11cbiAgICB0aGlzLm1heFF1ZXVlU2l6ZSA9IDEwMDBcbiAgICB0aGlzLmZsdXNoSW50ZXJ2YWwgPSA1MDAwIC8vIDUgc2Vjb25kc1xuICAgIHRoaXMuaXNGbHVzaGluZ0xvZ3MgPSBmYWxzZVxuICAgIFxuICAgIC8vIFN0YXJ0IHBlcmlvZGljIGxvZyBmbHVzaGluZyBpbiBwcm9kdWN0aW9uXG4gICAgaWYgKGlzUHJvZHVjdGlvbigpKSB7XG4gICAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIHRoaXMuZmx1c2hMb2dzQXN5bmMoKVxuICAgICAgfSwgdGhpcy5mbHVzaEludGVydmFsKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTYW5pdGl6ZSBzZW5zaXRpdmUgZGF0YSBmcm9tIGxvZ3NcbiAgICovXG4gIHNhbml0aXplKGRhdGEpIHtcbiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XG4gICAgICBsZXQgc2FuaXRpemVkID0gZGF0YVxuICAgICAgdGhpcy5zZW5zaXRpdmVQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgICBzYW5pdGl6ZWQgPSBzYW5pdGl6ZWQucmVwbGFjZShwYXR0ZXJuLCAnW1JFREFDVEVEXScpXG4gICAgICB9KVxuICAgICAgcmV0dXJuIHNhbml0aXplZFxuICAgIH1cblxuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YSAhPT0gbnVsbCkge1xuICAgICAgY29uc3Qgc2FuaXRpemVkID0gQXJyYXkuaXNBcnJheShkYXRhKSA/IFtdIDoge31cbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0YSkpIHtcbiAgICAgICAgY29uc3Qga2V5TG93ZXIgPSBrZXkudG9Mb3dlckNhc2UoKVxuICAgICAgICBcbiAgICAgICAgaWYgKGtleUxvd2VyLmluY2x1ZGVzKCdwYXNzd29yZCcpIHx8IFxuICAgICAgICAgICAga2V5TG93ZXIuaW5jbHVkZXMoJ3NlY3JldCcpIHx8IFxuICAgICAgICAgICAga2V5TG93ZXIuaW5jbHVkZXMoJ3Rva2VuJykgfHxcbiAgICAgICAgICAgIGtleUxvd2VyLmluY2x1ZGVzKCdrZXknKSkge1xuICAgICAgICAgIHNhbml0aXplZFtrZXldID0gJ1tSRURBQ1RFRF0nXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2FuaXRpemVkW2tleV0gPSB0aGlzLnNhbml0aXplKHZhbHVlKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBzYW5pdGl6ZWRcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgLyoqXG4gICAqIEZvcm1hdCBsb2cgbWVzc2FnZVxuICAgKi9cbiAgZm9ybWF0TWVzc2FnZShsZXZlbCwgbWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpIHtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICBjb25zdCBzYW5pdGl6ZWREYXRhID0gZGF0YSA/IHRoaXMuc2FuaXRpemUoZGF0YSkgOiBudWxsXG4gICAgXG4gICAgY29uc3QgbG9nRW50cnkgPSB7XG4gICAgICB0aW1lc3RhbXAsXG4gICAgICBsZXZlbCxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICAuLi4oc2FuaXRpemVkRGF0YSAmJiB7IGRhdGE6IHNhbml0aXplZERhdGEgfSksXG4gICAgICAuLi4obWV0YWRhdGEgJiYgeyBtZXRhZGF0YSB9KVxuICAgIH1cblxuICAgIHJldHVybiBpc1Byb2R1Y3Rpb24oKSA/IEpTT04uc3RyaW5naWZ5KGxvZ0VudHJ5KSA6IGxvZ0VudHJ5XG4gIH1cblxuICAvKipcbiAgICogTG9nIGVycm9yIG1lc3NhZ2VzIChhbHdheXMgc3luY2hyb25vdXMgZm9yIGVycm9ycylcbiAgICovXG4gIGVycm9yKG1lc3NhZ2UsIGRhdGEgPSBudWxsLCBtZXRhZGF0YSA9IG51bGwpIHtcbiAgICBpZiAodGhpcy5sZXZlbCA+PSBMT0dfTEVWRUxTLkVSUk9SKSB7XG4gICAgICBjb25zdCBmb3JtYXR0ZWQgPSB0aGlzLmZvcm1hdE1lc3NhZ2UoJ0VSUk9SJywgbWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpXG4gICAgICBjb25zb2xlLmVycm9yKGlzUHJvZHVjdGlvbigpID8gZm9ybWF0dGVkIDogJ+KdjCcsIGlzUHJvZHVjdGlvbigpID8gJycgOiBtZXNzYWdlLCBpc1Byb2R1Y3Rpb24oKSA/ICcnIDogdGhpcy5zYW5pdGl6ZShkYXRhKSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTG9nIHdhcm5pbmcgbWVzc2FnZXMgKGFzeW5jaHJvbm91cyBpbiBwcm9kdWN0aW9uKVxuICAgKi9cbiAgd2FybihtZXNzYWdlLCBkYXRhID0gbnVsbCwgbWV0YWRhdGEgPSBudWxsKSB7XG4gICAgaWYgKHRoaXMubGV2ZWwgPj0gTE9HX0xFVkVMUy5XQVJOKSB7XG4gICAgICBjb25zdCBsb2dFbnRyeSA9IHtcbiAgICAgICAgbGV2ZWw6ICdXQVJOJyxcbiAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgZGF0YTogdGhpcy5zYW5pdGl6ZShkYXRhKSxcbiAgICAgICAgbWV0YWRhdGEsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChpc1Byb2R1Y3Rpb24oKSkge1xuICAgICAgICB0aGlzLnF1ZXVlTG9nKGxvZ0VudHJ5KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8nLCBtZXNzYWdlLCB0aGlzLnNhbml0aXplKGRhdGEpKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgaW5mbyBtZXNzYWdlcyAoYXN5bmNocm9ub3VzIGluIHByb2R1Y3Rpb24pXG4gICAqL1xuICBpbmZvKG1lc3NhZ2UsIGRhdGEgPSBudWxsLCBtZXRhZGF0YSA9IG51bGwpIHtcbiAgICBpZiAodGhpcy5sZXZlbCA+PSBMT0dfTEVWRUxTLklORk8pIHtcbiAgICAgIGNvbnN0IGxvZ0VudHJ5ID0ge1xuICAgICAgICBsZXZlbDogJ0lORk8nLFxuICAgICAgICBtZXNzYWdlLFxuICAgICAgICBkYXRhOiB0aGlzLnNhbml0aXplKGRhdGEpLFxuICAgICAgICBtZXRhZGF0YSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGlzUHJvZHVjdGlvbigpKSB7XG4gICAgICAgIHRoaXMucXVldWVMb2cobG9nRW50cnkpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygn4oS577iPJywgbWVzc2FnZSwgdGhpcy5zYW5pdGl6ZShkYXRhKSlcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTG9nIGRlYnVnIG1lc3NhZ2VzIChvbmx5IGluIGRldmVsb3BtZW50LCBhbHdheXMgc3luY2hyb25vdXMpXG4gICAqL1xuICBkZWJ1ZyhtZXNzYWdlLCBkYXRhID0gbnVsbCwgbWV0YWRhdGEgPSBudWxsKSB7XG4gICAgaWYgKHRoaXMubGV2ZWwgPj0gTE9HX0xFVkVMUy5ERUJVRyAmJiBpc0RldmVsb3BtZW50KCkpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5CbJywgbWVzc2FnZSwgdGhpcy5zYW5pdGl6ZShkYXRhKSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTG9nIHRyYWNlIG1lc3NhZ2VzIChvbmx5IGluIGRldmVsb3BtZW50KVxuICAgKi9cbiAgdHJhY2UobWVzc2FnZSwgZGF0YSA9IG51bGwsIG1ldGFkYXRhID0gbnVsbCkge1xuICAgIGlmICh0aGlzLmxldmVsID49IExPR19MRVZFTFMuVFJBQ0UgJiYgaXNEZXZlbG9wbWVudCgpKSB7XG4gICAgICBjb25zdCBmb3JtYXR0ZWQgPSB0aGlzLmZvcm1hdE1lc3NhZ2UoJ1RSQUNFJywgbWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpXG4gICAgICBjb25zb2xlLmxvZyhpc1Byb2R1Y3Rpb24oKSA/IGZvcm1hdHRlZCA6ICfwn5SNJywgaXNQcm9kdWN0aW9uKCkgPyAnJyA6IG1lc3NhZ2UsIGlzUHJvZHVjdGlvbigpID8gJycgOiB0aGlzLnNhbml0aXplKGRhdGEpKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgcGVyZm9ybWFuY2UgbWV0cmljc1xuICAgKi9cbiAgcGVyZm9ybWFuY2Uob3BlcmF0aW9uLCBkdXJhdGlvbiwgbWV0YWRhdGEgPSBudWxsKSB7XG4gICAgdGhpcy5pbmZvKGBQZXJmb3JtYW5jZTogJHtvcGVyYXRpb259YCwgeyBkdXJhdGlvbjogYCR7ZHVyYXRpb259bXNgIH0sIG1ldGFkYXRhKVxuICB9XG5cbiAgLyoqXG4gICAqIExvZyBBUEkgY2FsbHNcbiAgICovXG4gIGFwaUNhbGwobWV0aG9kLCBlbmRwb2ludCwgZHVyYXRpb24sIHN0YXR1cykge1xuICAgIHRoaXMuaW5mbyhgQVBJOiAke21ldGhvZH0gJHtlbmRwb2ludH1gLCB7XG4gICAgICBkdXJhdGlvbjogYCR7ZHVyYXRpb259bXNgLFxuICAgICAgc3RhdHVzLFxuICAgICAgdHlwZTogJ2FwaV9jYWxsJ1xuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogTG9nIGRhdGFiYXNlIHF1ZXJpZXNcbiAgICovXG4gIGRiUXVlcnkodGFibGUsIG9wZXJhdGlvbiwgZHVyYXRpb24sIHJlY29yZENvdW50ID0gbnVsbCkge1xuICAgIHRoaXMuZGVidWcoYERCOiAke29wZXJhdGlvbn0gb24gJHt0YWJsZX1gLCB7XG4gICAgICBkdXJhdGlvbjogYCR7ZHVyYXRpb259bXNgLFxuICAgICAgcmVjb3JkQ291bnQsXG4gICAgICB0eXBlOiAnZGJfcXVlcnknXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgc2VjdXJpdHkgZXZlbnRzXG4gICAqL1xuICBzZWN1cml0eShldmVudCwgZGV0YWlscyA9IG51bGwpIHtcbiAgICB0aGlzLndhcm4oYFNlY3VyaXR5OiAke2V2ZW50fWAsIGRldGFpbHMsIHsgdHlwZTogJ3NlY3VyaXR5X2V2ZW50JyB9KVxuICB9XG5cbiAgLyoqXG4gICAqIExvZyBidXNpbmVzcyBldmVudHNcbiAgICovXG4gIGJ1c2luZXNzKGV2ZW50LCBkZXRhaWxzID0gbnVsbCkge1xuICAgIHRoaXMuaW5mbyhgQnVzaW5lc3M6ICR7ZXZlbnR9YCwgZGV0YWlscywgeyB0eXBlOiAnYnVzaW5lc3NfZXZlbnQnIH0pXG4gIH1cbn1cblxuLy8gQ3JlYXRlIHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGxvZ2dlciA9IG5ldyBQcm9kdWN0aW9uTG9nZ2VyKClcblxuLy8gQ29udmVuaWVuY2UgZnVuY3Rpb25zIGZvciBjb21tb24gdXNlIGNhc2VzXG5leHBvcnQgY29uc3QgbG9nRXJyb3IgPSAobWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpID0+IGxvZ2dlci5lcnJvcihtZXNzYWdlLCBkYXRhLCBtZXRhZGF0YSlcbmV4cG9ydCBjb25zdCBsb2dXYXJuID0gKG1lc3NhZ2UsIGRhdGEsIG1ldGFkYXRhKSA9PiBsb2dnZXIud2FybihtZXNzYWdlLCBkYXRhLCBtZXRhZGF0YSlcbmV4cG9ydCBjb25zdCBsb2dJbmZvID0gKG1lc3NhZ2UsIGRhdGEsIG1ldGFkYXRhKSA9PiBsb2dnZXIuaW5mbyhtZXNzYWdlLCBkYXRhLCBtZXRhZGF0YSlcbmV4cG9ydCBjb25zdCBsb2dEZWJ1ZyA9IChtZXNzYWdlLCBkYXRhLCBtZXRhZGF0YSkgPT4gbG9nZ2VyLmRlYnVnKG1lc3NhZ2UsIGRhdGEsIG1ldGFkYXRhKVxuZXhwb3J0IGNvbnN0IGxvZ1BlcmZvcm1hbmNlID0gKG9wZXJhdGlvbiwgZHVyYXRpb24sIG1ldGFkYXRhKSA9PiBsb2dnZXIucGVyZm9ybWFuY2Uob3BlcmF0aW9uLCBkdXJhdGlvbiwgbWV0YWRhdGEpXG5leHBvcnQgY29uc3QgbG9nQVBJQ2FsbCA9IChtZXRob2QsIGVuZHBvaW50LCBkdXJhdGlvbiwgc3RhdHVzKSA9PiBsb2dnZXIuYXBpQ2FsbChtZXRob2QsIGVuZHBvaW50LCBkdXJhdGlvbiwgc3RhdHVzKVxuZXhwb3J0IGNvbnN0IGxvZ0RCUXVlcnkgPSAodGFibGUsIG9wZXJhdGlvbiwgZHVyYXRpb24sIHJlY29yZENvdW50KSA9PiBsb2dnZXIuZGJRdWVyeSh0YWJsZSwgb3BlcmF0aW9uLCBkdXJhdGlvbiwgcmVjb3JkQ291bnQpXG5leHBvcnQgY29uc3QgbG9nU2VjdXJpdHkgPSAoZXZlbnQsIGRldGFpbHMpID0+IGxvZ2dlci5zZWN1cml0eShldmVudCwgZGV0YWlscylcbmV4cG9ydCBjb25zdCBsb2dCdXNpbmVzcyA9IChldmVudCwgZGV0YWlscykgPT4gbG9nZ2VyLmJ1c2luZXNzKGV2ZW50LCBkZXRhaWxzKVxuXG5leHBvcnQgZGVmYXVsdCBsb2dnZXIiXSwibmFtZXMiOlsiaXNEZXZlbG9wbWVudCIsImlzUHJvZHVjdGlvbiIsIkxPR19MRVZFTFMiLCJFUlJPUiIsIldBUk4iLCJJTkZPIiwiREVCVUciLCJUUkFDRSIsIlByb2R1Y3Rpb25Mb2dnZXIiLCJjb25zdHJ1Y3RvciIsImxldmVsIiwic2Vuc2l0aXZlUGF0dGVybnMiLCJsb2dRdWV1ZSIsIm1heFF1ZXVlU2l6ZSIsImZsdXNoSW50ZXJ2YWwiLCJpc0ZsdXNoaW5nTG9ncyIsInNldEludGVydmFsIiwiZmx1c2hMb2dzQXN5bmMiLCJzYW5pdGl6ZSIsImRhdGEiLCJzYW5pdGl6ZWQiLCJmb3JFYWNoIiwicGF0dGVybiIsInJlcGxhY2UiLCJBcnJheSIsImlzQXJyYXkiLCJrZXkiLCJ2YWx1ZSIsIk9iamVjdCIsImVudHJpZXMiLCJrZXlMb3dlciIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJmb3JtYXRNZXNzYWdlIiwibWVzc2FnZSIsIm1ldGFkYXRhIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic2FuaXRpemVkRGF0YSIsImxvZ0VudHJ5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwiZm9ybWF0dGVkIiwiY29uc29sZSIsIndhcm4iLCJxdWV1ZUxvZyIsImluZm8iLCJsb2ciLCJkZWJ1ZyIsInRyYWNlIiwicGVyZm9ybWFuY2UiLCJvcGVyYXRpb24iLCJkdXJhdGlvbiIsImFwaUNhbGwiLCJtZXRob2QiLCJlbmRwb2ludCIsInN0YXR1cyIsInR5cGUiLCJkYlF1ZXJ5IiwidGFibGUiLCJyZWNvcmRDb3VudCIsInNlY3VyaXR5IiwiZXZlbnQiLCJkZXRhaWxzIiwiYnVzaW5lc3MiLCJsb2dnZXIiLCJsb2dFcnJvciIsImxvZ1dhcm4iLCJsb2dJbmZvIiwibG9nRGVidWciLCJsb2dQZXJmb3JtYW5jZSIsImxvZ0FQSUNhbGwiLCJsb2dEQlF1ZXJ5IiwibG9nU2VjdXJpdHkiLCJsb2dCdXNpbmVzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/production-logger.js\n");

/***/ }),

/***/ "(api)/./lib/redis-client.js":
/*!*****************************!*\
  !*** ./lib/redis-client.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RedisClient: () => (/* binding */ RedisClient),\n/* harmony export */   checkRedisHealth: () => (/* binding */ checkRedisHealth),\n/* harmony export */   getRedisClient: () => (/* binding */ getRedisClient),\n/* harmony export */   shouldUseFallbackMode: () => (/* binding */ shouldUseFallbackMode),\n/* harmony export */   shutdownRedis: () => (/* binding */ shutdownRedis)\n/* harmony export */ });\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/production-logger.js */ \"(api)/./lib/utils/production-logger.js\");\n/**\n * Redis Client for Triangle Intelligence Platform\n * Handles caching, rate limiting, and session management\n */ \n\nclass RedisClient {\n    constructor(){\n        this.redis = null;\n        this.isConnected = false;\n        this.connectionAttempts = 0;\n        this.maxRetries = 5;\n        this.retryDelayMs = 2000;\n    }\n    /**\n   * Initialize Redis connection with retry logic\n   */ async connect() {\n        if (this.isConnected && this.redis) {\n            return this.redis;\n        }\n        // Check if Redis should be enabled (can be disabled in development)\n        if (process.env.ENABLE_REDIS_RATE_LIMITING === \"false\") {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis rate limiting disabled via environment variable\");\n            throw new Error(\"Redis disabled - using memory fallback\");\n        }\n        let redisConfig;\n        // Use Redis URL if provided (for managed services like Upstash, ElastiCache)\n        if (process.env.REDIS_URL) {\n            redisConfig = {\n                connectionName: \"triangle-intelligence\",\n                retryDelayOnFailover: 100,\n                enableReadyCheck: true,\n                maxRetriesPerRequest: 3,\n                lazyConnect: true,\n                keepAlive: 30000,\n                connectTimeout: 10000,\n                commandTimeout: 5000\n            };\n            this.redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(process.env.REDIS_URL, redisConfig);\n        } else {\n            // Standard host/port configuration\n            redisConfig = {\n                host: process.env.REDIS_HOST || \"localhost\",\n                port: parseInt(process.env.REDIS_PORT || \"6379\"),\n                password: process.env.REDIS_PASSWORD,\n                db: parseInt(process.env.REDIS_DB || \"0\"),\n                connectionName: \"triangle-intelligence\",\n                retryDelayOnFailover: 100,\n                enableReadyCheck: true,\n                maxRetriesPerRequest: 3,\n                lazyConnect: true,\n                keepAlive: 30000,\n                connectTimeout: 10000,\n                commandTimeout: 5000\n            };\n            this.redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(redisConfig);\n        }\n        try {\n            // Event handlers\n            this.redis.on(\"connect\", ()=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis client connected successfully\", {\n                    host: redisConfig.host,\n                    port: redisConfig.port\n                });\n                this.isConnected = true;\n                this.connectionAttempts = 0;\n            });\n            this.redis.on(\"ready\", ()=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis client ready for operations\");\n            });\n            this.redis.on(\"error\", (error)=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Redis connection error\", {\n                    error: error.message,\n                    connectionAttempts: this.connectionAttempts\n                });\n                this.isConnected = false;\n            });\n            this.redis.on(\"close\", ()=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis connection closed\");\n                this.isConnected = false;\n            });\n            this.redis.on(\"reconnecting\", (ms)=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis reconnecting\", {\n                    retryIn: ms\n                });\n            });\n            // Test connection\n            await this.redis.connect();\n            await this.redis.ping();\n            return this.redis;\n        } catch (error) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Failed to initialize Redis client\", {\n                error: error.message\n            });\n            this.connectionAttempts++;\n            if (this.connectionAttempts < this.maxRetries) {\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(`Retrying Redis connection in ${this.retryDelayMs}ms`, {\n                    attempt: this.connectionAttempts,\n                    maxRetries: this.maxRetries\n                });\n                await new Promise((resolve)=>setTimeout(resolve, this.retryDelayMs));\n                return this.connect();\n            } else {\n                throw new Error(`Failed to connect to Redis after ${this.maxRetries} attempts: ${error.message}`);\n            }\n        }\n    }\n    /**\n   * Get Redis client (with automatic connection)\n   */ async getClient() {\n        if (!this.isConnected || !this.redis) {\n            await this.connect();\n        }\n        return this.redis;\n    }\n    /**\n   * Graceful shutdown\n   */ async disconnect() {\n        if (this.redis) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Disconnecting Redis client\");\n            await this.redis.quit();\n            this.redis = null;\n            this.isConnected = false;\n        }\n    }\n    /**\n   * Health check\n   */ async healthCheck() {\n        try {\n            const client = await this.getClient();\n            const pong = await client.ping();\n            return {\n                status: \"healthy\",\n                response: pong,\n                connected: this.isConnected\n            };\n        } catch (error) {\n            return {\n                status: \"unhealthy\",\n                error: error.message,\n                connected: false\n            };\n        }\n    }\n    /**\n   * Check if fallback mode should be used\n   */ shouldUseFallback() {\n        // Use fallback if Redis is not available or connection failed too many times\n        return !this.isConnected || this.connectionAttempts >= this.maxRetries;\n    }\n}\n// Singleton instance\nconst redisClient = new RedisClient();\n/**\n * Get Redis client instance (singleton)\n */ async function getRedisClient() {\n    try {\n        return await redisClient.getClient();\n    } catch (error) {\n        (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Failed to get Redis client\", {\n            error: error.message\n        });\n        throw error;\n    }\n}\n/**\n * Check Redis health\n */ async function checkRedisHealth() {\n    return await redisClient.healthCheck();\n}\n/**\n * Check if should use memory fallback\n */ function shouldUseFallbackMode() {\n    return redisClient.shouldUseFallback();\n}\n/**\n * Graceful shutdown helper\n */ async function shutdownRedis() {\n    await redisClient.disconnect();\n}\n// Export the class for testing\n\n// Handle process shutdown\nprocess.on(\"SIGTERM\", shutdownRedis);\nprocess.on(\"SIGINT\", shutdownRedis);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRSxDQUFDLFVBQVV3QiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyaWFuZ2xlLWludGVsbGlnZW5jZS1wbGF0Zm9ybS8uL2xpYi9yZWRpcy1jbGllbnQuanM/ZjQwZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJlZGlzIENsaWVudCBmb3IgVHJpYW5nbGUgSW50ZWxsaWdlbmNlIFBsYXRmb3JtXG4gKiBIYW5kbGVzIGNhY2hpbmcsIHJhdGUgbGltaXRpbmcsIGFuZCBzZXNzaW9uIG1hbmFnZW1lbnRcbiAqL1xuXG5pbXBvcnQgUmVkaXMgZnJvbSAnaW9yZWRpcydcbmltcG9ydCB7IGxvZ0luZm8sIGxvZ0Vycm9yLCBsb2dEZWJ1ZyB9IGZyb20gJy4vdXRpbHMvcHJvZHVjdGlvbi1sb2dnZXIuanMnXG5cbmNsYXNzIFJlZGlzQ2xpZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yZWRpcyA9IG51bGxcbiAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2VcbiAgICB0aGlzLmNvbm5lY3Rpb25BdHRlbXB0cyA9IDBcbiAgICB0aGlzLm1heFJldHJpZXMgPSA1XG4gICAgdGhpcy5yZXRyeURlbGF5TXMgPSAyMDAwXG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBSZWRpcyBjb25uZWN0aW9uIHdpdGggcmV0cnkgbG9naWNcbiAgICovXG4gIGFzeW5jIGNvbm5lY3QoKSB7XG4gICAgaWYgKHRoaXMuaXNDb25uZWN0ZWQgJiYgdGhpcy5yZWRpcykge1xuICAgICAgcmV0dXJuIHRoaXMucmVkaXNcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBSZWRpcyBzaG91bGQgYmUgZW5hYmxlZCAoY2FuIGJlIGRpc2FibGVkIGluIGRldmVsb3BtZW50KVxuICAgIGlmIChwcm9jZXNzLmVudi5FTkFCTEVfUkVESVNfUkFURV9MSU1JVElORyA9PT0gJ2ZhbHNlJykge1xuICAgICAgbG9nSW5mbygnUmVkaXMgcmF0ZSBsaW1pdGluZyBkaXNhYmxlZCB2aWEgZW52aXJvbm1lbnQgdmFyaWFibGUnKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWRpcyBkaXNhYmxlZCAtIHVzaW5nIG1lbW9yeSBmYWxsYmFjaycpXG4gICAgfVxuXG4gICAgbGV0IHJlZGlzQ29uZmlnXG5cbiAgICAvLyBVc2UgUmVkaXMgVVJMIGlmIHByb3ZpZGVkIChmb3IgbWFuYWdlZCBzZXJ2aWNlcyBsaWtlIFVwc3Rhc2gsIEVsYXN0aUNhY2hlKVxuICAgIGlmIChwcm9jZXNzLmVudi5SRURJU19VUkwpIHtcbiAgICAgIHJlZGlzQ29uZmlnID0ge1xuICAgICAgICBjb25uZWN0aW9uTmFtZTogJ3RyaWFuZ2xlLWludGVsbGlnZW5jZScsXG4gICAgICAgIHJldHJ5RGVsYXlPbkZhaWxvdmVyOiAxMDAsXG4gICAgICAgIGVuYWJsZVJlYWR5Q2hlY2s6IHRydWUsXG4gICAgICAgIG1heFJldHJpZXNQZXJSZXF1ZXN0OiAzLFxuICAgICAgICBsYXp5Q29ubmVjdDogdHJ1ZSxcbiAgICAgICAga2VlcEFsaXZlOiAzMDAwMCxcbiAgICAgICAgY29ubmVjdFRpbWVvdXQ6IDEwMDAwLFxuICAgICAgICBjb21tYW5kVGltZW91dDogNTAwMFxuICAgICAgfVxuICAgICAgdGhpcy5yZWRpcyA9IG5ldyBSZWRpcyhwcm9jZXNzLmVudi5SRURJU19VUkwsIHJlZGlzQ29uZmlnKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTdGFuZGFyZCBob3N0L3BvcnQgY29uZmlndXJhdGlvblxuICAgICAgcmVkaXNDb25maWcgPSB7XG4gICAgICAgIGhvc3Q6IHByb2Nlc3MuZW52LlJFRElTX0hPU1QgfHwgJ2xvY2FsaG9zdCcsXG4gICAgICAgIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52LlJFRElTX1BPUlQgfHwgJzYzNzknKSxcbiAgICAgICAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LlJFRElTX1BBU1NXT1JELFxuICAgICAgICBkYjogcGFyc2VJbnQocHJvY2Vzcy5lbnYuUkVESVNfREIgfHwgJzAnKSxcbiAgICAgICAgY29ubmVjdGlvbk5hbWU6ICd0cmlhbmdsZS1pbnRlbGxpZ2VuY2UnLFxuICAgICAgICByZXRyeURlbGF5T25GYWlsb3ZlcjogMTAwLFxuICAgICAgICBlbmFibGVSZWFkeUNoZWNrOiB0cnVlLFxuICAgICAgICBtYXhSZXRyaWVzUGVyUmVxdWVzdDogMyxcbiAgICAgICAgbGF6eUNvbm5lY3Q6IHRydWUsXG4gICAgICAgIGtlZXBBbGl2ZTogMzAwMDAsXG4gICAgICAgIGNvbm5lY3RUaW1lb3V0OiAxMDAwMCxcbiAgICAgICAgY29tbWFuZFRpbWVvdXQ6IDUwMDBcbiAgICAgIH1cbiAgICAgIHRoaXMucmVkaXMgPSBuZXcgUmVkaXMocmVkaXNDb25maWcpXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEV2ZW50IGhhbmRsZXJzXG4gICAgICB0aGlzLnJlZGlzLm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICAgICAgICBsb2dJbmZvKCdSZWRpcyBjbGllbnQgY29ubmVjdGVkIHN1Y2Nlc3NmdWxseScsIHsgXG4gICAgICAgICAgaG9zdDogcmVkaXNDb25maWcuaG9zdCwgXG4gICAgICAgICAgcG9ydDogcmVkaXNDb25maWcucG9ydCBcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5pc0Nvbm5lY3RlZCA9IHRydWVcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uQXR0ZW1wdHMgPSAwXG4gICAgICB9KVxuXG4gICAgICB0aGlzLnJlZGlzLm9uKCdyZWFkeScsICgpID0+IHtcbiAgICAgICAgbG9nSW5mbygnUmVkaXMgY2xpZW50IHJlYWR5IGZvciBvcGVyYXRpb25zJylcbiAgICAgIH0pXG5cbiAgICAgIHRoaXMucmVkaXMub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7XG4gICAgICAgIGxvZ0Vycm9yKCdSZWRpcyBjb25uZWN0aW9uIGVycm9yJywgeyBcbiAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBjb25uZWN0aW9uQXR0ZW1wdHM6IHRoaXMuY29ubmVjdGlvbkF0dGVtcHRzIFxuICAgICAgICB9KVxuICAgICAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2VcbiAgICAgIH0pXG5cbiAgICAgIHRoaXMucmVkaXMub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICBsb2dJbmZvKCdSZWRpcyBjb25uZWN0aW9uIGNsb3NlZCcpXG4gICAgICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZVxuICAgICAgfSlcblxuICAgICAgdGhpcy5yZWRpcy5vbigncmVjb25uZWN0aW5nJywgKG1zKSA9PiB7XG4gICAgICAgIGxvZ0luZm8oJ1JlZGlzIHJlY29ubmVjdGluZycsIHsgcmV0cnlJbjogbXMgfSlcbiAgICAgIH0pXG5cbiAgICAgIC8vIFRlc3QgY29ubmVjdGlvblxuICAgICAgYXdhaXQgdGhpcy5yZWRpcy5jb25uZWN0KClcbiAgICAgIGF3YWl0IHRoaXMucmVkaXMucGluZygpXG5cbiAgICAgIHJldHVybiB0aGlzLnJlZGlzXG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nRXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIFJlZGlzIGNsaWVudCcsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSlcbiAgICAgIHRoaXMuY29ubmVjdGlvbkF0dGVtcHRzKytcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuY29ubmVjdGlvbkF0dGVtcHRzIDwgdGhpcy5tYXhSZXRyaWVzKSB7XG4gICAgICAgIGxvZ0luZm8oYFJldHJ5aW5nIFJlZGlzIGNvbm5lY3Rpb24gaW4gJHt0aGlzLnJldHJ5RGVsYXlNc31tc2AsIHtcbiAgICAgICAgICBhdHRlbXB0OiB0aGlzLmNvbm5lY3Rpb25BdHRlbXB0cyxcbiAgICAgICAgICBtYXhSZXRyaWVzOiB0aGlzLm1heFJldHJpZXNcbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCB0aGlzLnJldHJ5RGVsYXlNcykpXG4gICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3QoKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY29ubmVjdCB0byBSZWRpcyBhZnRlciAke3RoaXMubWF4UmV0cmllc30gYXR0ZW1wdHM6ICR7ZXJyb3IubWVzc2FnZX1gKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgUmVkaXMgY2xpZW50ICh3aXRoIGF1dG9tYXRpYyBjb25uZWN0aW9uKVxuICAgKi9cbiAgYXN5bmMgZ2V0Q2xpZW50KCkge1xuICAgIGlmICghdGhpcy5pc0Nvbm5lY3RlZCB8fCAhdGhpcy5yZWRpcykge1xuICAgICAgYXdhaXQgdGhpcy5jb25uZWN0KClcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucmVkaXNcbiAgfVxuXG4gIC8qKlxuICAgKiBHcmFjZWZ1bCBzaHV0ZG93blxuICAgKi9cbiAgYXN5bmMgZGlzY29ubmVjdCgpIHtcbiAgICBpZiAodGhpcy5yZWRpcykge1xuICAgICAgbG9nSW5mbygnRGlzY29ubmVjdGluZyBSZWRpcyBjbGllbnQnKVxuICAgICAgYXdhaXQgdGhpcy5yZWRpcy5xdWl0KClcbiAgICAgIHRoaXMucmVkaXMgPSBudWxsXG4gICAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2VcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGVhbHRoIGNoZWNrXG4gICAqL1xuICBhc3luYyBoZWFsdGhDaGVjaygpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgdGhpcy5nZXRDbGllbnQoKVxuICAgICAgY29uc3QgcG9uZyA9IGF3YWl0IGNsaWVudC5waW5nKClcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1czogJ2hlYWx0aHknLFxuICAgICAgICByZXNwb25zZTogcG9uZyxcbiAgICAgICAgY29ubmVjdGVkOiB0aGlzLmlzQ29ubmVjdGVkXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1czogJ3VuaGVhbHRoeScsXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICBjb25uZWN0ZWQ6IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGZhbGxiYWNrIG1vZGUgc2hvdWxkIGJlIHVzZWRcbiAgICovXG4gIHNob3VsZFVzZUZhbGxiYWNrKCkge1xuICAgIC8vIFVzZSBmYWxsYmFjayBpZiBSZWRpcyBpcyBub3QgYXZhaWxhYmxlIG9yIGNvbm5lY3Rpb24gZmFpbGVkIHRvbyBtYW55IHRpbWVzXG4gICAgcmV0dXJuICF0aGlzLmlzQ29ubmVjdGVkIHx8IHRoaXMuY29ubmVjdGlvbkF0dGVtcHRzID49IHRoaXMubWF4UmV0cmllc1xuICB9XG59XG5cbi8vIFNpbmdsZXRvbiBpbnN0YW5jZVxuY29uc3QgcmVkaXNDbGllbnQgPSBuZXcgUmVkaXNDbGllbnQoKVxuXG4vKipcbiAqIEdldCBSZWRpcyBjbGllbnQgaW5zdGFuY2UgKHNpbmdsZXRvbilcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFJlZGlzQ2xpZW50KCkge1xuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCByZWRpc0NsaWVudC5nZXRDbGllbnQoKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ0Vycm9yKCdGYWlsZWQgdG8gZ2V0IFJlZGlzIGNsaWVudCcsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSlcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgUmVkaXMgaGVhbHRoXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1JlZGlzSGVhbHRoKCkge1xuICByZXR1cm4gYXdhaXQgcmVkaXNDbGllbnQuaGVhbHRoQ2hlY2soKVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHNob3VsZCB1c2UgbWVtb3J5IGZhbGxiYWNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRVc2VGYWxsYmFja01vZGUoKSB7XG4gIHJldHVybiByZWRpc0NsaWVudC5zaG91bGRVc2VGYWxsYmFjaygpXG59XG5cbi8qKlxuICogR3JhY2VmdWwgc2h1dGRvd24gaGVscGVyXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaHV0ZG93blJlZGlzKCkge1xuICBhd2FpdCByZWRpc0NsaWVudC5kaXNjb25uZWN0KClcbn1cblxuLy8gRXhwb3J0IHRoZSBjbGFzcyBmb3IgdGVzdGluZ1xuZXhwb3J0IHsgUmVkaXNDbGllbnQgfVxuXG4vLyBIYW5kbGUgcHJvY2VzcyBzaHV0ZG93blxucHJvY2Vzcy5vbignU0lHVEVSTScsIHNodXRkb3duUmVkaXMpXG5wcm9jZXNzLm9uKCdTSUdJTlQnLCBzaHV0ZG93blJlZGlzKSJdLCJuYW1lcyI6WyJSZWRpcyIsImxvZ0luZm8iLCJsb2dFcnJvciIsImxvZ0RlYnVnIiwiUmVkaXNDbGllbnQiLCJjb25zdHJ1Y3RvciIsInJlZGlzIiwiaXNDb25uZWN0ZWQiLCJjb25uZWN0aW9uQXR0ZW1wdHMiLCJtYXhSZXRyaWVzIiwicmV0cnlEZWxheU1zIiwiY29ubmVjdCIsInByb2Nlc3MiLCJlbnYiLCJFTkFCTEVfUkVESVNfUkFURV9MSU1JVElORyIsIkVycm9yIiwicmVkaXNDb25maWciLCJSRURJU19VUkwiLCJjb25uZWN0aW9uTmFtZSIsInJldHJ5RGVsYXlPbkZhaWxvdmVyIiwiZW5hYmxlUmVhZHlDaGVjayIsIm1heFJldHJpZXNQZXJSZXF1ZXN0IiwibGF6eUNvbm5lY3QiLCJrZWVwQWxpdmUiLCJjb25uZWN0VGltZW91dCIsImNvbW1hbmRUaW1lb3V0IiwiaG9zdCIsIlJFRElTX0hPU1QiLCJwb3J0IiwicGFyc2VJbnQiLCJSRURJU19QT1JUIiwicGFzc3dvcmQiLCJSRURJU19QQVNTV09SRCIsImRiIiwiUkVESVNfREIiLCJvbiIsImVycm9yIiwibWVzc2FnZSIsIm1zIiwicmV0cnlJbiIsInBpbmciLCJhdHRlbXB0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZ2V0Q2xpZW50IiwiZGlzY29ubmVjdCIsInF1aXQiLCJoZWFsdGhDaGVjayIsImNsaWVudCIsInBvbmciLCJzdGF0dXMiLCJyZXNwb25zZSIsImNvbm5lY3RlZCIsInNob3VsZFVzZUZhbGxiYWNrIiwicmVkaXNDbGllbnQiLCJnZXRSZWRpc0NsaWVudCIsImNoZWNrUmVkaXNIZWFsdGgiLCJzaG91bGRVc2VGYWxsYmFja01vZGUiLCJzaHV0ZG93blJlZGlzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/redis-client.js\n");

/***/ }),

/***/ "(api)/./lib/security.js":
/*!*************************!*\
  !*** ./lib/security.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SecurityValidator: () => (/* binding */ SecurityValidator),\n/* harmony export */   applySecurityHeaders: () => (/* binding */ applySecurityHeaders),\n/* harmony export */   corsConfig: () => (/* binding */ corsConfig),\n/* harmony export */   createLegacySecurityMiddleware: () => (/* binding */ createLegacySecurityMiddleware),\n/* harmony export */   createSecurityMiddleware: () => (/* binding */ createSecurityMiddleware),\n/* harmony export */   securityHeaders: () => (/* binding */ securityHeaders)\n/* harmony export */ });\n/* harmony import */ var _utils_production_logger_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/production-logger.js */ \"(api)/./lib/utils/production-logger.js\");\n/* harmony import */ var _monitoring_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./monitoring.js */ \"(api)/./lib/monitoring.js\");\n/* harmony import */ var _middleware_redis_rate_limiter_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./middleware/redis-rate-limiter.js */ \"(api)/./lib/middleware/redis-rate-limiter.js\");\n/**\n * Security Utilities and Input Validation\n * Production-ready security implementation\n */ \n\n\n/**\n * Input validation and sanitization utilities\n */ class SecurityValidator {\n    /**\n   * Sanitize string input to prevent XSS\n   */ static sanitizeString(input, maxLength = 1000) {\n        if (typeof input !== \"string\") {\n            return \"\";\n        }\n        // Remove potential XSS vectors\n        return input.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, \"\") // Remove script tags\n        .replace(/javascript:/gi, \"\") // Remove javascript: URLs\n        .replace(/on\\w+\\s*=/gi, \"\") // Remove event handlers\n        .trim().substring(0, maxLength);\n    }\n    /**\n   * Validate email format\n   */ static validateEmail(email) {\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        return typeof email === \"string\" && emailRegex.test(email) && email.length <= 254;\n    }\n    /**\n   * Validate business type\n   */ static validateBusinessType(businessType) {\n        const validTypes = [\n            \"manufacturing\",\n            \"electronics\",\n            \"textiles\",\n            \"automotive\",\n            \"medical\",\n            \"consumer_goods\",\n            \"industrial\",\n            \"other\"\n        ];\n        return validTypes.includes(businessType);\n    }\n    /**\n   * Validate import volume\n   */ static validateImportVolume(volume) {\n        const validVolumes = [\n            \"Under $500K\",\n            \"$500K - $1M\",\n            \"$1M - $5M\",\n            \"$5M - $25M\",\n            \"Over $25M\"\n        ];\n        return validVolumes.includes(volume);\n    }\n    /**\n   * Validate HS code format\n   */ static validateHSCode(hsCode) {\n        if (typeof hsCode !== \"string\") return false;\n        // HS codes are typically 6-10 digits\n        const hsCodeRegex = /^\\d{6,10}$/;\n        return hsCodeRegex.test(hsCode);\n    }\n    /**\n   * Validate company name\n   */ static validateCompanyName(name) {\n        if (typeof name !== \"string\") return false;\n        return name.trim().length >= 2 && name.trim().length <= 100 && !/<[^>]*>/g.test(name) // No HTML tags\n        ;\n    }\n    /**\n   * Validate geographic data\n   */ static validateGeography(location) {\n        const validStates = [\n            \"AL\",\n            \"AK\",\n            \"AZ\",\n            \"AR\",\n            \"CA\",\n            \"CO\",\n            \"CT\",\n            \"DE\",\n            \"FL\",\n            \"GA\",\n            \"HI\",\n            \"ID\",\n            \"IL\",\n            \"IN\",\n            \"IA\",\n            \"KS\",\n            \"KY\",\n            \"LA\",\n            \"ME\",\n            \"MD\",\n            \"MA\",\n            \"MI\",\n            \"MN\",\n            \"MS\",\n            \"MO\",\n            \"MT\",\n            \"NE\",\n            \"NV\",\n            \"NH\",\n            \"NJ\",\n            \"NM\",\n            \"NY\",\n            \"NC\",\n            \"ND\",\n            \"OH\",\n            \"OK\",\n            \"OR\",\n            \"PA\",\n            \"RI\",\n            \"SC\",\n            \"SD\",\n            \"TN\",\n            \"TX\",\n            \"UT\",\n            \"VT\",\n            \"VA\",\n            \"WA\",\n            \"WV\",\n            \"WI\",\n            \"WY\"\n        ];\n        return validStates.includes(location?.state) && typeof location?.city === \"string\" && location.city.length >= 1 && location.city.length <= 50 && typeof location?.zipCode === \"string\" && /^\\d{5}(-\\d{4})?$/.test(location.zipCode);\n    }\n    /**\n   * Check for SQL injection attempts\n   */ static checkSQLInjection(input) {\n        if (typeof input !== \"string\") return false;\n        const sqlPatterns = [\n            /(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|UNION|SCRIPT)\\b)/i,\n            /(--|\\/\\*|\\*\\/|;|\\|\\||&&)/,\n            /(\\bOR\\b.*=.*\\bOR\\b|\\bAND\\b.*=.*\\bAND\\b)/i,\n            /'[^']*'(\\s*(=|!=|<>|<|>|\\bLIKE\\b)\\s*'[^']*'|\\s*\\bIN\\s*\\([^)]*\\))/i\n        ];\n        return sqlPatterns.some((pattern)=>pattern.test(input));\n    }\n    /**\n   * Validate API request structure\n   */ static validateAPIRequest(req, expectedFields = []) {\n        const errors = [];\n        // Check required fields\n        for (const field of expectedFields){\n            if (!(field in req.body)) {\n                errors.push(`Missing required field: ${field}`);\n            }\n        }\n        // Check for suspicious patterns in all string fields\n        for (const [key, value] of Object.entries(req.body)){\n            if (typeof value === \"string\") {\n                if (this.checkSQLInjection(value)) {\n                    (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logSecurity)(\"sql_injection_attempt\", {\n                        field: key,\n                        value: value.substring(0, 100),\n                        ip: this.getClientIP(req),\n                        userAgent: req.headers[\"user-agent\"]\n                    });\n                    (0,_monitoring_js__WEBPACK_IMPORTED_MODULE_1__.createAlert)(\"security_violation\", \"SQL injection attempt detected\", {\n                        field: key\n                    });\n                    errors.push(`Invalid input in field: ${key}`);\n                }\n            }\n        }\n        return {\n            valid: errors.length === 0,\n            errors\n        };\n    }\n    /**\n   * Get client IP address\n   */ static getClientIP(req) {\n        return req.headers[\"x-forwarded-for\"] || req.headers[\"x-real-ip\"] || req.connection?.remoteAddress || req.socket?.remoteAddress || \"unknown\";\n    }\n    /**\n   * Rate limiting check using Redis-based system\n   * @deprecated - Use rateLimitMiddleware directly instead\n   */ static async checkRateLimit(identifier, maxRequests = 100, timeWindow = 3600000) {\n        try {\n            // Get current rate limit status using Redis system\n            const config = {\n                windowMs: timeWindow,\n                maxRequests: maxRequests,\n                description: \"Legacy API rate limit\"\n            };\n            const status = await (0,_middleware_redis_rate_limiter_js__WEBPACK_IMPORTED_MODULE_2__.getRateLimitStatus)(identifier, config);\n            if (status.status === \"operational\" && status.currentCount >= maxRequests) {\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logSecurity)(\"rate_limit_exceeded\", {\n                    identifier,\n                    requests: status.currentCount,\n                    timeWindow: timeWindow / 1000,\n                    mode: status.mode\n                });\n                return false;\n            }\n            return true;\n        } catch (error) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logError)(\"Rate limit check error, allowing request\", {\n                error: error.message\n            });\n            return true // Allow request on error\n            ;\n        }\n    }\n}\n/**\n * API Security Middleware with Redis-based rate limiting\n */ function createSecurityMiddleware(options = {}) {\n    const { maxRequests = 100, timeWindow = 3600000, requiredFields = [], validateInput = true, useRedisRateLimit = true } = options;\n    return async (req, res, next)=>{\n        const startTime = Date.now();\n        try {\n            const clientIP = SecurityValidator.getClientIP(req);\n            // Apply Redis-based rate limiting first if enabled\n            if (useRedisRateLimit) {\n                await new Promise((resolve, reject)=>{\n                    (0,_middleware_redis_rate_limiter_js__WEBPACK_IMPORTED_MODULE_2__.rateLimitMiddleware)(req, res, (error)=>{\n                        if (error) {\n                            reject(error);\n                        } else {\n                            // Check if response was already sent (rate limit exceeded)\n                            if (res.headersSent) {\n                                return; // Rate limit response already sent\n                            }\n                            resolve();\n                        }\n                    });\n                });\n                // If rate limit middleware sent a response, stop here\n                if (res.headersSent) {\n                    return;\n                }\n            }\n            // Input validation\n            if (validateInput && req.method !== \"GET\") {\n                const validation = SecurityValidator.validateAPIRequest(req, requiredFields);\n                if (!validation.valid) {\n                    (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logSecurity)(\"invalid_input\", {\n                        errors: validation.errors,\n                        ip: clientIP,\n                        endpoint: req.url\n                    });\n                    return res.status(400).json({\n                        error: \"Invalid input\",\n                        message: \"Request validation failed\",\n                        details: validation.errors\n                    });\n                }\n            }\n            // Log successful security check\n            const duration = Date.now() - startTime;\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logSecurity)(\"request_validated\", {\n                method: req.method,\n                endpoint: req.url,\n                ip: clientIP,\n                duration: `${duration}ms`\n            });\n            // Continue to next middleware\n            if (next) {\n                next();\n            }\n        } catch (error) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_0__.logError)(\"Security middleware error\", {\n                error: error.message,\n                stack: error.stack,\n                ip: SecurityValidator.getClientIP(req),\n                endpoint: req.url\n            });\n            return res.status(500).json({\n                error: \"Internal security error\",\n                message: \"Request could not be validated\"\n            });\n        }\n    };\n}\n/**\n * Legacy security middleware (for backwards compatibility)\n */ function createLegacySecurityMiddleware(options = {}) {\n    return createSecurityMiddleware({\n        ...options,\n        useRedisRateLimit: false\n    });\n}\n/**\n * CORS configuration\n */ const corsConfig = {\n    origin:  false ? 0 : [\n        \"http://localhost:3000\",\n        \"http://127.0.0.1:3000\"\n    ],\n    methods: [\n        \"GET\",\n        \"POST\",\n        \"PUT\",\n        \"DELETE\",\n        \"OPTIONS\"\n    ],\n    allowedHeaders: [\n        \"Content-Type\",\n        \"Authorization\",\n        \"X-Requested-With\"\n    ],\n    credentials: true,\n    maxAge: 86400 // 24 hours\n};\n/**\n * Security headers configuration\n */ const securityHeaders = {\n    \"X-Content-Type-Options\": \"nosniff\",\n    \"X-Frame-Options\": \"DENY\",\n    \"X-XSS-Protection\": \"1; mode=block\",\n    \"Referrer-Policy\": \"strict-origin-when-cross-origin\",\n    \"Strict-Transport-Security\": \"max-age=63072000; includeSubDomains; preload\",\n    \"Content-Security-Policy\": [\n        \"default-src 'self'\",\n        \"script-src 'self' 'unsafe-inline' 'unsafe-eval'\",\n        \"style-src 'self' 'unsafe-inline'\",\n        \"img-src 'self' data: https:\",\n        \"font-src 'self'\",\n        \"connect-src 'self' https://api.stripe.com https://*.supabase.co\",\n        \"frame-ancestors 'none'\",\n        \"base-uri 'self'\"\n    ].join(\"; \")\n};\n/**\n * Apply security headers to response\n */ function applySecurityHeaders(res) {\n    Object.entries(securityHeaders).forEach(([header, value])=>{\n        res.setHeader(header, value);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUlpRCxHQUFHO1lBQ25CO1lBRUEsT0FBT2IsSUFBSVgsTUFBTSxDQUFDLEtBQUt5QixJQUFJLENBQUM7Z0JBQzFCckIsT0FBTztnQkFDUEMsU0FBUztZQUNYO1FBQ0Y7SUFDRjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTd0IsK0JBQStCdEIsVUFBVSxDQUFDLENBQUM7SUFDekQsT0FBT0QseUJBQXlCO1FBQUUsR0FBR0MsT0FBTztRQUFFRyxtQkFBbUI7SUFBTTtBQUN6RTtBQUVBOztDQUVDLEdBQ00sTUFBTW9CLGFBQWE7SUFDeEJDLFFBQVFDLE1BQXlCLEdBQzdCLENBQTRFLEdBQzVFO1FBQUM7UUFBeUI7S0FBd0I7SUFDdERDLFNBQVM7UUFBQztRQUFPO1FBQVE7UUFBTztRQUFVO0tBQVU7SUFDcERDLGdCQUFnQjtRQUFDO1FBQWdCO1FBQWlCO0tBQW1CO0lBQ3JFQyxhQUFhO0lBQ2JDLFFBQVEsTUFBTSxXQUFXO0FBQzNCLEVBQUM7QUFFRDs7Q0FFQyxHQUNNLE1BQU1DLGtCQUFrQjtJQUM3QiwwQkFBMEI7SUFDMUIsbUJBQW1CO0lBQ25CLG9CQUFvQjtJQUNwQixtQkFBbUI7SUFDbkIsNkJBQTZCO0lBQzdCLDJCQUEyQjtRQUN6QjtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO0tBQ0QsQ0FBQ0MsSUFBSSxDQUFDO0FBQ1QsRUFBQztBQUVEOztDQUVDLEdBQ00sU0FBU0MscUJBQXFCNUIsR0FBRztJQUN0QzVCLE9BQU9DLE9BQU8sQ0FBQ3FELGlCQUFpQkcsT0FBTyxDQUFDLENBQUMsQ0FBQ0MsUUFBUTNELE1BQU07UUFDdEQ2QixJQUFJK0IsU0FBUyxDQUFDRCxRQUFRM0Q7SUFDeEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyaWFuZ2xlLWludGVsbGlnZW5jZS1wbGF0Zm9ybS8uL2xpYi9zZWN1cml0eS5qcz8xYzM1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2VjdXJpdHkgVXRpbGl0aWVzIGFuZCBJbnB1dCBWYWxpZGF0aW9uXG4gKiBQcm9kdWN0aW9uLXJlYWR5IHNlY3VyaXR5IGltcGxlbWVudGF0aW9uXG4gKi9cblxuaW1wb3J0IHsgbG9nU2VjdXJpdHksIGxvZ0Vycm9yIH0gZnJvbSAnLi91dGlscy9wcm9kdWN0aW9uLWxvZ2dlci5qcydcbmltcG9ydCB7IGNyZWF0ZUFsZXJ0IH0gZnJvbSAnLi9tb25pdG9yaW5nLmpzJ1xuaW1wb3J0IHsgcmF0ZUxpbWl0TWlkZGxld2FyZSwgZ2V0UmF0ZUxpbWl0U3RhdHVzIH0gZnJvbSAnLi9taWRkbGV3YXJlL3JlZGlzLXJhdGUtbGltaXRlci5qcydcblxuLyoqXG4gKiBJbnB1dCB2YWxpZGF0aW9uIGFuZCBzYW5pdGl6YXRpb24gdXRpbGl0aWVzXG4gKi9cbmV4cG9ydCBjbGFzcyBTZWN1cml0eVZhbGlkYXRvciB7XG4gIFxuICAvKipcbiAgICogU2FuaXRpemUgc3RyaW5nIGlucHV0IHRvIHByZXZlbnQgWFNTXG4gICAqL1xuICBzdGF0aWMgc2FuaXRpemVTdHJpbmcoaW5wdXQsIG1heExlbmd0aCA9IDEwMDApIHtcbiAgICBpZiAodHlwZW9mIGlucHV0ICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuICcnXG4gICAgfVxuICAgIFxuICAgIC8vIFJlbW92ZSBwb3RlbnRpYWwgWFNTIHZlY3RvcnNcbiAgICByZXR1cm4gaW5wdXRcbiAgICAgIC5yZXBsYWNlKC88c2NyaXB0XFxiW148XSooPzooPyE8XFwvc2NyaXB0Pik8W148XSopKjxcXC9zY3JpcHQ+L2dpLCAnJykgLy8gUmVtb3ZlIHNjcmlwdCB0YWdzXG4gICAgICAucmVwbGFjZSgvamF2YXNjcmlwdDovZ2ksICcnKSAvLyBSZW1vdmUgamF2YXNjcmlwdDogVVJMc1xuICAgICAgLnJlcGxhY2UoL29uXFx3K1xccyo9L2dpLCAnJykgLy8gUmVtb3ZlIGV2ZW50IGhhbmRsZXJzXG4gICAgICAudHJpbSgpXG4gICAgICAuc3Vic3RyaW5nKDAsIG1heExlbmd0aClcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBlbWFpbCBmb3JtYXRcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZUVtYWlsKGVtYWlsKSB7XG4gICAgY29uc3QgZW1haWxSZWdleCA9IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvXG4gICAgcmV0dXJuIHR5cGVvZiBlbWFpbCA9PT0gJ3N0cmluZycgJiYgZW1haWxSZWdleC50ZXN0KGVtYWlsKSAmJiBlbWFpbC5sZW5ndGggPD0gMjU0XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgYnVzaW5lc3MgdHlwZVxuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlQnVzaW5lc3NUeXBlKGJ1c2luZXNzVHlwZSkge1xuICAgIGNvbnN0IHZhbGlkVHlwZXMgPSBbXG4gICAgICAnbWFudWZhY3R1cmluZycsXG4gICAgICAnZWxlY3Ryb25pY3MnLCBcbiAgICAgICd0ZXh0aWxlcycsXG4gICAgICAnYXV0b21vdGl2ZScsXG4gICAgICAnbWVkaWNhbCcsXG4gICAgICAnY29uc3VtZXJfZ29vZHMnLFxuICAgICAgJ2luZHVzdHJpYWwnLFxuICAgICAgJ290aGVyJ1xuICAgIF1cbiAgICBcbiAgICByZXR1cm4gdmFsaWRUeXBlcy5pbmNsdWRlcyhidXNpbmVzc1R5cGUpXG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgaW1wb3J0IHZvbHVtZVxuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlSW1wb3J0Vm9sdW1lKHZvbHVtZSkge1xuICAgIGNvbnN0IHZhbGlkVm9sdW1lcyA9IFtcbiAgICAgICdVbmRlciAkNTAwSycsXG4gICAgICAnJDUwMEsgLSAkMU0nLFxuICAgICAgJyQxTSAtICQ1TScsIFxuICAgICAgJyQ1TSAtICQyNU0nLFxuICAgICAgJ092ZXIgJDI1TSdcbiAgICBdXG4gICAgXG4gICAgcmV0dXJuIHZhbGlkVm9sdW1lcy5pbmNsdWRlcyh2b2x1bWUpXG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgSFMgY29kZSBmb3JtYXRcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZUhTQ29kZShoc0NvZGUpIHtcbiAgICBpZiAodHlwZW9mIGhzQ29kZSAhPT0gJ3N0cmluZycpIHJldHVybiBmYWxzZVxuICAgIFxuICAgIC8vIEhTIGNvZGVzIGFyZSB0eXBpY2FsbHkgNi0xMCBkaWdpdHNcbiAgICBjb25zdCBoc0NvZGVSZWdleCA9IC9eXFxkezYsMTB9JC9cbiAgICByZXR1cm4gaHNDb2RlUmVnZXgudGVzdChoc0NvZGUpXG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgY29tcGFueSBuYW1lXG4gICAqL1xuICBzdGF0aWMgdmFsaWRhdGVDb21wYW55TmFtZShuYW1lKSB7XG4gICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlXG4gICAgXG4gICAgcmV0dXJuIG5hbWUudHJpbSgpLmxlbmd0aCA+PSAyICYmIFxuICAgICAgICAgICBuYW1lLnRyaW0oKS5sZW5ndGggPD0gMTAwICYmXG4gICAgICAgICAgICEvPFtePl0qPi9nLnRlc3QobmFtZSkgLy8gTm8gSFRNTCB0YWdzXG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgZ2VvZ3JhcGhpYyBkYXRhXG4gICAqL1xuICBzdGF0aWMgdmFsaWRhdGVHZW9ncmFwaHkobG9jYXRpb24pIHtcbiAgICBjb25zdCB2YWxpZFN0YXRlcyA9IFtcbiAgICAgICdBTCcsICdBSycsICdBWicsICdBUicsICdDQScsICdDTycsICdDVCcsICdERScsICdGTCcsICdHQScsXG4gICAgICAnSEknLCAnSUQnLCAnSUwnLCAnSU4nLCAnSUEnLCAnS1MnLCAnS1knLCAnTEEnLCAnTUUnLCAnTUQnLFxuICAgICAgJ01BJywgJ01JJywgJ01OJywgJ01TJywgJ01PJywgJ01UJywgJ05FJywgJ05WJywgJ05IJywgJ05KJyxcbiAgICAgICdOTScsICdOWScsICdOQycsICdORCcsICdPSCcsICdPSycsICdPUicsICdQQScsICdSSScsICdTQycsXG4gICAgICAnU0QnLCAnVE4nLCAnVFgnLCAnVVQnLCAnVlQnLCAnVkEnLCAnV0EnLCAnV1YnLCAnV0knLCAnV1knXG4gICAgXVxuICAgIFxuICAgIHJldHVybiB2YWxpZFN0YXRlcy5pbmNsdWRlcyhsb2NhdGlvbj8uc3RhdGUpICYmXG4gICAgICAgICAgIHR5cGVvZiBsb2NhdGlvbj8uY2l0eSA9PT0gJ3N0cmluZycgJiZcbiAgICAgICAgICAgbG9jYXRpb24uY2l0eS5sZW5ndGggPj0gMSAmJlxuICAgICAgICAgICBsb2NhdGlvbi5jaXR5Lmxlbmd0aCA8PSA1MCAmJlxuICAgICAgICAgICB0eXBlb2YgbG9jYXRpb24/LnppcENvZGUgPT09ICdzdHJpbmcnICYmXG4gICAgICAgICAgIC9eXFxkezV9KC1cXGR7NH0pPyQvLnRlc3QobG9jYXRpb24uemlwQ29kZSlcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBmb3IgU1FMIGluamVjdGlvbiBhdHRlbXB0c1xuICAgKi9cbiAgc3RhdGljIGNoZWNrU1FMSW5qZWN0aW9uKGlucHV0KSB7XG4gICAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHJldHVybiBmYWxzZVxuICAgIFxuICAgIGNvbnN0IHNxbFBhdHRlcm5zID0gW1xuICAgICAgLyhcXGIoU0VMRUNUfElOU0VSVHxVUERBVEV8REVMRVRFfERST1B8Q1JFQVRFfEFMVEVSfEVYRUN8VU5JT058U0NSSVBUKVxcYikvaSxcbiAgICAgIC8oLS18XFwvXFwqfFxcKlxcL3w7fFxcfFxcfHwmJikvLFxuICAgICAgLyhcXGJPUlxcYi4qPS4qXFxiT1JcXGJ8XFxiQU5EXFxiLio9LipcXGJBTkRcXGIpL2ksXG4gICAgICAvJ1teJ10qJyhcXHMqKD18IT18PD58PHw+fFxcYkxJS0VcXGIpXFxzKidbXiddKid8XFxzKlxcYklOXFxzKlxcKFteKV0qXFwpKS9pXG4gICAgXVxuICAgIFxuICAgIHJldHVybiBzcWxQYXR0ZXJucy5zb21lKHBhdHRlcm4gPT4gcGF0dGVybi50ZXN0KGlucHV0KSlcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBBUEkgcmVxdWVzdCBzdHJ1Y3R1cmVcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZUFQSVJlcXVlc3QocmVxLCBleHBlY3RlZEZpZWxkcyA9IFtdKSB7XG4gICAgY29uc3QgZXJyb3JzID0gW11cbiAgICBcbiAgICAvLyBDaGVjayByZXF1aXJlZCBmaWVsZHNcbiAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIGV4cGVjdGVkRmllbGRzKSB7XG4gICAgICBpZiAoIShmaWVsZCBpbiByZXEuYm9keSkpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goYE1pc3NpbmcgcmVxdWlyZWQgZmllbGQ6ICR7ZmllbGR9YClcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgZm9yIHN1c3BpY2lvdXMgcGF0dGVybnMgaW4gYWxsIHN0cmluZyBmaWVsZHNcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhyZXEuYm9keSkpIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGlmICh0aGlzLmNoZWNrU1FMSW5qZWN0aW9uKHZhbHVlKSkge1xuICAgICAgICAgIGxvZ1NlY3VyaXR5KCdzcWxfaW5qZWN0aW9uX2F0dGVtcHQnLCB7XG4gICAgICAgICAgICBmaWVsZDoga2V5LFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLnN1YnN0cmluZygwLCAxMDApLFxuICAgICAgICAgICAgaXA6IHRoaXMuZ2V0Q2xpZW50SVAocmVxKSxcbiAgICAgICAgICAgIHVzZXJBZ2VudDogcmVxLmhlYWRlcnNbJ3VzZXItYWdlbnQnXVxuICAgICAgICAgIH0pXG4gICAgICAgICAgY3JlYXRlQWxlcnQoJ3NlY3VyaXR5X3Zpb2xhdGlvbicsICdTUUwgaW5qZWN0aW9uIGF0dGVtcHQgZGV0ZWN0ZWQnLCB7IGZpZWxkOiBrZXkgfSlcbiAgICAgICAgICBlcnJvcnMucHVzaChgSW52YWxpZCBpbnB1dCBpbiBmaWVsZDogJHtrZXl9YClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICBlcnJvcnNcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNsaWVudCBJUCBhZGRyZXNzXG4gICAqL1xuICBzdGF0aWMgZ2V0Q2xpZW50SVAocmVxKSB7XG4gICAgcmV0dXJuIHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXSB8fFxuICAgICAgICAgICByZXEuaGVhZGVyc1sneC1yZWFsLWlwJ10gfHxcbiAgICAgICAgICAgcmVxLmNvbm5lY3Rpb24/LnJlbW90ZUFkZHJlc3MgfHxcbiAgICAgICAgICAgcmVxLnNvY2tldD8ucmVtb3RlQWRkcmVzcyB8fFxuICAgICAgICAgICAndW5rbm93bidcbiAgfVxuXG4gIC8qKlxuICAgKiBSYXRlIGxpbWl0aW5nIGNoZWNrIHVzaW5nIFJlZGlzLWJhc2VkIHN5c3RlbVxuICAgKiBAZGVwcmVjYXRlZCAtIFVzZSByYXRlTGltaXRNaWRkbGV3YXJlIGRpcmVjdGx5IGluc3RlYWRcbiAgICovXG4gIHN0YXRpYyBhc3luYyBjaGVja1JhdGVMaW1pdChpZGVudGlmaWVyLCBtYXhSZXF1ZXN0cyA9IDEwMCwgdGltZVdpbmRvdyA9IDM2MDAwMDApIHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IGN1cnJlbnQgcmF0ZSBsaW1pdCBzdGF0dXMgdXNpbmcgUmVkaXMgc3lzdGVtXG4gICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgIHdpbmRvd01zOiB0aW1lV2luZG93LFxuICAgICAgICBtYXhSZXF1ZXN0czogbWF4UmVxdWVzdHMsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTGVnYWN5IEFQSSByYXRlIGxpbWl0J1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCBnZXRSYXRlTGltaXRTdGF0dXMoaWRlbnRpZmllciwgY29uZmlnKVxuICAgICAgXG4gICAgICBpZiAoc3RhdHVzLnN0YXR1cyA9PT0gJ29wZXJhdGlvbmFsJyAmJiBzdGF0dXMuY3VycmVudENvdW50ID49IG1heFJlcXVlc3RzKSB7XG4gICAgICAgIGxvZ1NlY3VyaXR5KCdyYXRlX2xpbWl0X2V4Y2VlZGVkJywge1xuICAgICAgICAgIGlkZW50aWZpZXIsXG4gICAgICAgICAgcmVxdWVzdHM6IHN0YXR1cy5jdXJyZW50Q291bnQsXG4gICAgICAgICAgdGltZVdpbmRvdzogdGltZVdpbmRvdyAvIDEwMDAsXG4gICAgICAgICAgbW9kZTogc3RhdHVzLm1vZGVcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ0Vycm9yKCdSYXRlIGxpbWl0IGNoZWNrIGVycm9yLCBhbGxvd2luZyByZXF1ZXN0JywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KVxuICAgICAgcmV0dXJuIHRydWUgLy8gQWxsb3cgcmVxdWVzdCBvbiBlcnJvclxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEFQSSBTZWN1cml0eSBNaWRkbGV3YXJlIHdpdGggUmVkaXMtYmFzZWQgcmF0ZSBsaW1pdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2VjdXJpdHlNaWRkbGV3YXJlKG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgbWF4UmVxdWVzdHMgPSAxMDAsXG4gICAgdGltZVdpbmRvdyA9IDM2MDAwMDAsIC8vIDEgaG91clxuICAgIHJlcXVpcmVkRmllbGRzID0gW10sXG4gICAgdmFsaWRhdGVJbnB1dCA9IHRydWUsXG4gICAgdXNlUmVkaXNSYXRlTGltaXQgPSB0cnVlXG4gIH0gPSBvcHRpb25zXG5cbiAgcmV0dXJuIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KClcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2xpZW50SVAgPSBTZWN1cml0eVZhbGlkYXRvci5nZXRDbGllbnRJUChyZXEpXG4gICAgICBcbiAgICAgIC8vIEFwcGx5IFJlZGlzLWJhc2VkIHJhdGUgbGltaXRpbmcgZmlyc3QgaWYgZW5hYmxlZFxuICAgICAgaWYgKHVzZVJlZGlzUmF0ZUxpbWl0KSB7XG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICByYXRlTGltaXRNaWRkbGV3YXJlKHJlcSwgcmVzLCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICByZWplY3QoZXJyb3IpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBDaGVjayBpZiByZXNwb25zZSB3YXMgYWxyZWFkeSBzZW50IChyYXRlIGxpbWl0IGV4Y2VlZGVkKVxuICAgICAgICAgICAgICBpZiAocmVzLmhlYWRlcnNTZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC8vIFJhdGUgbGltaXQgcmVzcG9uc2UgYWxyZWFkeSBzZW50XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgICAgIC8vIElmIHJhdGUgbGltaXQgbWlkZGxld2FyZSBzZW50IGEgcmVzcG9uc2UsIHN0b3AgaGVyZVxuICAgICAgICBpZiAocmVzLmhlYWRlcnNTZW50KSB7XG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSW5wdXQgdmFsaWRhdGlvblxuICAgICAgaWYgKHZhbGlkYXRlSW5wdXQgJiYgcmVxLm1ldGhvZCAhPT0gJ0dFVCcpIHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IFNlY3VyaXR5VmFsaWRhdG9yLnZhbGlkYXRlQVBJUmVxdWVzdChyZXEsIHJlcXVpcmVkRmllbGRzKVxuICAgICAgICBcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgbG9nU2VjdXJpdHkoJ2ludmFsaWRfaW5wdXQnLCB7XG4gICAgICAgICAgICBlcnJvcnM6IHZhbGlkYXRpb24uZXJyb3JzLFxuICAgICAgICAgICAgaXA6IGNsaWVudElQLFxuICAgICAgICAgICAgZW5kcG9pbnQ6IHJlcS51cmxcbiAgICAgICAgICB9KVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgaW5wdXQnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1JlcXVlc3QgdmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgZGV0YWlsczogdmFsaWRhdGlvbi5lcnJvcnNcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIExvZyBzdWNjZXNzZnVsIHNlY3VyaXR5IGNoZWNrXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWVcbiAgICAgIGxvZ1NlY3VyaXR5KCdyZXF1ZXN0X3ZhbGlkYXRlZCcsIHtcbiAgICAgICAgbWV0aG9kOiByZXEubWV0aG9kLFxuICAgICAgICBlbmRwb2ludDogcmVxLnVybCxcbiAgICAgICAgaXA6IGNsaWVudElQLFxuICAgICAgICBkdXJhdGlvbjogYCR7ZHVyYXRpb259bXNgXG4gICAgICB9KVxuICAgICAgXG4gICAgICAvLyBDb250aW51ZSB0byBuZXh0IG1pZGRsZXdhcmVcbiAgICAgIGlmIChuZXh0KSB7XG4gICAgICAgIG5leHQoKVxuICAgICAgfVxuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ0Vycm9yKCdTZWN1cml0eSBtaWRkbGV3YXJlIGVycm9yJywge1xuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrLFxuICAgICAgICBpcDogU2VjdXJpdHlWYWxpZGF0b3IuZ2V0Q2xpZW50SVAocmVxKSxcbiAgICAgICAgZW5kcG9pbnQ6IHJlcS51cmxcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VjdXJpdHkgZXJyb3InLFxuICAgICAgICBtZXNzYWdlOiAnUmVxdWVzdCBjb3VsZCBub3QgYmUgdmFsaWRhdGVkJ1xuICAgICAgfSlcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBMZWdhY3kgc2VjdXJpdHkgbWlkZGxld2FyZSAoZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5KVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTGVnYWN5U2VjdXJpdHlNaWRkbGV3YXJlKG9wdGlvbnMgPSB7fSkge1xuICByZXR1cm4gY3JlYXRlU2VjdXJpdHlNaWRkbGV3YXJlKHsgLi4ub3B0aW9ucywgdXNlUmVkaXNSYXRlTGltaXQ6IGZhbHNlIH0pXG59XG5cbi8qKlxuICogQ09SUyBjb25maWd1cmF0aW9uXG4gKi9cbmV4cG9ydCBjb25zdCBjb3JzQ29uZmlnID0ge1xuICBvcmlnaW46IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgXG4gICAgPyBbJ2h0dHBzOi8vdHJpYW5nbGVpbnRlbGxpZ2VuY2UuY29tJywgJ2h0dHBzOi8vd3d3LnRyaWFuZ2xlaW50ZWxsaWdlbmNlLmNvbSddXG4gICAgOiBbJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsICdodHRwOi8vMTI3LjAuMC4xOjMwMDAnXSxcbiAgbWV0aG9kczogWydHRVQnLCAnUE9TVCcsICdQVVQnLCAnREVMRVRFJywgJ09QVElPTlMnXSxcbiAgYWxsb3dlZEhlYWRlcnM6IFsnQ29udGVudC1UeXBlJywgJ0F1dGhvcml6YXRpb24nLCAnWC1SZXF1ZXN0ZWQtV2l0aCddLFxuICBjcmVkZW50aWFsczogdHJ1ZSxcbiAgbWF4QWdlOiA4NjQwMCAvLyAyNCBob3Vyc1xufVxuXG4vKipcbiAqIFNlY3VyaXR5IGhlYWRlcnMgY29uZmlndXJhdGlvblxuICovXG5leHBvcnQgY29uc3Qgc2VjdXJpdHlIZWFkZXJzID0ge1xuICAnWC1Db250ZW50LVR5cGUtT3B0aW9ucyc6ICdub3NuaWZmJyxcbiAgJ1gtRnJhbWUtT3B0aW9ucyc6ICdERU5ZJyxcbiAgJ1gtWFNTLVByb3RlY3Rpb24nOiAnMTsgbW9kZT1ibG9jaycsXG4gICdSZWZlcnJlci1Qb2xpY3knOiAnc3RyaWN0LW9yaWdpbi13aGVuLWNyb3NzLW9yaWdpbicsXG4gICdTdHJpY3QtVHJhbnNwb3J0LVNlY3VyaXR5JzogJ21heC1hZ2U9NjMwNzIwMDA7IGluY2x1ZGVTdWJEb21haW5zOyBwcmVsb2FkJyxcbiAgJ0NvbnRlbnQtU2VjdXJpdHktUG9saWN5JzogW1xuICAgIFwiZGVmYXVsdC1zcmMgJ3NlbGYnXCIsXG4gICAgXCJzY3JpcHQtc3JjICdzZWxmJyAndW5zYWZlLWlubGluZScgJ3Vuc2FmZS1ldmFsJ1wiLFxuICAgIFwic3R5bGUtc3JjICdzZWxmJyAndW5zYWZlLWlubGluZSdcIixcbiAgICBcImltZy1zcmMgJ3NlbGYnIGRhdGE6IGh0dHBzOlwiLFxuICAgIFwiZm9udC1zcmMgJ3NlbGYnXCIsXG4gICAgXCJjb25uZWN0LXNyYyAnc2VsZicgaHR0cHM6Ly9hcGkuc3RyaXBlLmNvbSBodHRwczovLyouc3VwYWJhc2UuY29cIixcbiAgICBcImZyYW1lLWFuY2VzdG9ycyAnbm9uZSdcIixcbiAgICBcImJhc2UtdXJpICdzZWxmJ1wiXG4gIF0uam9pbignOyAnKVxufVxuXG4vKipcbiAqIEFwcGx5IHNlY3VyaXR5IGhlYWRlcnMgdG8gcmVzcG9uc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5U2VjdXJpdHlIZWFkZXJzKHJlcykge1xuICBPYmplY3QuZW50cmllcyhzZWN1cml0eUhlYWRlcnMpLmZvckVhY2goKFtoZWFkZXIsIHZhbHVlXSkgPT4ge1xuICAgIHJlcy5zZXRIZWFkZXIoaGVhZGVyLCB2YWx1ZSlcbiAgfSlcbn0iXSwibmFtZXMiOlsibG9nU2VjdXJpdHkiLCJsb2dFcnJvciIsImNyZWF0ZUFsZXJ0IiwicmF0ZUxpbWl0TWlkZGxld2FyZSIsImdldFJhdGVMaW1pdFN0YXR1cyIsIlNlY3VyaXR5VmFsaWRhdG9yIiwic2FuaXRpemVTdHJpbmciLCJpbnB1dCIsIm1heExlbmd0aCIsInJlcGxhY2UiLCJ0cmltIiwic3Vic3RyaW5nIiwidmFsaWRhdGVFbWFpbCIsImVtYWlsIiwiZW1haWxSZWdleCIsInRlc3QiLCJsZW5ndGgiLCJ2YWxpZGF0ZUJ1c2luZXNzVHlwZSIsImJ1c2luZXNzVHlwZSIsInZhbGlkVHlwZXMiLCJpbmNsdWRlcyIsInZhbGlkYXRlSW1wb3J0Vm9sdW1lIiwidm9sdW1lIiwidmFsaWRWb2x1bWVzIiwidmFsaWRhdGVIU0NvZGUiLCJoc0NvZGUiLCJoc0NvZGVSZWdleCIsInZhbGlkYXRlQ29tcGFueU5hbWUiLCJuYW1lIiwidmFsaWRhdGVHZW9ncmFwaHkiLCJsb2NhdGlvbiIsInZhbGlkU3RhdGVzIiwic3RhdGUiLCJjaXR5IiwiemlwQ29kZSIsImNoZWNrU1FMSW5qZWN0aW9uIiwic3FsUGF0dGVybnMiLCJzb21lIiwicGF0dGVybiIsInZhbGlkYXRlQVBJUmVxdWVzdCIsInJlcSIsImV4cGVjdGVkRmllbGRzIiwiZXJyb3JzIiwiZmllbGQiLCJib2R5IiwicHVzaCIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsImlwIiwiZ2V0Q2xpZW50SVAiLCJ1c2VyQWdlbnQiLCJoZWFkZXJzIiwidmFsaWQiLCJjb25uZWN0aW9uIiwicmVtb3RlQWRkcmVzcyIsInNvY2tldCIsImNoZWNrUmF0ZUxpbWl0IiwiaWRlbnRpZmllciIsIm1heFJlcXVlc3RzIiwidGltZVdpbmRvdyIsImNvbmZpZyIsIndpbmRvd01zIiwiZGVzY3JpcHRpb24iLCJzdGF0dXMiLCJjdXJyZW50Q291bnQiLCJyZXF1ZXN0cyIsIm1vZGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJjcmVhdGVTZWN1cml0eU1pZGRsZXdhcmUiLCJvcHRpb25zIiwicmVxdWlyZWRGaWVsZHMiLCJ2YWxpZGF0ZUlucHV0IiwidXNlUmVkaXNSYXRlTGltaXQiLCJyZXMiLCJuZXh0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImNsaWVudElQIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJoZWFkZXJzU2VudCIsIm1ldGhvZCIsInZhbGlkYXRpb24iLCJlbmRwb2ludCIsInVybCIsImpzb24iLCJkZXRhaWxzIiwiZHVyYXRpb24iLCJzdGFjayIsImNyZWF0ZUxlZ2FjeVNlY3VyaXR5TWlkZGxld2FyZSIsImNvcnNDb25maWciLCJvcmlnaW4iLCJwcm9jZXNzIiwibWV0aG9kcyIsImFsbG93ZWRIZWFkZXJzIiwiY3JlZGVudGlhbHMiLCJtYXhBZ2UiLCJzZWN1cml0eUhlYWRlcnMiLCJqb2luIiwiYXBwbHlTZWN1cml0eUhlYWRlcnMiLCJmb3JFYWNoIiwiaGVhZGVyIiwic2V0SGVhZGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/security.js\n");

/***/ }),

/***/ "(api)/./lib/supabase-client.js":
/*!********************************!*\
  !*** ./lib/supabase-client.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   executeOptimizedQuery: () => (/* binding */ executeOptimizedQuery),\n/* harmony export */   getConnectionStats: () => (/* binding */ getConnectionStats),\n/* harmony export */   getServerSupabaseClient: () => (/* binding */ getServerSupabaseClient),\n/* harmony export */   getSupabaseClient: () => (/* binding */ getSupabaseClient),\n/* harmony export */   shutdownConnections: () => (/* binding */ shutdownConnections),\n/* harmony export */   testSupabaseConnection: () => (/* binding */ testSupabaseConnection)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _production_logger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./production-logger.js */ \"(api)/./lib/production-logger.js\");\n/* harmony import */ var _memory_optimizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./memory-optimizer.js */ \"(api)/./lib/memory-optimizer.js\");\n/**\n * SHARED SUPABASE CLIENT WITH SERVER/CLIENT SEPARATION\n * Ensures service keys are NEVER exposed client-side\n * Single instance pattern to avoid conflicts\n */ \n\n\nlet supabaseInstance = null;\nlet supabaseServerInstance = null;\nlet connectionPool = {\n    activeConnections: 0,\n    maxConnections: 50,\n    connectionQueue: [],\n    lastCleanup: Date.now(),\n    peakConnections: 0,\n    totalQueries: 0\n};\n/**\n * Get Supabase client appropriate for the environment\n * Client-side: Uses anonymous key (safe for browser)\n * Server-side: Uses service role key (never exposed to browser)\n */ const getSupabaseClient = ()=>{\n    // Check if we're on the server or client\n    const isServer = \"undefined\" === \"undefined\";\n    if (isServer) {\n        // SERVER-SIDE: Use service role key for full access\n        if (!supabaseServerInstance) {\n            const serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n            if (!serviceKey) {\n                (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"SUPABASE_SERVICE_ROLE_KEY not found in server environment\");\n                throw new Error(\"Server configuration error: Missing service key\");\n            }\n            supabaseServerInstance = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://mrwitpgbcaxgnirqtavt.supabase.co\", serviceKey, {\n                auth: {\n                    autoRefreshToken: false,\n                    persistSession: false\n                },\n                db: {\n                    schema: \"public\"\n                },\n                global: {\n                    headers: {\n                        \"User-Agent\": \"Triangle-Intelligence-Platform/1.0\"\n                    }\n                }\n            });\n            // Register cleanup with memory optimizer\n            const memoryOptimizer = (0,_memory_optimizer_js__WEBPACK_IMPORTED_MODULE_2__.getMemoryOptimizer)();\n            memoryOptimizer.registerCleanup(\"supabase-server-client\", ()=>{\n                if (supabaseServerInstance) {\n                    (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Cleaning up Supabase server connections\");\n                    supabaseServerInstance = null;\n                }\n            });\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Created server-side Supabase client with service role and memory optimization\");\n        }\n        return supabaseServerInstance;\n    } else {\n        // CLIENT-SIDE: Use anonymous key only\n        if (!supabaseInstance) {\n            const anonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1yd2l0cGdiY2F4Z25pcnF0YXZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjUxMzQsImV4cCI6MjA2NTQwMTEzNH0.5g-eaUIwy4VQD2YfNC2sFNoZYF1HdUzVTNJZvtuVSI8\";\n            if (!anonKey) {\n                (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"NEXT_PUBLIC_SUPABASE_ANON_KEY not found\");\n                throw new Error(\"Client configuration error: Missing anonymous key\");\n            }\n            supabaseInstance = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://mrwitpgbcaxgnirqtavt.supabase.co\", anonKey);\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Created client-side Supabase client with anonymous key\");\n        }\n        return supabaseInstance;\n    }\n};\n/**\n * Get server-only Supabase client with service role\n * CRITICAL: Only use in API routes, never in components\n */ const getServerSupabaseClient = ()=>{\n    if (false) {}\n    if (!supabaseServerInstance) {\n        const serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n        if (!serviceKey) {\n            throw new Error(\"SUPABASE_SERVICE_ROLE_KEY not configured\");\n        }\n        supabaseServerInstance = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://mrwitpgbcaxgnirqtavt.supabase.co\", serviceKey, {\n            auth: {\n                autoRefreshToken: false,\n                persistSession: false\n            }\n        });\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Created dedicated server Supabase client\");\n    }\n    return supabaseServerInstance;\n};\n// Test database connection\nconst testSupabaseConnection = async ()=>{\n    try {\n        const client = getSupabaseClient();\n        const { data, error } = await client.from(\"translations\").select(\"*\").limit(1);\n        if (error) {\n            (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Supabase connection test failed\", {\n                error: error.message\n            });\n            return false;\n        }\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Supabase connection test successful\");\n        return true;\n    } catch (error) {\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Supabase connection test error\", {\n            error: error.message\n        });\n        return false;\n    }\n};\n/**\n * Memory-optimized database query wrapper\n */ const executeOptimizedQuery = async (queryFn, queryName = \"unknown\")=>{\n    const startTime = Date.now();\n    connectionPool.activeConnections++;\n    connectionPool.totalQueries++;\n    // Track peak connections for monitoring\n    if (connectionPool.activeConnections > connectionPool.peakConnections) {\n        connectionPool.peakConnections = connectionPool.activeConnections;\n    }\n    try {\n        // Check if we need cleanup\n        if (Date.now() - connectionPool.lastCleanup > 300000) {\n            cleanupConnections();\n        }\n        const result = await queryFn();\n        const duration = Date.now() - startTime;\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(`Optimized query executed: ${queryName}`, {\n            duration: `${duration}ms`,\n            activeConnections: connectionPool.activeConnections,\n            peakConnections: connectionPool.peakConnections\n        });\n        return result;\n    } catch (error) {\n        (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(`Optimized query failed: ${queryName}`, {\n            error: error.message,\n            duration: `${Date.now() - startTime}ms`\n        });\n        throw error;\n    } finally{\n        connectionPool.activeConnections--;\n    }\n};\n/**\n * Clean up connection pool\n */ const cleanupConnections = ()=>{\n    (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Cleaning up Supabase connection pool\", {\n        activeConnections: connectionPool.activeConnections,\n        queueSize: connectionPool.connectionQueue.length\n    });\n    // Reset connection tracking\n    connectionPool.activeConnections = Math.max(0, connectionPool.activeConnections);\n    connectionPool.connectionQueue = connectionPool.connectionQueue.filter((conn)=>Date.now() - conn.created < 300000 // 5 minutes\n    );\n    connectionPool.lastCleanup = Date.now();\n};\n/**\n * Get connection pool statistics\n */ const getConnectionStats = ()=>{\n    return {\n        activeConnections: connectionPool.activeConnections,\n        maxConnections: connectionPool.maxConnections,\n        peakConnections: connectionPool.peakConnections,\n        totalQueries: connectionPool.totalQueries,\n        queueSize: connectionPool.connectionQueue.length,\n        lastCleanup: new Date(connectionPool.lastCleanup).toISOString(),\n        utilizationPercent: Math.round(connectionPool.activeConnections / connectionPool.maxConnections * 100),\n        status: connectionPool.activeConnections < connectionPool.maxConnections * 0.8 ? \"healthy\" : \"high_load\"\n    };\n};\n/**\n * Graceful shutdown - cleanup all connections\n */ const shutdownConnections = ()=>{\n    (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Shutting down all Supabase connections\");\n    supabaseInstance = null;\n    supabaseServerInstance = null;\n    connectionPool.activeConnections = 0;\n    connectionPool.connectionQueue = [];\n    (0,_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"All Supabase connections shut down successfully\");\n};\n// Register shutdown handler\nconst memoryOptimizer = (0,_memory_optimizer_js__WEBPACK_IMPORTED_MODULE_2__.getMemoryOptimizer)();\nmemoryOptimizer.registerCleanup(\"supabase-connections\", shutdownConnections);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (getSupabaseClient);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dXBhYmFzZS1jbGllbnQuanM/MDkzMiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNIQVJFRCBTVVBBQkFTRSBDTElFTlQgV0lUSCBTRVJWRVIvQ0xJRU5UIFNFUEFSQVRJT05cbiAqIEVuc3VyZXMgc2VydmljZSBrZXlzIGFyZSBORVZFUiBleHBvc2VkIGNsaWVudC1zaWRlXG4gKiBTaW5nbGUgaW5zdGFuY2UgcGF0dGVybiB0byBhdm9pZCBjb25mbGljdHNcbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXG5pbXBvcnQgeyBsb2dJbmZvLCBsb2dFcnJvciB9IGZyb20gJy4vcHJvZHVjdGlvbi1sb2dnZXIuanMnXG5pbXBvcnQgeyBnZXRNZW1vcnlPcHRpbWl6ZXIgfSBmcm9tICcuL21lbW9yeS1vcHRpbWl6ZXIuanMnXG5cbmxldCBzdXBhYmFzZUluc3RhbmNlID0gbnVsbFxubGV0IHN1cGFiYXNlU2VydmVySW5zdGFuY2UgPSBudWxsXG5sZXQgY29ubmVjdGlvblBvb2wgPSB7XG4gIGFjdGl2ZUNvbm5lY3Rpb25zOiAwLFxuICBtYXhDb25uZWN0aW9uczogNTAsIC8vIFNjYWxlZCBmb3IgcHJvZHVjdGlvbiBjb25jdXJyZW50IHVzZXJzXG4gIGNvbm5lY3Rpb25RdWV1ZTogW10sXG4gIGxhc3RDbGVhbnVwOiBEYXRlLm5vdygpLFxuICBwZWFrQ29ubmVjdGlvbnM6IDAsXG4gIHRvdGFsUXVlcmllczogMFxufVxuXG4vKipcbiAqIEdldCBTdXBhYmFzZSBjbGllbnQgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnZpcm9ubWVudFxuICogQ2xpZW50LXNpZGU6IFVzZXMgYW5vbnltb3VzIGtleSAoc2FmZSBmb3IgYnJvd3NlcilcbiAqIFNlcnZlci1zaWRlOiBVc2VzIHNlcnZpY2Ugcm9sZSBrZXkgKG5ldmVyIGV4cG9zZWQgdG8gYnJvd3NlcilcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFN1cGFiYXNlQ2xpZW50ID0gKCkgPT4ge1xuICAvLyBDaGVjayBpZiB3ZSdyZSBvbiB0aGUgc2VydmVyIG9yIGNsaWVudFxuICBjb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnXG4gIFxuICBpZiAoaXNTZXJ2ZXIpIHtcbiAgICAvLyBTRVJWRVItU0lERTogVXNlIHNlcnZpY2Ugcm9sZSBrZXkgZm9yIGZ1bGwgYWNjZXNzXG4gICAgaWYgKCFzdXBhYmFzZVNlcnZlckluc3RhbmNlKSB7XG4gICAgICBjb25zdCBzZXJ2aWNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWVxuICAgICAgaWYgKCFzZXJ2aWNlS2V5KSB7XG4gICAgICAgIGxvZ0Vycm9yKCdTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIG5vdCBmb3VuZCBpbiBzZXJ2ZXIgZW52aXJvbm1lbnQnKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NlcnZlciBjb25maWd1cmF0aW9uIGVycm9yOiBNaXNzaW5nIHNlcnZpY2Uga2V5JylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3VwYWJhc2VTZXJ2ZXJJbnN0YW5jZSA9IGNyZWF0ZUNsaWVudChcbiAgICAgICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMLFxuICAgICAgICBzZXJ2aWNlS2V5LFxuICAgICAgICB7XG4gICAgICAgICAgYXV0aDoge1xuICAgICAgICAgICAgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UsXG4gICAgICAgICAgICBwZXJzaXN0U2Vzc2lvbjogZmFsc2VcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRiOiB7XG4gICAgICAgICAgICBzY2hlbWE6ICdwdWJsaWMnXG4gICAgICAgICAgfSxcbiAgICAgICAgICBnbG9iYWw6IHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnVHJpYW5nbGUtSW50ZWxsaWdlbmNlLVBsYXRmb3JtLzEuMCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIClcbiAgICAgIFxuICAgICAgLy8gUmVnaXN0ZXIgY2xlYW51cCB3aXRoIG1lbW9yeSBvcHRpbWl6ZXJcbiAgICAgIGNvbnN0IG1lbW9yeU9wdGltaXplciA9IGdldE1lbW9yeU9wdGltaXplcigpXG4gICAgICBtZW1vcnlPcHRpbWl6ZXIucmVnaXN0ZXJDbGVhbnVwKCdzdXBhYmFzZS1zZXJ2ZXItY2xpZW50JywgKCkgPT4ge1xuICAgICAgICBpZiAoc3VwYWJhc2VTZXJ2ZXJJbnN0YW5jZSkge1xuICAgICAgICAgIGxvZ0luZm8oJ0NsZWFuaW5nIHVwIFN1cGFiYXNlIHNlcnZlciBjb25uZWN0aW9ucycpXG4gICAgICAgICAgc3VwYWJhc2VTZXJ2ZXJJbnN0YW5jZSA9IG51bGxcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgbG9nSW5mbygnQ3JlYXRlZCBzZXJ2ZXItc2lkZSBTdXBhYmFzZSBjbGllbnQgd2l0aCBzZXJ2aWNlIHJvbGUgYW5kIG1lbW9yeSBvcHRpbWl6YXRpb24nKVxuICAgIH1cbiAgICByZXR1cm4gc3VwYWJhc2VTZXJ2ZXJJbnN0YW5jZVxuICB9IGVsc2Uge1xuICAgIC8vIENMSUVOVC1TSURFOiBVc2UgYW5vbnltb3VzIGtleSBvbmx5XG4gICAgaWYgKCFzdXBhYmFzZUluc3RhbmNlKSB7XG4gICAgICBjb25zdCBhbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVlcbiAgICAgIGlmICghYW5vbktleSkge1xuICAgICAgICBsb2dFcnJvcignTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgbm90IGZvdW5kJylcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDbGllbnQgY29uZmlndXJhdGlvbiBlcnJvcjogTWlzc2luZyBhbm9ueW1vdXMga2V5JylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3VwYWJhc2VJbnN0YW5jZSA9IGNyZWF0ZUNsaWVudChcbiAgICAgICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMLFxuICAgICAgICBhbm9uS2V5XG4gICAgICApXG4gICAgICBsb2dJbmZvKCdDcmVhdGVkIGNsaWVudC1zaWRlIFN1cGFiYXNlIGNsaWVudCB3aXRoIGFub255bW91cyBrZXknKVxuICAgIH1cbiAgICByZXR1cm4gc3VwYWJhc2VJbnN0YW5jZVxuICB9XG59XG5cbi8qKlxuICogR2V0IHNlcnZlci1vbmx5IFN1cGFiYXNlIGNsaWVudCB3aXRoIHNlcnZpY2Ugcm9sZVxuICogQ1JJVElDQUw6IE9ubHkgdXNlIGluIEFQSSByb3V0ZXMsIG5ldmVyIGluIGNvbXBvbmVudHNcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFNlcnZlclN1cGFiYXNlQ2xpZW50ID0gKCkgPT4ge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NFQ1VSSVRZIFZJT0xBVElPTjogQXR0ZW1wdGVkIHRvIHVzZSBzZXJ2ZXIgY2xpZW50IG9uIGNsaWVudC1zaWRlJylcbiAgfVxuICBcbiAgaWYgKCFzdXBhYmFzZVNlcnZlckluc3RhbmNlKSB7XG4gICAgY29uc3Qgc2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVlcbiAgICBpZiAoIXNlcnZpY2VLZXkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSBub3QgY29uZmlndXJlZCcpXG4gICAgfVxuICAgIFxuICAgIHN1cGFiYXNlU2VydmVySW5zdGFuY2UgPSBjcmVhdGVDbGllbnQoXG4gICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwsXG4gICAgICBzZXJ2aWNlS2V5LFxuICAgICAge1xuICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UsXG4gICAgICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApXG4gICAgbG9nSW5mbygnQ3JlYXRlZCBkZWRpY2F0ZWQgc2VydmVyIFN1cGFiYXNlIGNsaWVudCcpXG4gIH1cbiAgcmV0dXJuIHN1cGFiYXNlU2VydmVySW5zdGFuY2Vcbn1cblxuLy8gVGVzdCBkYXRhYmFzZSBjb25uZWN0aW9uXG5leHBvcnQgY29uc3QgdGVzdFN1cGFiYXNlQ29ubmVjdGlvbiA9IGFzeW5jICgpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjbGllbnQgPSBnZXRTdXBhYmFzZUNsaWVudCgpXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgY2xpZW50LmZyb20oJ3RyYW5zbGF0aW9ucycpLnNlbGVjdCgnKicpLmxpbWl0KDEpXG4gICAgXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBsb2dFcnJvcignU3VwYWJhc2UgY29ubmVjdGlvbiB0ZXN0IGZhaWxlZCcsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSlcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICBcbiAgICBsb2dJbmZvKCdTdXBhYmFzZSBjb25uZWN0aW9uIHRlc3Qgc3VjY2Vzc2Z1bCcpXG4gICAgcmV0dXJuIHRydWVcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dFcnJvcignU3VwYWJhc2UgY29ubmVjdGlvbiB0ZXN0IGVycm9yJywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KVxuICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbi8qKlxuICogTWVtb3J5LW9wdGltaXplZCBkYXRhYmFzZSBxdWVyeSB3cmFwcGVyXG4gKi9cbmV4cG9ydCBjb25zdCBleGVjdXRlT3B0aW1pemVkUXVlcnkgPSBhc3luYyAocXVlcnlGbiwgcXVlcnlOYW1lID0gJ3Vua25vd24nKSA9PiB7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KClcbiAgY29ubmVjdGlvblBvb2wuYWN0aXZlQ29ubmVjdGlvbnMrK1xuICBjb25uZWN0aW9uUG9vbC50b3RhbFF1ZXJpZXMrK1xuICBcbiAgLy8gVHJhY2sgcGVhayBjb25uZWN0aW9ucyBmb3IgbW9uaXRvcmluZ1xuICBpZiAoY29ubmVjdGlvblBvb2wuYWN0aXZlQ29ubmVjdGlvbnMgPiBjb25uZWN0aW9uUG9vbC5wZWFrQ29ubmVjdGlvbnMpIHtcbiAgICBjb25uZWN0aW9uUG9vbC5wZWFrQ29ubmVjdGlvbnMgPSBjb25uZWN0aW9uUG9vbC5hY3RpdmVDb25uZWN0aW9uc1xuICB9XG4gIFxuICB0cnkge1xuICAgIC8vIENoZWNrIGlmIHdlIG5lZWQgY2xlYW51cFxuICAgIGlmIChEYXRlLm5vdygpIC0gY29ubmVjdGlvblBvb2wubGFzdENsZWFudXAgPiAzMDAwMDApIHsgLy8gNSBtaW51dGVzXG4gICAgICBjbGVhbnVwQ29ubmVjdGlvbnMoKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeUZuKClcbiAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWVcbiAgICBcbiAgICBsb2dJbmZvKGBPcHRpbWl6ZWQgcXVlcnkgZXhlY3V0ZWQ6ICR7cXVlcnlOYW1lfWAsIHsgXG4gICAgICBkdXJhdGlvbjogYCR7ZHVyYXRpb259bXNgLFxuICAgICAgYWN0aXZlQ29ubmVjdGlvbnM6IGNvbm5lY3Rpb25Qb29sLmFjdGl2ZUNvbm5lY3Rpb25zLFxuICAgICAgcGVha0Nvbm5lY3Rpb25zOiBjb25uZWN0aW9uUG9vbC5wZWFrQ29ubmVjdGlvbnNcbiAgICB9KVxuICAgIFxuICAgIHJldHVybiByZXN1bHRcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dFcnJvcihgT3B0aW1pemVkIHF1ZXJ5IGZhaWxlZDogJHtxdWVyeU5hbWV9YCwgeyBcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgZHVyYXRpb246IGAke0RhdGUubm93KCkgLSBzdGFydFRpbWV9bXNgXG4gICAgfSlcbiAgICB0aHJvdyBlcnJvclxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb25Qb29sLmFjdGl2ZUNvbm5lY3Rpb25zLS1cbiAgfVxufVxuXG4vKipcbiAqIENsZWFuIHVwIGNvbm5lY3Rpb24gcG9vbFxuICovXG5jb25zdCBjbGVhbnVwQ29ubmVjdGlvbnMgPSAoKSA9PiB7XG4gIGxvZ0luZm8oJ0NsZWFuaW5nIHVwIFN1cGFiYXNlIGNvbm5lY3Rpb24gcG9vbCcsIHtcbiAgICBhY3RpdmVDb25uZWN0aW9uczogY29ubmVjdGlvblBvb2wuYWN0aXZlQ29ubmVjdGlvbnMsXG4gICAgcXVldWVTaXplOiBjb25uZWN0aW9uUG9vbC5jb25uZWN0aW9uUXVldWUubGVuZ3RoXG4gIH0pXG4gIFxuICAvLyBSZXNldCBjb25uZWN0aW9uIHRyYWNraW5nXG4gIGNvbm5lY3Rpb25Qb29sLmFjdGl2ZUNvbm5lY3Rpb25zID0gTWF0aC5tYXgoMCwgY29ubmVjdGlvblBvb2wuYWN0aXZlQ29ubmVjdGlvbnMpXG4gIGNvbm5lY3Rpb25Qb29sLmNvbm5lY3Rpb25RdWV1ZSA9IGNvbm5lY3Rpb25Qb29sLmNvbm5lY3Rpb25RdWV1ZS5maWx0ZXIoXG4gICAgY29ubiA9PiBEYXRlLm5vdygpIC0gY29ubi5jcmVhdGVkIDwgMzAwMDAwIC8vIDUgbWludXRlc1xuICApXG4gIGNvbm5lY3Rpb25Qb29sLmxhc3RDbGVhbnVwID0gRGF0ZS5ub3coKVxufVxuXG4vKipcbiAqIEdldCBjb25uZWN0aW9uIHBvb2wgc3RhdGlzdGljc1xuICovXG5leHBvcnQgY29uc3QgZ2V0Q29ubmVjdGlvblN0YXRzID0gKCkgPT4ge1xuICByZXR1cm4ge1xuICAgIGFjdGl2ZUNvbm5lY3Rpb25zOiBjb25uZWN0aW9uUG9vbC5hY3RpdmVDb25uZWN0aW9ucyxcbiAgICBtYXhDb25uZWN0aW9uczogY29ubmVjdGlvblBvb2wubWF4Q29ubmVjdGlvbnMsXG4gICAgcGVha0Nvbm5lY3Rpb25zOiBjb25uZWN0aW9uUG9vbC5wZWFrQ29ubmVjdGlvbnMsXG4gICAgdG90YWxRdWVyaWVzOiBjb25uZWN0aW9uUG9vbC50b3RhbFF1ZXJpZXMsXG4gICAgcXVldWVTaXplOiBjb25uZWN0aW9uUG9vbC5jb25uZWN0aW9uUXVldWUubGVuZ3RoLFxuICAgIGxhc3RDbGVhbnVwOiBuZXcgRGF0ZShjb25uZWN0aW9uUG9vbC5sYXN0Q2xlYW51cCkudG9JU09TdHJpbmcoKSxcbiAgICB1dGlsaXphdGlvblBlcmNlbnQ6IE1hdGgucm91bmQoKGNvbm5lY3Rpb25Qb29sLmFjdGl2ZUNvbm5lY3Rpb25zIC8gY29ubmVjdGlvblBvb2wubWF4Q29ubmVjdGlvbnMpICogMTAwKSxcbiAgICBzdGF0dXM6IGNvbm5lY3Rpb25Qb29sLmFjdGl2ZUNvbm5lY3Rpb25zIDwgY29ubmVjdGlvblBvb2wubWF4Q29ubmVjdGlvbnMgKiAwLjggPyAnaGVhbHRoeScgOiAnaGlnaF9sb2FkJ1xuICB9XG59XG5cbi8qKlxuICogR3JhY2VmdWwgc2h1dGRvd24gLSBjbGVhbnVwIGFsbCBjb25uZWN0aW9uc1xuICovXG5leHBvcnQgY29uc3Qgc2h1dGRvd25Db25uZWN0aW9ucyA9ICgpID0+IHtcbiAgbG9nSW5mbygnU2h1dHRpbmcgZG93biBhbGwgU3VwYWJhc2UgY29ubmVjdGlvbnMnKVxuICBcbiAgc3VwYWJhc2VJbnN0YW5jZSA9IG51bGxcbiAgc3VwYWJhc2VTZXJ2ZXJJbnN0YW5jZSA9IG51bGxcbiAgY29ubmVjdGlvblBvb2wuYWN0aXZlQ29ubmVjdGlvbnMgPSAwXG4gIGNvbm5lY3Rpb25Qb29sLmNvbm5lY3Rpb25RdWV1ZSA9IFtdXG4gIFxuICBsb2dJbmZvKCdBbGwgU3VwYWJhc2UgY29ubmVjdGlvbnMgc2h1dCBkb3duIHN1Y2Nlc3NmdWxseScpXG59XG5cbi8vIFJlZ2lzdGVyIHNodXRkb3duIGhhbmRsZXJcbmNvbnN0IG1lbW9yeU9wdGltaXplciA9IGdldE1lbW9yeU9wdGltaXplcigpXG5tZW1vcnlPcHRpbWl6ZXIucmVnaXN0ZXJDbGVhbnVwKCdzdXBhYmFzZS1jb25uZWN0aW9ucycsIHNodXRkb3duQ29ubmVjdGlvbnMpXG5cbmV4cG9ydCBkZWZhdWx0IGdldFN1cGFiYXNlQ2xpZW50Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImxvZ0luZm8iLCJsb2dFcnJvciIsImdldE1lbW9yeU9wdGltaXplciIsInN1cGFiYXNlSW5zdGFuY2UiLCJzdXBhYmFzZVNlcnZlckluc3RhbmNlIiwiY29ubmVjdGlvblBvb2wiLCJhY3RpdmVDb25uZWN0aW9ucyIsIm1heENvbm5lY3Rpb25zIiwiY29ubmVjdGlvblF1ZXVlIiwibGFzdENsZWFudXAiLCJEYXRlIiwibm93IiwicGVha0Nvbm5lY3Rpb25zIiwidG90YWxRdWVyaWVzIiwiZ2V0U3VwYWJhc2VDbGllbnQiLCJpc1NlcnZlciIsInNlcnZpY2VLZXkiLCJwcm9jZXNzIiwiZW52IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsIkVycm9yIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiIsImRiIiwic2NoZW1hIiwiZ2xvYmFsIiwiaGVhZGVycyIsIm1lbW9yeU9wdGltaXplciIsInJlZ2lzdGVyQ2xlYW51cCIsImFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImdldFNlcnZlclN1cGFiYXNlQ2xpZW50IiwidGVzdFN1cGFiYXNlQ29ubmVjdGlvbiIsImNsaWVudCIsImRhdGEiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJsaW1pdCIsIm1lc3NhZ2UiLCJleGVjdXRlT3B0aW1pemVkUXVlcnkiLCJxdWVyeUZuIiwicXVlcnlOYW1lIiwic3RhcnRUaW1lIiwiY2xlYW51cENvbm5lY3Rpb25zIiwicmVzdWx0IiwiZHVyYXRpb24iLCJxdWV1ZVNpemUiLCJsZW5ndGgiLCJNYXRoIiwibWF4IiwiZmlsdGVyIiwiY29ubiIsImNyZWF0ZWQiLCJnZXRDb25uZWN0aW9uU3RhdHMiLCJ0b0lTT1N0cmluZyIsInV0aWxpemF0aW9uUGVyY2VudCIsInJvdW5kIiwic3RhdHVzIiwic2h1dGRvd25Db25uZWN0aW9ucyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/supabase-client.js\n");

/***/ }),

/***/ "(api)/./lib/utils/environment-validation.js":
/*!*********************************************!*\
  !*** ./lib/utils/environment-validation.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getEnvVar: () => (/* binding */ getEnvVar),\n/* harmony export */   getSecurityStatus: () => (/* binding */ getSecurityStatus),\n/* harmony export */   getSupabaseConfig: () => (/* binding */ getSupabaseConfig),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   safeLog: () => (/* binding */ safeLog),\n/* harmony export */   validateAPIKeysSecurity: () => (/* binding */ validateAPIKeysSecurity),\n/* harmony export */   validateEnvironment: () => (/* binding */ validateEnvironment),\n/* harmony export */   validateSecretSecurity: () => (/* binding */ validateSecretSecurity)\n/* harmony export */ });\n/**\n * Environment Variable Validation and Configuration\n * Centralized validation for production readiness\n */ // Required environment variables for production\n// Split by client/server because client can't see server-only vars\nconst CLIENT_REQUIRED_ENV_VARS = [\n    \"NEXT_PUBLIC_SUPABASE_URL\",\n    \"NEXT_PUBLIC_SUPABASE_ANON_KEY\"\n];\nconst SERVER_REQUIRED_ENV_VARS = [\n    \"NEXT_PUBLIC_SUPABASE_URL\",\n    \"NEXT_PUBLIC_SUPABASE_ANON_KEY\",\n    \"SUPABASE_SERVICE_ROLE_KEY\",\n    \"JWT_SECRET\",\n    \"NEXTAUTH_SECRET\"\n];\nconst SERVER_RECOMMENDED_ENV_VARS = [\n    \"ANTHROPIC_API_KEY\",\n    \"COMTRADE_API_KEY\",\n    \"SHIPPO_API_KEY\",\n    \"STRIPE_SECRET_KEY\"\n];\n// Optional environment variables with defaults\nconst OPTIONAL_ENV_VARS = {\n    NODE_ENV: \"development\",\n    NEXT_PUBLIC_APP_URL: \"http://localhost:3000\"\n};\n/**\n * Validate all required environment variables are present\n * @throws {Error} If any required variable is missing\n */ function validateEnvironment() {\n    // Skip validation entirely on client-side to avoid errors\n    if (false) {}\n    // Server-side validation\n    const missing = SERVER_REQUIRED_ENV_VARS.filter((key)=>!process.env[key]);\n    if (missing.length > 0) {\n        throw new Error(`Missing required server-side environment variables: ${missing.join(\", \")}`);\n    }\n    // Note: Using console.log here as this runs before logger is initialized\n    console.log(\"✅ All required environment variables are present\");\n}\n/**\n * Get environment variable with validation\n * @param {string} key - Environment variable key\n * @param {boolean} required - Whether the variable is required\n * @returns {string} Environment variable value\n */ function getEnvVar(key, required = true) {\n    const value = process.env[key];\n    if (required && !value) {\n        throw new Error(`Missing required environment variable: ${key}`);\n    }\n    return value || OPTIONAL_ENV_VARS[key];\n}\n/**\n * Check if running in production\n */ function isProduction() {\n    return \"development\" === \"production\";\n}\n/**\n * Check if running in development\n */ function isDevelopment() {\n    return \"development\" === \"development\";\n}\n/**\n * Safe logging that respects environment\n * Only logs in development unless force is true\n */ function safeLog(message, data = null, force = false) {\n    if (isDevelopment() || force) {\n        if (data) {\n            // Note: Using console.log here as this is used for bootstrap logging\n            console.log(message, data);\n        } else {\n            console.log(message);\n        }\n    }\n}\n/**\n * Get Supabase configuration based on environment\n */ function getSupabaseConfig() {\n    const url = getEnvVar(\"NEXT_PUBLIC_SUPABASE_URL\");\n    // Use service role key on server, anon key on client\n    const key =  false ? 0 : getEnvVar(\"SUPABASE_SERVICE_ROLE_KEY\", false) || getEnvVar(\"NEXT_PUBLIC_SUPABASE_ANON_KEY\");\n    return {\n        url,\n        key\n    };\n}\n/**\n * Validate API keys are not exposed and check for security issues\n */ function validateAPIKeysSecurity() {\n    const sensitiveKeys = [\n        \"SUPABASE_SERVICE_ROLE_KEY\",\n        \"ANTHROPIC_API_KEY\",\n        \"STRIPE_SECRET_KEY\",\n        \"COMTRADE_API_KEY\",\n        \"SHIPPO_API_KEY\",\n        \"JWT_SECRET\",\n        \"NEXTAUTH_SECRET\",\n        \"ENTERPRISE_MASTER_KEY\"\n    ];\n    if (false) {}\n}\n/**\n * Check for dangerous default/template values\n */ function validateSecretSecurity() {\n    const dangerousPatterns = [\n        {\n            key: \"JWT_SECRET\",\n            patterns: [\n                \"your-super-secure\",\n                \"generate-new\",\n                \"REPLACE_WITH\"\n            ]\n        },\n        {\n            key: \"NEXTAUTH_SECRET\",\n            patterns: [\n                \"your-nextauth-secret\",\n                \"generate-new\",\n                \"REPLACE_WITH\"\n            ]\n        },\n        {\n            key: \"ENTERPRISE_MASTER_KEY\",\n            patterns: [\n                \"triangle-intelligence-enterprise\",\n                \"generate-new\",\n                \"REPLACE_WITH\"\n            ]\n        },\n        {\n            key: \"ANTHROPIC_API_KEY\",\n            patterns: [\n                \"your-key-here\",\n                \"REPLACE_WITH\"\n            ]\n        }\n    ];\n    const warnings = [];\n    dangerousPatterns.forEach(({ key, patterns })=>{\n        if (process.env[key]) {\n            patterns.forEach((pattern)=>{\n                if (process.env[key].includes(pattern)) {\n                    warnings.push(`${key} appears to use default/template value`);\n                }\n            });\n        }\n    });\n    // Check secret strength\n    if (process.env.JWT_SECRET && process.env.JWT_SECRET.length < 32) {\n        warnings.push(\"JWT_SECRET is too short (minimum 32 characters)\");\n    }\n    return warnings;\n}\n/**\n * Get comprehensive security status\n */ function getSecurityStatus() {\n    const warnings = validateSecretSecurity();\n    const requiredMissing = SERVER_REQUIRED_ENV_VARS.filter((key)=>!process.env[key]);\n    const recommendedMissing = SERVER_RECOMMENDED_ENV_VARS.filter((key)=>!process.env[key]);\n    return {\n        status: requiredMissing.length === 0 && warnings.length === 0 ? \"secure\" : \"needs_attention\",\n        requiredMissing,\n        recommendedMissing,\n        securityWarnings: warnings,\n        lastChecked: new Date().toISOString()\n    };\n}\n// Auto-validate on import in development (SERVER-SIDE ONLY)\nif (isDevelopment() && \"undefined\" === \"undefined\") {\n    try {\n        validateEnvironment();\n        validateAPIKeysSecurity();\n    } catch (error) {\n        // Note: Using console.error here as this is critical bootstrap error\n        console.error(\"❌ Environment validation failed:\", error.message);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvdXRpbHMvZW52aXJvbm1lbnQtdmFsaWRhdGlvbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTs7O0NBR0MsR0FFRCxnREFBZ0Q7QUFDaEQsbUVBQW1FO0FBQ25FLE1BQU1BLDJCQUEyQjtJQUMvQjtJQUNBO0NBQ0Q7QUFFRCxNQUFNQywyQkFBMkI7SUFDL0I7SUFDQTtJQUNBO0lBQ0E7SUFDQTtDQUNEO0FBRUQsTUFBTUMsOEJBQThCO0lBQ2xDO0lBQ0E7SUFDQTtJQUNBO0NBQ0Q7QUFFRCwrQ0FBK0M7QUFDL0MsTUFBTUMsb0JBQW9CO0lBQ3hCQyxVQUFVO0lBQ1ZDLHFCQUFxQjtBQUN2QjtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNDO0lBQ2QsMERBQTBEO0lBQzFELElBQUksS0FBa0IsRUFBYSxFQUdsQztJQUVELHlCQUF5QjtJQUN6QixNQUFNRyxVQUFVUix5QkFBeUJTLE1BQU0sQ0FBQ0MsQ0FBQUEsTUFBTyxDQUFDQyxRQUFRQyxHQUFHLENBQUNGLElBQUk7SUFFeEUsSUFBSUYsUUFBUUssTUFBTSxHQUFHLEdBQUc7UUFDdEIsTUFBTSxJQUFJQyxNQUFNLENBQUMsb0RBQW9ELEVBQUVOLFFBQVFPLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDN0Y7SUFFQSx5RUFBeUU7SUFDekVULFFBQVFDLEdBQUcsQ0FBQztBQUNkO0FBRUE7Ozs7O0NBS0MsR0FDTSxTQUFTUyxVQUFVTixHQUFHLEVBQUVPLFdBQVcsSUFBSTtJQUM1QyxNQUFNQyxRQUFRUCxRQUFRQyxHQUFHLENBQUNGLElBQUk7SUFFOUIsSUFBSU8sWUFBWSxDQUFDQyxPQUFPO1FBQ3RCLE1BQU0sSUFBSUosTUFBTSxDQUFDLHVDQUF1QyxFQUFFSixJQUFJLENBQUM7SUFDakU7SUFFQSxPQUFPUSxTQUFTaEIsaUJBQWlCLENBQUNRLElBQUk7QUFDeEM7QUFFQTs7Q0FFQyxHQUNNLFNBQVNTO0lBQ2QsT0FBT1Isa0JBQXlCO0FBQ2xDO0FBRUE7O0NBRUMsR0FDTSxTQUFTUztJQUNkLE9BQU9ULGtCQUF5QjtBQUNsQztBQUVBOzs7Q0FHQyxHQUNNLFNBQVNVLFFBQVFDLE9BQU8sRUFBRUMsT0FBTyxJQUFJLEVBQUVDLFFBQVEsS0FBSztJQUN6RCxJQUFJSixtQkFBbUJJLE9BQU87UUFDNUIsSUFBSUQsTUFBTTtZQUNSLHFFQUFxRTtZQUNyRWpCLFFBQVFDLEdBQUcsQ0FBQ2UsU0FBU0M7UUFDdkIsT0FBTztZQUNMakIsUUFBUUMsR0FBRyxDQUFDZTtRQUNkO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sU0FBU0c7SUFDZCxNQUFNQyxNQUFNVixVQUFVO0lBRXRCLHFEQUFxRDtJQUNyRCxNQUFNTixNQUFNLE1BQWtCLEdBQzFCTSxDQUFVLEdBQ1ZBLFVBQVUsNkJBQTZCLFVBQVVBLFVBQVU7SUFFL0QsT0FBTztRQUFFVTtRQUFLaEI7SUFBSTtBQUNwQjtBQUVBOztDQUVDLEdBQ00sU0FBU2lCO0lBQ2QsTUFBTUMsZ0JBQWdCO1FBQ3BCO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUVELElBQUksS0FBa0IsRUFBYSxFQU9sQztBQUNIO0FBRUE7O0NBRUMsR0FDTSxTQUFTRztJQUNkLE1BQU1DLG9CQUFvQjtRQUN4QjtZQUFFdEIsS0FBSztZQUFjdUIsVUFBVTtnQkFBQztnQkFBcUI7Z0JBQWdCO2FBQWU7UUFBQztRQUNyRjtZQUFFdkIsS0FBSztZQUFtQnVCLFVBQVU7Z0JBQUM7Z0JBQXdCO2dCQUFnQjthQUFlO1FBQUM7UUFDN0Y7WUFBRXZCLEtBQUs7WUFBeUJ1QixVQUFVO2dCQUFDO2dCQUFvQztnQkFBZ0I7YUFBZTtRQUFDO1FBQy9HO1lBQUV2QixLQUFLO1lBQXFCdUIsVUFBVTtnQkFBQztnQkFBaUI7YUFBZTtRQUFDO0tBQ3pFO0lBRUQsTUFBTUMsV0FBVyxFQUFFO0lBRW5CRixrQkFBa0JHLE9BQU8sQ0FBQyxDQUFDLEVBQUV6QixHQUFHLEVBQUV1QixRQUFRLEVBQUU7UUFDMUMsSUFBSXRCLFFBQVFDLEdBQUcsQ0FBQ0YsSUFBSSxFQUFFO1lBQ3BCdUIsU0FBU0UsT0FBTyxDQUFDQyxDQUFBQTtnQkFDZixJQUFJekIsUUFBUUMsR0FBRyxDQUFDRixJQUFJLENBQUMyQixRQUFRLENBQUNELFVBQVU7b0JBQ3RDRixTQUFTSSxJQUFJLENBQUMsQ0FBQyxFQUFFNUIsSUFBSSxzQ0FBc0MsQ0FBQztnQkFDOUQ7WUFDRjtRQUNGO0lBQ0Y7SUFFQSx3QkFBd0I7SUFDeEIsSUFBSUMsUUFBUUMsR0FBRyxDQUFDMkIsVUFBVSxJQUFJNUIsUUFBUUMsR0FBRyxDQUFDMkIsVUFBVSxDQUFDMUIsTUFBTSxHQUFHLElBQUk7UUFDaEVxQixTQUFTSSxJQUFJLENBQUM7SUFDaEI7SUFFQSxPQUFPSjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxTQUFTTTtJQUNkLE1BQU1OLFdBQVdIO0lBQ2pCLE1BQU1VLGtCQUFrQnpDLHlCQUF5QlMsTUFBTSxDQUFDQyxDQUFBQSxNQUFPLENBQUNDLFFBQVFDLEdBQUcsQ0FBQ0YsSUFBSTtJQUNoRixNQUFNZ0MscUJBQXFCekMsNEJBQTRCUSxNQUFNLENBQUNDLENBQUFBLE1BQU8sQ0FBQ0MsUUFBUUMsR0FBRyxDQUFDRixJQUFJO0lBRXRGLE9BQU87UUFDTGlDLFFBQVFGLGdCQUFnQjVCLE1BQU0sS0FBSyxLQUFLcUIsU0FBU3JCLE1BQU0sS0FBSyxJQUFJLFdBQVc7UUFDM0U0QjtRQUNBQztRQUNBRSxrQkFBa0JWO1FBQ2xCVyxhQUFhLElBQUlDLE9BQU9DLFdBQVc7SUFDckM7QUFDRjtBQUVBLDREQUE0RDtBQUM1RCxJQUFJM0IsbUJBQW1CLGdCQUFrQixhQUFhO0lBQ3BELElBQUk7UUFDRmY7UUFDQXNCO0lBQ0YsRUFBRSxPQUFPcUIsT0FBTztRQUNkLHFFQUFxRTtRQUNyRTFDLFFBQVEwQyxLQUFLLENBQUMsb0NBQW9DQSxNQUFNMUIsT0FBTztJQUNqRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJpYW5nbGUtaW50ZWxsaWdlbmNlLXBsYXRmb3JtLy4vbGliL3V0aWxzL2Vudmlyb25tZW50LXZhbGlkYXRpb24uanM/NzE3YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVudmlyb25tZW50IFZhcmlhYmxlIFZhbGlkYXRpb24gYW5kIENvbmZpZ3VyYXRpb25cbiAqIENlbnRyYWxpemVkIHZhbGlkYXRpb24gZm9yIHByb2R1Y3Rpb24gcmVhZGluZXNzXG4gKi9cblxuLy8gUmVxdWlyZWQgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciBwcm9kdWN0aW9uXG4vLyBTcGxpdCBieSBjbGllbnQvc2VydmVyIGJlY2F1c2UgY2xpZW50IGNhbid0IHNlZSBzZXJ2ZXItb25seSB2YXJzXG5jb25zdCBDTElFTlRfUkVRVUlSRURfRU5WX1ZBUlMgPSBbXG4gICdORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwnLFxuICAnTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVknXG5dXG5cbmNvbnN0IFNFUlZFUl9SRVFVSVJFRF9FTlZfVkFSUyA9IFtcbiAgJ05FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCcsXG4gICdORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWScsIFxuICAnU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWScsXG4gICdKV1RfU0VDUkVUJyxcbiAgJ05FWFRBVVRIX1NFQ1JFVCdcbl1cblxuY29uc3QgU0VSVkVSX1JFQ09NTUVOREVEX0VOVl9WQVJTID0gW1xuICAnQU5USFJPUElDX0FQSV9LRVknLFxuICAnQ09NVFJBREVfQVBJX0tFWScsIFxuICAnU0hJUFBPX0FQSV9LRVknLFxuICAnU1RSSVBFX1NFQ1JFVF9LRVknXG5dXG5cbi8vIE9wdGlvbmFsIGVudmlyb25tZW50IHZhcmlhYmxlcyB3aXRoIGRlZmF1bHRzXG5jb25zdCBPUFRJT05BTF9FTlZfVkFSUyA9IHtcbiAgTk9ERV9FTlY6ICdkZXZlbG9wbWVudCcsXG4gIE5FWFRfUFVCTElDX0FQUF9VUkw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnXG59XG5cbi8qKlxuICogVmFsaWRhdGUgYWxsIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgcHJlc2VudFxuICogQHRocm93cyB7RXJyb3J9IElmIGFueSByZXF1aXJlZCB2YXJpYWJsZSBpcyBtaXNzaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUVudmlyb25tZW50KCkge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZW50aXJlbHkgb24gY2xpZW50LXNpZGUgdG8gYXZvaWQgZXJyb3JzXG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIGNvbnNvbGUubG9nKCfinIUgRW52aXJvbm1lbnQgdmFsaWRhdGlvbiBza2lwcGVkIG9uIGNsaWVudC1zaWRlJylcbiAgICByZXR1cm5cbiAgfVxuICBcbiAgLy8gU2VydmVyLXNpZGUgdmFsaWRhdGlvblxuICBjb25zdCBtaXNzaW5nID0gU0VSVkVSX1JFUVVJUkVEX0VOVl9WQVJTLmZpbHRlcihrZXkgPT4gIXByb2Nlc3MuZW52W2tleV0pXG4gIFxuICBpZiAobWlzc2luZy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIHJlcXVpcmVkIHNlcnZlci1zaWRlIGVudmlyb25tZW50IHZhcmlhYmxlczogJHttaXNzaW5nLmpvaW4oJywgJyl9YClcbiAgfVxuICBcbiAgLy8gTm90ZTogVXNpbmcgY29uc29sZS5sb2cgaGVyZSBhcyB0aGlzIHJ1bnMgYmVmb3JlIGxvZ2dlciBpcyBpbml0aWFsaXplZFxuICBjb25zb2xlLmxvZygn4pyFIEFsbCByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIHByZXNlbnQnKVxufVxuXG4vKipcbiAqIEdldCBlbnZpcm9ubWVudCB2YXJpYWJsZSB3aXRoIHZhbGlkYXRpb25cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBFbnZpcm9ubWVudCB2YXJpYWJsZSBrZXlcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gcmVxdWlyZWQgLSBXaGV0aGVyIHRoZSB2YXJpYWJsZSBpcyByZXF1aXJlZFxuICogQHJldHVybnMge3N0cmluZ30gRW52aXJvbm1lbnQgdmFyaWFibGUgdmFsdWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVudlZhcihrZXksIHJlcXVpcmVkID0gdHJ1ZSkge1xuICBjb25zdCB2YWx1ZSA9IHByb2Nlc3MuZW52W2tleV1cbiAgXG4gIGlmIChyZXF1aXJlZCAmJiAhdmFsdWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgcmVxdWlyZWQgZW52aXJvbm1lbnQgdmFyaWFibGU6ICR7a2V5fWApXG4gIH1cbiAgXG4gIHJldHVybiB2YWx1ZSB8fCBPUFRJT05BTF9FTlZfVkFSU1trZXldXG59XG5cbi8qKlxuICogQ2hlY2sgaWYgcnVubmluZyBpbiBwcm9kdWN0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb2R1Y3Rpb24oKSB7XG4gIHJldHVybiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nXG59XG5cbi8qKlxuICogQ2hlY2sgaWYgcnVubmluZyBpbiBkZXZlbG9wbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNEZXZlbG9wbWVudCgpIHtcbiAgcmV0dXJuIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnXG59XG5cbi8qKlxuICogU2FmZSBsb2dnaW5nIHRoYXQgcmVzcGVjdHMgZW52aXJvbm1lbnRcbiAqIE9ubHkgbG9ncyBpbiBkZXZlbG9wbWVudCB1bmxlc3MgZm9yY2UgaXMgdHJ1ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2FmZUxvZyhtZXNzYWdlLCBkYXRhID0gbnVsbCwgZm9yY2UgPSBmYWxzZSkge1xuICBpZiAoaXNEZXZlbG9wbWVudCgpIHx8IGZvcmNlKSB7XG4gICAgaWYgKGRhdGEpIHtcbiAgICAgIC8vIE5vdGU6IFVzaW5nIGNvbnNvbGUubG9nIGhlcmUgYXMgdGhpcyBpcyB1c2VkIGZvciBib290c3RyYXAgbG9nZ2luZ1xuICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgZGF0YSlcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2cobWVzc2FnZSlcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgU3VwYWJhc2UgY29uZmlndXJhdGlvbiBiYXNlZCBvbiBlbnZpcm9ubWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3VwYWJhc2VDb25maWcoKSB7XG4gIGNvbnN0IHVybCA9IGdldEVudlZhcignTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMJylcbiAgXG4gIC8vIFVzZSBzZXJ2aWNlIHJvbGUga2V5IG9uIHNlcnZlciwgYW5vbiBrZXkgb24gY2xpZW50XG4gIGNvbnN0IGtleSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgPyBnZXRFbnZWYXIoJ05FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZJylcbiAgICA6IGdldEVudlZhcignU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWScsIGZhbHNlKSB8fCBnZXRFbnZWYXIoJ05FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZJylcbiAgXG4gIHJldHVybiB7IHVybCwga2V5IH1cbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSBBUEkga2V5cyBhcmUgbm90IGV4cG9zZWQgYW5kIGNoZWNrIGZvciBzZWN1cml0eSBpc3N1ZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQVBJS2V5c1NlY3VyaXR5KCkge1xuICBjb25zdCBzZW5zaXRpdmVLZXlzID0gW1xuICAgICdTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZJyxcbiAgICAnQU5USFJPUElDX0FQSV9LRVknLFxuICAgICdTVFJJUEVfU0VDUkVUX0tFWScsXG4gICAgJ0NPTVRSQURFX0FQSV9LRVknLFxuICAgICdTSElQUE9fQVBJX0tFWScsXG4gICAgJ0pXVF9TRUNSRVQnLFxuICAgICdORVhUQVVUSF9TRUNSRVQnLFxuICAgICdFTlRFUlBSSVNFX01BU1RFUl9LRVknXG4gIF1cbiAgXG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIENoZWNrIGlmIGFueSBzZW5zaXRpdmUga2V5cyBhcmUgYWNjZXNzaWJsZSBvbiBjbGllbnRcbiAgICBjb25zdCBleHBvc2VkS2V5cyA9IHNlbnNpdGl2ZUtleXMuZmlsdGVyKGtleSA9PiB3aW5kb3cucHJvY2Vzcz8uZW52Py5ba2V5XSlcbiAgICBcbiAgICBpZiAoZXhwb3NlZEtleXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBTRUNVUklUWSBWSU9MQVRJT046IFNlbnNpdGl2ZSBrZXlzIGV4cG9zZWQgdG8gY2xpZW50OiAke2V4cG9zZWRLZXlzLmpvaW4oJywgJyl9YClcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBmb3IgZGFuZ2Vyb3VzIGRlZmF1bHQvdGVtcGxhdGUgdmFsdWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVNlY3JldFNlY3VyaXR5KCkge1xuICBjb25zdCBkYW5nZXJvdXNQYXR0ZXJucyA9IFtcbiAgICB7IGtleTogJ0pXVF9TRUNSRVQnLCBwYXR0ZXJuczogWyd5b3VyLXN1cGVyLXNlY3VyZScsICdnZW5lcmF0ZS1uZXcnLCAnUkVQTEFDRV9XSVRIJ10gfSxcbiAgICB7IGtleTogJ05FWFRBVVRIX1NFQ1JFVCcsIHBhdHRlcm5zOiBbJ3lvdXItbmV4dGF1dGgtc2VjcmV0JywgJ2dlbmVyYXRlLW5ldycsICdSRVBMQUNFX1dJVEgnXSB9LFxuICAgIHsga2V5OiAnRU5URVJQUklTRV9NQVNURVJfS0VZJywgcGF0dGVybnM6IFsndHJpYW5nbGUtaW50ZWxsaWdlbmNlLWVudGVycHJpc2UnLCAnZ2VuZXJhdGUtbmV3JywgJ1JFUExBQ0VfV0lUSCddIH0sXG4gICAgeyBrZXk6ICdBTlRIUk9QSUNfQVBJX0tFWScsIHBhdHRlcm5zOiBbJ3lvdXIta2V5LWhlcmUnLCAnUkVQTEFDRV9XSVRIJ10gfVxuICBdXG5cbiAgY29uc3Qgd2FybmluZ3MgPSBbXVxuICBcbiAgZGFuZ2Vyb3VzUGF0dGVybnMuZm9yRWFjaCgoeyBrZXksIHBhdHRlcm5zIH0pID0+IHtcbiAgICBpZiAocHJvY2Vzcy5lbnZba2V5XSkge1xuICAgICAgcGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52W2tleV0uaW5jbHVkZXMocGF0dGVybikpIHtcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGAke2tleX0gYXBwZWFycyB0byB1c2UgZGVmYXVsdC90ZW1wbGF0ZSB2YWx1ZWApXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9KVxuXG4gIC8vIENoZWNrIHNlY3JldCBzdHJlbmd0aFxuICBpZiAocHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCAmJiBwcm9jZXNzLmVudi5KV1RfU0VDUkVULmxlbmd0aCA8IDMyKSB7XG4gICAgd2FybmluZ3MucHVzaCgnSldUX1NFQ1JFVCBpcyB0b28gc2hvcnQgKG1pbmltdW0gMzIgY2hhcmFjdGVycyknKVxuICB9XG5cbiAgcmV0dXJuIHdhcm5pbmdzXG59XG5cbi8qKlxuICogR2V0IGNvbXByZWhlbnNpdmUgc2VjdXJpdHkgc3RhdHVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZWN1cml0eVN0YXR1cygpIHtcbiAgY29uc3Qgd2FybmluZ3MgPSB2YWxpZGF0ZVNlY3JldFNlY3VyaXR5KClcbiAgY29uc3QgcmVxdWlyZWRNaXNzaW5nID0gU0VSVkVSX1JFUVVJUkVEX0VOVl9WQVJTLmZpbHRlcihrZXkgPT4gIXByb2Nlc3MuZW52W2tleV0pXG4gIGNvbnN0IHJlY29tbWVuZGVkTWlzc2luZyA9IFNFUlZFUl9SRUNPTU1FTkRFRF9FTlZfVkFSUy5maWx0ZXIoa2V5ID0+ICFwcm9jZXNzLmVudltrZXldKVxuICBcbiAgcmV0dXJuIHtcbiAgICBzdGF0dXM6IHJlcXVpcmVkTWlzc2luZy5sZW5ndGggPT09IDAgJiYgd2FybmluZ3MubGVuZ3RoID09PSAwID8gJ3NlY3VyZScgOiAnbmVlZHNfYXR0ZW50aW9uJyxcbiAgICByZXF1aXJlZE1pc3NpbmcsXG4gICAgcmVjb21tZW5kZWRNaXNzaW5nLFxuICAgIHNlY3VyaXR5V2FybmluZ3M6IHdhcm5pbmdzLFxuICAgIGxhc3RDaGVja2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgfVxufVxuXG4vLyBBdXRvLXZhbGlkYXRlIG9uIGltcG9ydCBpbiBkZXZlbG9wbWVudCAoU0VSVkVSLVNJREUgT05MWSlcbmlmIChpc0RldmVsb3BtZW50KCkgJiYgdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdHJ5IHtcbiAgICB2YWxpZGF0ZUVudmlyb25tZW50KClcbiAgICB2YWxpZGF0ZUFQSUtleXNTZWN1cml0eSgpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gTm90ZTogVXNpbmcgY29uc29sZS5lcnJvciBoZXJlIGFzIHRoaXMgaXMgY3JpdGljYWwgYm9vdHN0cmFwIGVycm9yXG4gICAgY29uc29sZS5lcnJvcign4p2MIEVudmlyb25tZW50IHZhbGlkYXRpb24gZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gIH1cbn0iXSwibmFtZXMiOlsiQ0xJRU5UX1JFUVVJUkVEX0VOVl9WQVJTIiwiU0VSVkVSX1JFUVVJUkVEX0VOVl9WQVJTIiwiU0VSVkVSX1JFQ09NTUVOREVEX0VOVl9WQVJTIiwiT1BUSU9OQUxfRU5WX1ZBUlMiLCJOT0RFX0VOViIsIk5FWFRfUFVCTElDX0FQUF9VUkwiLCJ2YWxpZGF0ZUVudmlyb25tZW50IiwiY29uc29sZSIsImxvZyIsIm1pc3NpbmciLCJmaWx0ZXIiLCJrZXkiLCJwcm9jZXNzIiwiZW52IiwibGVuZ3RoIiwiRXJyb3IiLCJqb2luIiwiZ2V0RW52VmFyIiwicmVxdWlyZWQiLCJ2YWx1ZSIsImlzUHJvZHVjdGlvbiIsImlzRGV2ZWxvcG1lbnQiLCJzYWZlTG9nIiwibWVzc2FnZSIsImRhdGEiLCJmb3JjZSIsImdldFN1cGFiYXNlQ29uZmlnIiwidXJsIiwidmFsaWRhdGVBUElLZXlzU2VjdXJpdHkiLCJzZW5zaXRpdmVLZXlzIiwiZXhwb3NlZEtleXMiLCJ3aW5kb3ciLCJ2YWxpZGF0ZVNlY3JldFNlY3VyaXR5IiwiZGFuZ2Vyb3VzUGF0dGVybnMiLCJwYXR0ZXJucyIsIndhcm5pbmdzIiwiZm9yRWFjaCIsInBhdHRlcm4iLCJpbmNsdWRlcyIsInB1c2giLCJKV1RfU0VDUkVUIiwiZ2V0U2VjdXJpdHlTdGF0dXMiLCJyZXF1aXJlZE1pc3NpbmciLCJyZWNvbW1lbmRlZE1pc3NpbmciLCJzdGF0dXMiLCJzZWN1cml0eVdhcm5pbmdzIiwibGFzdENoZWNrZWQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/utils/environment-validation.js\n");

/***/ }),

/***/ "(api)/./lib/utils/production-logger.js":
/*!****************************************!*\
  !*** ./lib/utils/production-logger.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   logAPICall: () => (/* binding */ logAPICall),\n/* harmony export */   logBusiness: () => (/* binding */ logBusiness),\n/* harmony export */   logDBQuery: () => (/* binding */ logDBQuery),\n/* harmony export */   logDebug: () => (/* binding */ logDebug),\n/* harmony export */   logError: () => (/* binding */ logError),\n/* harmony export */   logInfo: () => (/* binding */ logInfo),\n/* harmony export */   logPerformance: () => (/* binding */ logPerformance),\n/* harmony export */   logSecurity: () => (/* binding */ logSecurity),\n/* harmony export */   logWarn: () => (/* binding */ logWarn),\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\n/* harmony import */ var _environment_validation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./environment-validation.js */ \"(api)/./lib/utils/environment-validation.js\");\n/**\n * Production-Safe Logging System\n * Handles logging with environment awareness and security\n */ \n// Log levels\nconst LOG_LEVELS = {\n    ERROR: 0,\n    WARN: 1,\n    INFO: 2,\n    DEBUG: 3,\n    TRACE: 4\n};\nclass ProductionLogger {\n    constructor(){\n        this.level = (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? LOG_LEVELS.WARN : LOG_LEVELS.DEBUG;\n        this.sensitivePatterns = [\n            /sk-[a-zA-Z0-9_-]+/,\n            /pk_[a-zA-Z0-9_-]+/,\n            /eyJ[a-zA-Z0-9_-]+/,\n            /password/i,\n            /secret/i,\n            /token/i,\n            /key.*=.*[a-zA-Z0-9_-]{20,}/ // Key-value pairs with long values\n        ];\n    }\n    /**\n   * Sanitize sensitive data from logs\n   */ sanitize(data) {\n        if (typeof data === \"string\") {\n            let sanitized = data;\n            this.sensitivePatterns.forEach((pattern)=>{\n                sanitized = sanitized.replace(pattern, \"[REDACTED]\");\n            });\n            return sanitized;\n        }\n        if (typeof data === \"object\" && data !== null) {\n            const sanitized = Array.isArray(data) ? [] : {};\n            for (const [key, value] of Object.entries(data)){\n                const keyLower = key.toLowerCase();\n                if (keyLower.includes(\"password\") || keyLower.includes(\"secret\") || keyLower.includes(\"token\") || keyLower.includes(\"key\")) {\n                    sanitized[key] = \"[REDACTED]\";\n                } else {\n                    sanitized[key] = this.sanitize(value);\n                }\n            }\n            return sanitized;\n        }\n        return data;\n    }\n    /**\n   * Format log message\n   */ formatMessage(level, message, data, metadata) {\n        const timestamp = new Date().toISOString();\n        const sanitizedData = data ? this.sanitize(data) : null;\n        const logEntry = {\n            timestamp,\n            level,\n            message,\n            ...sanitizedData && {\n                data: sanitizedData\n            },\n            ...metadata && {\n                metadata\n            }\n        };\n        return (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? JSON.stringify(logEntry) : logEntry;\n    }\n    /**\n   * Log error messages\n   */ error(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.ERROR) {\n            const formatted = this.formatMessage(\"ERROR\", message, data, metadata);\n            console.error((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? formatted : \"❌\", (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : message, (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : this.sanitize(data));\n        }\n    }\n    /**\n   * Log warning messages\n   */ warn(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.WARN) {\n            const formatted = this.formatMessage(\"WARN\", message, data, metadata);\n            console.warn((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? formatted : \"⚠️\", (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : message, (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : this.sanitize(data));\n        }\n    }\n    /**\n   * Log info messages\n   */ info(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.INFO) {\n            const formatted = this.formatMessage(\"INFO\", message, data, metadata);\n            console.log((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? formatted : \"ℹ️\", (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : message, (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : this.sanitize(data));\n        }\n    }\n    /**\n   * Log debug messages (only in development)\n   */ debug(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.DEBUG && (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isDevelopment)()) {\n            const formatted = this.formatMessage(\"DEBUG\", message, data, metadata);\n            console.log((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? formatted : \"\\uD83D\\uDC1B\", (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : message, (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : this.sanitize(data));\n        }\n    }\n    /**\n   * Log trace messages (only in development)\n   */ trace(message, data = null, metadata = null) {\n        if (this.level >= LOG_LEVELS.TRACE && (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isDevelopment)()) {\n            const formatted = this.formatMessage(\"TRACE\", message, data, metadata);\n            console.log((0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? formatted : \"\\uD83D\\uDD0D\", (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : message, (0,_environment_validation_js__WEBPACK_IMPORTED_MODULE_0__.isProduction)() ? \"\" : this.sanitize(data));\n        }\n    }\n    /**\n   * Log performance metrics\n   */ performance(operation, duration, metadata = null) {\n        this.info(`Performance: ${operation}`, {\n            duration: `${duration}ms`\n        }, metadata);\n    }\n    /**\n   * Log API calls\n   */ apiCall(method, endpoint, duration, status) {\n        this.info(`API: ${method} ${endpoint}`, {\n            duration: `${duration}ms`,\n            status,\n            type: \"api_call\"\n        });\n    }\n    /**\n   * Log database queries\n   */ dbQuery(table, operation, duration, recordCount = null) {\n        this.debug(`DB: ${operation} on ${table}`, {\n            duration: `${duration}ms`,\n            recordCount,\n            type: \"db_query\"\n        });\n    }\n    /**\n   * Log security events\n   */ security(event, details = null) {\n        this.warn(`Security: ${event}`, details, {\n            type: \"security_event\"\n        });\n    }\n    /**\n   * Log business events\n   */ business(event, details = null) {\n        this.info(`Business: ${event}`, details, {\n            type: \"business_event\"\n        });\n    }\n}\n// Create singleton instance\nconst logger = new ProductionLogger();\n// Convenience functions for common use cases\nconst logError = (message, data, metadata)=>logger.error(message, data, metadata);\nconst logWarn = (message, data, metadata)=>logger.warn(message, data, metadata);\nconst logInfo = (message, data, metadata)=>logger.info(message, data, metadata);\nconst logDebug = (message, data, metadata)=>logger.debug(message, data, metadata);\nconst logPerformance = (operation, duration, metadata)=>logger.performance(operation, duration, metadata);\nconst logAPICall = (method, endpoint, duration, status)=>logger.apiCall(method, endpoint, duration, status);\nconst logDBQuery = (table, operation, duration, recordCount)=>logger.dbQuery(table, operation, duration, recordCount);\nconst logSecurity = (event, details)=>logger.security(event, details);\nconst logBusiness = (event, details)=>logger.business(event, details);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (logger);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTUEsRUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL3RyaWFuZ2xlLWludGVsbGlnZW5jZS1wbGF0Zm9ybS8uL2xpYi91dGlscy9wcm9kdWN0aW9uLWxvZ2dlci5qcz9mZjY2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUHJvZHVjdGlvbi1TYWZlIExvZ2dpbmcgU3lzdGVtXG4gKiBIYW5kbGVzIGxvZ2dpbmcgd2l0aCBlbnZpcm9ubWVudCBhd2FyZW5lc3MgYW5kIHNlY3VyaXR5XG4gKi9cblxuaW1wb3J0IHsgaXNEZXZlbG9wbWVudCwgaXNQcm9kdWN0aW9uIH0gZnJvbSAnLi9lbnZpcm9ubWVudC12YWxpZGF0aW9uLmpzJ1xuXG4vLyBMb2cgbGV2ZWxzXG5jb25zdCBMT0dfTEVWRUxTID0ge1xuICBFUlJPUjogMCxcbiAgV0FSTjogMSxcbiAgSU5GTzogMixcbiAgREVCVUc6IDMsXG4gIFRSQUNFOiA0XG59XG5cbmNsYXNzIFByb2R1Y3Rpb25Mb2dnZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmxldmVsID0gaXNQcm9kdWN0aW9uKCkgPyBMT0dfTEVWRUxTLldBUk4gOiBMT0dfTEVWRUxTLkRFQlVHXG4gICAgdGhpcy5zZW5zaXRpdmVQYXR0ZXJucyA9IFtcbiAgICAgIC9zay1bYS16QS1aMC05Xy1dKy8sIC8vIEFQSSBrZXlzIHN0YXJ0aW5nIHdpdGggc2stXG4gICAgICAvcGtfW2EtekEtWjAtOV8tXSsvLCAvLyBTdHJpcGUgcHVibGljIGtleXNcbiAgICAgIC9leUpbYS16QS1aMC05Xy1dKy8sIC8vIEpXVCB0b2tlbnNcbiAgICAgIC9wYXNzd29yZC9pLFxuICAgICAgL3NlY3JldC9pLFxuICAgICAgL3Rva2VuL2ksXG4gICAgICAva2V5Lio9LipbYS16QS1aMC05Xy1dezIwLH0vIC8vIEtleS12YWx1ZSBwYWlycyB3aXRoIGxvbmcgdmFsdWVzXG4gICAgXVxuICB9XG5cbiAgLyoqXG4gICAqIFNhbml0aXplIHNlbnNpdGl2ZSBkYXRhIGZyb20gbG9nc1xuICAgKi9cbiAgc2FuaXRpemUoZGF0YSkge1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCBzYW5pdGl6ZWQgPSBkYXRhXG4gICAgICB0aGlzLnNlbnNpdGl2ZVBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKHBhdHRlcm4sICdbUkVEQUNURURdJylcbiAgICAgIH0pXG4gICAgICByZXR1cm4gc2FuaXRpemVkXG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBzYW5pdGl6ZWQgPSBBcnJheS5pc0FycmF5KGRhdGEpID8gW10gOiB7fVxuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkYXRhKSkge1xuICAgICAgICBjb25zdCBrZXlMb3dlciA9IGtleS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIFxuICAgICAgICBpZiAoa2V5TG93ZXIuaW5jbHVkZXMoJ3Bhc3N3b3JkJykgfHwgXG4gICAgICAgICAgICBrZXlMb3dlci5pbmNsdWRlcygnc2VjcmV0JykgfHwgXG4gICAgICAgICAgICBrZXlMb3dlci5pbmNsdWRlcygndG9rZW4nKSB8fFxuICAgICAgICAgICAga2V5TG93ZXIuaW5jbHVkZXMoJ2tleScpKSB7XG4gICAgICAgICAgc2FuaXRpemVkW2tleV0gPSAnW1JFREFDVEVEXSdcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzYW5pdGl6ZWRba2V5XSA9IHRoaXMuc2FuaXRpemUodmFsdWUpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHNhbml0aXplZFxuICAgIH1cblxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICAvKipcbiAgICogRm9ybWF0IGxvZyBtZXNzYWdlXG4gICAqL1xuICBmb3JtYXRNZXNzYWdlKGxldmVsLCBtZXNzYWdlLCBkYXRhLCBtZXRhZGF0YSkge1xuICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIGNvbnN0IHNhbml0aXplZERhdGEgPSBkYXRhID8gdGhpcy5zYW5pdGl6ZShkYXRhKSA6IG51bGxcbiAgICBcbiAgICBjb25zdCBsb2dFbnRyeSA9IHtcbiAgICAgIHRpbWVzdGFtcCxcbiAgICAgIGxldmVsLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIC4uLihzYW5pdGl6ZWREYXRhICYmIHsgZGF0YTogc2FuaXRpemVkRGF0YSB9KSxcbiAgICAgIC4uLihtZXRhZGF0YSAmJiB7IG1ldGFkYXRhIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIGlzUHJvZHVjdGlvbigpID8gSlNPTi5zdHJpbmdpZnkobG9nRW50cnkpIDogbG9nRW50cnlcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgZXJyb3IgbWVzc2FnZXNcbiAgICovXG4gIGVycm9yKG1lc3NhZ2UsIGRhdGEgPSBudWxsLCBtZXRhZGF0YSA9IG51bGwpIHtcbiAgICBpZiAodGhpcy5sZXZlbCA+PSBMT0dfTEVWRUxTLkVSUk9SKSB7XG4gICAgICBjb25zdCBmb3JtYXR0ZWQgPSB0aGlzLmZvcm1hdE1lc3NhZ2UoJ0VSUk9SJywgbWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpXG4gICAgICBjb25zb2xlLmVycm9yKGlzUHJvZHVjdGlvbigpID8gZm9ybWF0dGVkIDogJ+KdjCcsIGlzUHJvZHVjdGlvbigpID8gJycgOiBtZXNzYWdlLCBpc1Byb2R1Y3Rpb24oKSA/ICcnIDogdGhpcy5zYW5pdGl6ZShkYXRhKSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTG9nIHdhcm5pbmcgbWVzc2FnZXNcbiAgICovXG4gIHdhcm4obWVzc2FnZSwgZGF0YSA9IG51bGwsIG1ldGFkYXRhID0gbnVsbCkge1xuICAgIGlmICh0aGlzLmxldmVsID49IExPR19MRVZFTFMuV0FSTikge1xuICAgICAgY29uc3QgZm9ybWF0dGVkID0gdGhpcy5mb3JtYXRNZXNzYWdlKCdXQVJOJywgbWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpXG4gICAgICBjb25zb2xlLndhcm4oaXNQcm9kdWN0aW9uKCkgPyBmb3JtYXR0ZWQgOiAn4pqg77iPJywgaXNQcm9kdWN0aW9uKCkgPyAnJyA6IG1lc3NhZ2UsIGlzUHJvZHVjdGlvbigpID8gJycgOiB0aGlzLnNhbml0aXplKGRhdGEpKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgaW5mbyBtZXNzYWdlc1xuICAgKi9cbiAgaW5mbyhtZXNzYWdlLCBkYXRhID0gbnVsbCwgbWV0YWRhdGEgPSBudWxsKSB7XG4gICAgaWYgKHRoaXMubGV2ZWwgPj0gTE9HX0xFVkVMUy5JTkZPKSB7XG4gICAgICBjb25zdCBmb3JtYXR0ZWQgPSB0aGlzLmZvcm1hdE1lc3NhZ2UoJ0lORk8nLCBtZXNzYWdlLCBkYXRhLCBtZXRhZGF0YSlcbiAgICAgIGNvbnNvbGUubG9nKGlzUHJvZHVjdGlvbigpID8gZm9ybWF0dGVkIDogJ+KEue+4jycsIGlzUHJvZHVjdGlvbigpID8gJycgOiBtZXNzYWdlLCBpc1Byb2R1Y3Rpb24oKSA/ICcnIDogdGhpcy5zYW5pdGl6ZShkYXRhKSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTG9nIGRlYnVnIG1lc3NhZ2VzIChvbmx5IGluIGRldmVsb3BtZW50KVxuICAgKi9cbiAgZGVidWcobWVzc2FnZSwgZGF0YSA9IG51bGwsIG1ldGFkYXRhID0gbnVsbCkge1xuICAgIGlmICh0aGlzLmxldmVsID49IExPR19MRVZFTFMuREVCVUcgJiYgaXNEZXZlbG9wbWVudCgpKSB7XG4gICAgICBjb25zdCBmb3JtYXR0ZWQgPSB0aGlzLmZvcm1hdE1lc3NhZ2UoJ0RFQlVHJywgbWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpXG4gICAgICBjb25zb2xlLmxvZyhpc1Byb2R1Y3Rpb24oKSA/IGZvcm1hdHRlZCA6ICfwn5CbJywgaXNQcm9kdWN0aW9uKCkgPyAnJyA6IG1lc3NhZ2UsIGlzUHJvZHVjdGlvbigpID8gJycgOiB0aGlzLnNhbml0aXplKGRhdGEpKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgdHJhY2UgbWVzc2FnZXMgKG9ubHkgaW4gZGV2ZWxvcG1lbnQpXG4gICAqL1xuICB0cmFjZShtZXNzYWdlLCBkYXRhID0gbnVsbCwgbWV0YWRhdGEgPSBudWxsKSB7XG4gICAgaWYgKHRoaXMubGV2ZWwgPj0gTE9HX0xFVkVMUy5UUkFDRSAmJiBpc0RldmVsb3BtZW50KCkpIHtcbiAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IHRoaXMuZm9ybWF0TWVzc2FnZSgnVFJBQ0UnLCBtZXNzYWdlLCBkYXRhLCBtZXRhZGF0YSlcbiAgICAgIGNvbnNvbGUubG9nKGlzUHJvZHVjdGlvbigpID8gZm9ybWF0dGVkIDogJ/CflI0nLCBpc1Byb2R1Y3Rpb24oKSA/ICcnIDogbWVzc2FnZSwgaXNQcm9kdWN0aW9uKCkgPyAnJyA6IHRoaXMuc2FuaXRpemUoZGF0YSkpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExvZyBwZXJmb3JtYW5jZSBtZXRyaWNzXG4gICAqL1xuICBwZXJmb3JtYW5jZShvcGVyYXRpb24sIGR1cmF0aW9uLCBtZXRhZGF0YSA9IG51bGwpIHtcbiAgICB0aGlzLmluZm8oYFBlcmZvcm1hbmNlOiAke29wZXJhdGlvbn1gLCB7IGR1cmF0aW9uOiBgJHtkdXJhdGlvbn1tc2AgfSwgbWV0YWRhdGEpXG4gIH1cblxuICAvKipcbiAgICogTG9nIEFQSSBjYWxsc1xuICAgKi9cbiAgYXBpQ2FsbChtZXRob2QsIGVuZHBvaW50LCBkdXJhdGlvbiwgc3RhdHVzKSB7XG4gICAgdGhpcy5pbmZvKGBBUEk6ICR7bWV0aG9kfSAke2VuZHBvaW50fWAsIHtcbiAgICAgIGR1cmF0aW9uOiBgJHtkdXJhdGlvbn1tc2AsXG4gICAgICBzdGF0dXMsXG4gICAgICB0eXBlOiAnYXBpX2NhbGwnXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgZGF0YWJhc2UgcXVlcmllc1xuICAgKi9cbiAgZGJRdWVyeSh0YWJsZSwgb3BlcmF0aW9uLCBkdXJhdGlvbiwgcmVjb3JkQ291bnQgPSBudWxsKSB7XG4gICAgdGhpcy5kZWJ1ZyhgREI6ICR7b3BlcmF0aW9ufSBvbiAke3RhYmxlfWAsIHtcbiAgICAgIGR1cmF0aW9uOiBgJHtkdXJhdGlvbn1tc2AsXG4gICAgICByZWNvcmRDb3VudCxcbiAgICAgIHR5cGU6ICdkYl9xdWVyeSdcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIExvZyBzZWN1cml0eSBldmVudHNcbiAgICovXG4gIHNlY3VyaXR5KGV2ZW50LCBkZXRhaWxzID0gbnVsbCkge1xuICAgIHRoaXMud2FybihgU2VjdXJpdHk6ICR7ZXZlbnR9YCwgZGV0YWlscywgeyB0eXBlOiAnc2VjdXJpdHlfZXZlbnQnIH0pXG4gIH1cblxuICAvKipcbiAgICogTG9nIGJ1c2luZXNzIGV2ZW50c1xuICAgKi9cbiAgYnVzaW5lc3MoZXZlbnQsIGRldGFpbHMgPSBudWxsKSB7XG4gICAgdGhpcy5pbmZvKGBCdXNpbmVzczogJHtldmVudH1gLCBkZXRhaWxzLCB7IHR5cGU6ICdidXNpbmVzc19ldmVudCcgfSlcbiAgfVxufVxuXG4vLyBDcmVhdGUgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gbmV3IFByb2R1Y3Rpb25Mb2dnZXIoKVxuXG4vLyBDb252ZW5pZW5jZSBmdW5jdGlvbnMgZm9yIGNvbW1vbiB1c2UgY2FzZXNcbmV4cG9ydCBjb25zdCBsb2dFcnJvciA9IChtZXNzYWdlLCBkYXRhLCBtZXRhZGF0YSkgPT4gbG9nZ2VyLmVycm9yKG1lc3NhZ2UsIGRhdGEsIG1ldGFkYXRhKVxuZXhwb3J0IGNvbnN0IGxvZ1dhcm4gPSAobWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpID0+IGxvZ2dlci53YXJuKG1lc3NhZ2UsIGRhdGEsIG1ldGFkYXRhKVxuZXhwb3J0IGNvbnN0IGxvZ0luZm8gPSAobWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpID0+IGxvZ2dlci5pbmZvKG1lc3NhZ2UsIGRhdGEsIG1ldGFkYXRhKVxuZXhwb3J0IGNvbnN0IGxvZ0RlYnVnID0gKG1lc3NhZ2UsIGRhdGEsIG1ldGFkYXRhKSA9PiBsb2dnZXIuZGVidWcobWVzc2FnZSwgZGF0YSwgbWV0YWRhdGEpXG5leHBvcnQgY29uc3QgbG9nUGVyZm9ybWFuY2UgPSAob3BlcmF0aW9uLCBkdXJhdGlvbiwgbWV0YWRhdGEpID0+IGxvZ2dlci5wZXJmb3JtYW5jZShvcGVyYXRpb24sIGR1cmF0aW9uLCBtZXRhZGF0YSlcbmV4cG9ydCBjb25zdCBsb2dBUElDYWxsID0gKG1ldGhvZCwgZW5kcG9pbnQsIGR1cmF0aW9uLCBzdGF0dXMpID0+IGxvZ2dlci5hcGlDYWxsKG1ldGhvZCwgZW5kcG9pbnQsIGR1cmF0aW9uLCBzdGF0dXMpXG5leHBvcnQgY29uc3QgbG9nREJRdWVyeSA9ICh0YWJsZSwgb3BlcmF0aW9uLCBkdXJhdGlvbiwgcmVjb3JkQ291bnQpID0+IGxvZ2dlci5kYlF1ZXJ5KHRhYmxlLCBvcGVyYXRpb24sIGR1cmF0aW9uLCByZWNvcmRDb3VudClcbmV4cG9ydCBjb25zdCBsb2dTZWN1cml0eSA9IChldmVudCwgZGV0YWlscykgPT4gbG9nZ2VyLnNlY3VyaXR5KGV2ZW50LCBkZXRhaWxzKVxuZXhwb3J0IGNvbnN0IGxvZ0J1c2luZXNzID0gKGV2ZW50LCBkZXRhaWxzKSA9PiBsb2dnZXIuYnVzaW5lc3MoZXZlbnQsIGRldGFpbHMpXG5cbmV4cG9ydCBkZWZhdWx0IGxvZ2dlciJdLCJuYW1lcyI6WyJpc0RldmVsb3BtZW50IiwiaXNQcm9kdWN0aW9uIiwiTE9HX0xFVkVMUyIsIkVSUk9SIiwiV0FSTiIsIklORk8iLCJERUJVRyIsIlRSQUNFIiwiUHJvZHVjdGlvbkxvZ2dlciIsImNvbnN0cnVjdG9yIiwibGV2ZWwiLCJzZW5zaXRpdmVQYXR0ZXJucyIsInNhbml0aXplIiwiZGF0YSIsInNhbml0aXplZCIsImZvckVhY2giLCJwYXR0ZXJuIiwicmVwbGFjZSIsIkFycmF5IiwiaXNBcnJheSIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsImtleUxvd2VyIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImZvcm1hdE1lc3NhZ2UiLCJtZXNzYWdlIiwibWV0YWRhdGEiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzYW5pdGl6ZWREYXRhIiwibG9nRW50cnkiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyb3IiLCJmb3JtYXR0ZWQiLCJjb25zb2xlIiwid2FybiIsImluZm8iLCJsb2ciLCJkZWJ1ZyIsInRyYWNlIiwicGVyZm9ybWFuY2UiLCJvcGVyYXRpb24iLCJkdXJhdGlvbiIsImFwaUNhbGwiLCJtZXRob2QiLCJlbmRwb2ludCIsInN0YXR1cyIsInR5cGUiLCJkYlF1ZXJ5IiwidGFibGUiLCJyZWNvcmRDb3VudCIsInNlY3VyaXR5IiwiZXZlbnQiLCJkZXRhaWxzIiwiYnVzaW5lc3MiLCJsb2dnZXIiLCJsb2dFcnJvciIsImxvZ1dhcm4iLCJsb2dJbmZvIiwibG9nRGVidWciLCJsb2dQZXJmb3JtYW5jZSIsImxvZ0FQSUNhbGwiLCJsb2dEQlF1ZXJ5IiwibG9nU2VjdXJpdHkiLCJsb2dCdXNpbmVzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/utils/production-logger.js\n");

/***/ }),

/***/ "(api)/./pages/api/status.js":
/*!*****************************!*\
  !*** ./pages/api/status.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_security_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/security.js */ \"(api)/./lib/security.js\");\n/* harmony import */ var _lib_monitoring_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/monitoring.js */ \"(api)/./lib/monitoring.js\");\n/* harmony import */ var _lib_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/utils/production-logger.js */ \"(api)/./lib/utils/production-logger.js\");\n/* harmony import */ var _lib_supabase_client_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lib/supabase-client.js */ \"(api)/./lib/supabase-client.js\");\n/**\n * UNIFIED STATUS & HEALTH API ENDPOINT\n * Consolidates: status.js + health.js\n * Provides comprehensive system health and configuration status\n * Supports both detailed status and lightweight health checks\n */ \n\n\n\nasync function handler(req, res) {\n    const startTime = Date.now();\n    try {\n        // Apply security headers\n        (0,_lib_security_js__WEBPACK_IMPORTED_MODULE_0__.applySecurityHeaders)(res);\n        // Only allow GET requests\n        if (req.method !== \"GET\") {\n            const duration = Date.now() - startTime;\n            (0,_lib_monitoring_js__WEBPACK_IMPORTED_MODULE_1__.trackAPICall)(req.method, \"/api/status\", duration, 405);\n            return res.status(405).json({\n                error: \"Method not allowed\",\n                message: \"Only GET requests are supported\"\n            });\n        }\n        // Check for lightweight health mode (from health.js functionality)\n        const isSimpleHealthCheck = req.query.simple === \"true\" || req.query.health === \"true\";\n        if (isSimpleHealthCheck) {\n            (0,_lib_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_2__.logInfo)(\"Simple health check initiated\");\n            // Basic application health\n            const health = {\n                status: \"healthy\",\n                timestamp: new Date().toISOString(),\n                version: process.env.npm_package_version || \"1.0.0\",\n                uptime: process.uptime(),\n                environment: \"development\" || 0\n            };\n            // Test database connectivity\n            let databaseStatus = \"disconnected\";\n            try {\n                const dbConnected = await (0,_lib_supabase_client_js__WEBPACK_IMPORTED_MODULE_3__.testSupabaseConnection)();\n                databaseStatus = dbConnected ? \"connected\" : \"disconnected\";\n                if (!dbConnected) {\n                    health.status = \"unhealthy\";\n                    health.issues = [\n                        \"database_disconnected\"\n                    ];\n                }\n            } catch (error) {\n                health.status = \"unhealthy\";\n                health.issues = [\n                    \"database_error\"\n                ];\n                (0,_lib_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_2__.logError)(\"Database health check failed\", {\n                    error: error.message\n                });\n            }\n            // Add basic resource usage\n            const memUsage = process.memoryUsage();\n            health.database = databaseStatus;\n            health.memory_mb = Math.round(memUsage.rss / 1024 / 1024);\n            health.response_time_ms = Date.now() - startTime;\n            const duration = Date.now() - startTime;\n            (0,_lib_monitoring_js__WEBPACK_IMPORTED_MODULE_1__.trackAPICall)(req.method, \"/api/status?simple=true\", duration, 200);\n            return res.status(200).json(health);\n        }\n        // logInfo('API Status check initiated', {\n        //   ip: SecurityValidator.getClientIP(req),\n        //   userAgent: req.headers['user-agent']?.substring(0, 50)\n        // })\n        // Get system health metrics\n        const healthMetrics = (0,_lib_monitoring_js__WEBPACK_IMPORTED_MODULE_1__.getHealthMetrics)();\n        // Test database connectivity\n        let databaseStatus = \"unknown\";\n        try {\n            const dbConnected = await (0,_lib_supabase_client_js__WEBPACK_IMPORTED_MODULE_3__.testSupabaseConnection)();\n            databaseStatus = dbConnected ? \"connected\" : \"disconnected\";\n        } catch (error) {\n            databaseStatus = \"error\";\n            console.error(\"Database status check failed:\", error.message);\n        }\n        // Check API configuration (without exposing keys)\n        const apiStatus = {\n            comtrade: {\n                configured: !!process.env.COMTRADE_API_KEY,\n                status: process.env.COMTRADE_API_KEY ? \"ready\" : \"not_configured\"\n            },\n            shippo: {\n                configured: !!process.env.SHIPPO_API_KEY,\n                status: process.env.SHIPPO_API_KEY ? \"ready\" : \"not_configured\"\n            },\n            anthropic: {\n                configured: !!process.env.ANTHROPIC_API_KEY,\n                status: process.env.ANTHROPIC_API_KEY ? \"ready\" : \"not_configured\"\n            },\n            stripe: {\n                configured: !!process.env.STRIPE_SECRET_KEY,\n                status: process.env.STRIPE_SECRET_KEY ? \"ready\" : \"not_configured\"\n            }\n        };\n        // Build status response\n        const status = {\n            status: \"operational\",\n            timestamp: new Date().toISOString(),\n            environment: \"development\" || 0,\n            version: process.env.npm_package_version || \"1.0.0\",\n            uptime: healthMetrics.uptime,\n            system: {\n                database: databaseStatus,\n                memory: healthMetrics.memory,\n                requests: healthMetrics.requests,\n                alerts: healthMetrics.activeAlerts\n            },\n            apis: apiStatus,\n            features: {\n                monitoring: \"enabled\",\n                security: \"enabled\",\n                caching: \"enabled\",\n                logging: \"enabled\"\n            }\n        };\n        // Determine overall status\n        const hasErrors = databaseStatus === \"error\" || healthMetrics.requests.errorRate > 10 || !process.env.ANTHROPIC_API_KEY || !process.env.COMTRADE_API_KEY;\n        if (hasErrors) {\n            status.status = \"degraded\";\n        }\n        const duration = Date.now() - startTime;\n        const statusCode = hasErrors ? 200 : 200 // Always return 200 for status endpoint\n        ;\n        (0,_lib_monitoring_js__WEBPACK_IMPORTED_MODULE_1__.trackAPICall)(\"GET\", \"/api/status\", duration, statusCode);\n        // logInfo('API Status check completed', {\n        //   status: status.status,\n        //   responseTime: `${duration}ms`,\n        //   database: databaseStatus\n        // })\n        res.status(statusCode).json(status);\n    } catch (error) {\n        const duration = Date.now() - startTime;\n        (0,_lib_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_2__.logError)(\"API Status endpoint error\", {\n            error: error.message,\n            stack: error.stack,\n            responseTime: `${duration}ms`,\n            ip: _lib_security_js__WEBPACK_IMPORTED_MODULE_0__.SecurityValidator.getClientIP(req)\n        });\n        (0,_lib_monitoring_js__WEBPACK_IMPORTED_MODULE_1__.trackAPICall)(\"GET\", \"/api/status\", duration, 500, error);\n        // Don't expose internal error details\n        res.status(500).json({\n            status: \"error\",\n            timestamp: new Date().toISOString(),\n            message: \"Unable to retrieve system status\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUcsS0FBS0Y7UUFDOUIsTUFBTXlELGFBQWFGLFlBQVksTUFBTSxJQUFJLHdDQUF3Qzs7UUFFakYvRCxnRUFBWUEsQ0FBQyxPQUFPLGVBQWVZLFVBQVVxRDtRQUU3QywwQ0FBMEM7UUFDMUMsMkJBQTJCO1FBQzNCLG1DQUFtQztRQUNuQyw2QkFBNkI7UUFDN0IsS0FBSztRQUVMMUQsSUFBSU0sTUFBTSxDQUFDb0QsWUFBWW5ELElBQUksQ0FBQ0Q7SUFFOUIsRUFBRSxPQUFPRSxPQUFPO1FBQ2QsTUFBTUgsV0FBV0gsS0FBS0MsR0FBRyxLQUFLRjtRQUU5QkwseUVBQVFBLENBQUMsNkJBQTZCO1lBQ3BDWSxPQUFPQSxNQUFNQyxPQUFPO1lBQ3BCa0QsT0FBT25ELE1BQU1tRCxLQUFLO1lBQ2xCQyxjQUFjLENBQUMsRUFBRXZELFNBQVMsRUFBRSxDQUFDO1lBQzdCd0QsSUFBSXJFLCtEQUFpQkEsQ0FBQ3NFLFdBQVcsQ0FBQy9EO1FBQ3BDO1FBRUFOLGdFQUFZQSxDQUFDLE9BQU8sZUFBZVksVUFBVSxLQUFLRztRQUVsRCxzQ0FBc0M7UUFDdENSLElBQUlNLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJELFFBQVE7WUFDUlEsV0FBVyxJQUFJWixPQUFPYSxXQUFXO1lBQ2pDTixTQUFTO1FBQ1g7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJpYW5nbGUtaW50ZWxsaWdlbmNlLXBsYXRmb3JtLy4vcGFnZXMvYXBpL3N0YXR1cy5qcz8zYzcwIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVU5JRklFRCBTVEFUVVMgJiBIRUFMVEggQVBJIEVORFBPSU5UXG4gKiBDb25zb2xpZGF0ZXM6IHN0YXR1cy5qcyArIGhlYWx0aC5qc1xuICogUHJvdmlkZXMgY29tcHJlaGVuc2l2ZSBzeXN0ZW0gaGVhbHRoIGFuZCBjb25maWd1cmF0aW9uIHN0YXR1c1xuICogU3VwcG9ydHMgYm90aCBkZXRhaWxlZCBzdGF0dXMgYW5kIGxpZ2h0d2VpZ2h0IGhlYWx0aCBjaGVja3NcbiAqL1xuXG5pbXBvcnQgeyBhcHBseVNlY3VyaXR5SGVhZGVycywgU2VjdXJpdHlWYWxpZGF0b3IgfSBmcm9tICcuLi8uLi9saWIvc2VjdXJpdHkuanMnXG5pbXBvcnQgeyB0cmFja0FQSUNhbGwsIGdldEhlYWx0aE1ldHJpY3MgfSBmcm9tICcuLi8uLi9saWIvbW9uaXRvcmluZy5qcydcbmltcG9ydCB7IGxvZ0luZm8sIGxvZ0Vycm9yIH0gZnJvbSAnLi4vLi4vbGliL3V0aWxzL3Byb2R1Y3Rpb24tbG9nZ2VyLmpzJ1xuaW1wb3J0IHsgdGVzdFN1cGFiYXNlQ29ubmVjdGlvbiB9IGZyb20gJy4uLy4uL2xpYi9zdXBhYmFzZS1jbGllbnQuanMnXG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKVxuICBcbiAgdHJ5IHtcbiAgICAvLyBBcHBseSBzZWN1cml0eSBoZWFkZXJzXG4gICAgYXBwbHlTZWN1cml0eUhlYWRlcnMocmVzKVxuICAgIFxuICAgIC8vIE9ubHkgYWxsb3cgR0VUIHJlcXVlc3RzXG4gICAgaWYgKHJlcS5tZXRob2QgIT09ICdHRVQnKSB7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWVcbiAgICAgIHRyYWNrQVBJQ2FsbChyZXEubWV0aG9kLCAnL2FwaS9zdGF0dXMnLCBkdXJhdGlvbiwgNDA1KVxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHtcbiAgICAgICAgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnLFxuICAgICAgICBtZXNzYWdlOiAnT25seSBHRVQgcmVxdWVzdHMgYXJlIHN1cHBvcnRlZCdcbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGZvciBsaWdodHdlaWdodCBoZWFsdGggbW9kZSAoZnJvbSBoZWFsdGguanMgZnVuY3Rpb25hbGl0eSlcbiAgICBjb25zdCBpc1NpbXBsZUhlYWx0aENoZWNrID0gcmVxLnF1ZXJ5LnNpbXBsZSA9PT0gJ3RydWUnIHx8IHJlcS5xdWVyeS5oZWFsdGggPT09ICd0cnVlJ1xuICAgIFxuICAgIGlmIChpc1NpbXBsZUhlYWx0aENoZWNrKSB7XG4gICAgICBsb2dJbmZvKCdTaW1wbGUgaGVhbHRoIGNoZWNrIGluaXRpYXRlZCcpXG4gICAgICBcbiAgICAgIC8vIEJhc2ljIGFwcGxpY2F0aW9uIGhlYWx0aFxuICAgICAgY29uc3QgaGVhbHRoID0ge1xuICAgICAgICBzdGF0dXM6ICdoZWFsdGh5JyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHZlcnNpb246IHByb2Nlc3MuZW52Lm5wbV9wYWNrYWdlX3ZlcnNpb24gfHwgJzEuMC4wJyxcbiAgICAgICAgdXB0aW1lOiBwcm9jZXNzLnVwdGltZSgpLFxuICAgICAgICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ3Vua25vd24nXG4gICAgICB9XG5cbiAgICAgIC8vIFRlc3QgZGF0YWJhc2UgY29ubmVjdGl2aXR5XG4gICAgICBsZXQgZGF0YWJhc2VTdGF0dXMgPSAnZGlzY29ubmVjdGVkJ1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZGJDb25uZWN0ZWQgPSBhd2FpdCB0ZXN0U3VwYWJhc2VDb25uZWN0aW9uKClcbiAgICAgICAgZGF0YWJhc2VTdGF0dXMgPSBkYkNvbm5lY3RlZCA/ICdjb25uZWN0ZWQnIDogJ2Rpc2Nvbm5lY3RlZCdcbiAgICAgICAgXG4gICAgICAgIGlmICghZGJDb25uZWN0ZWQpIHtcbiAgICAgICAgICBoZWFsdGguc3RhdHVzID0gJ3VuaGVhbHRoeSdcbiAgICAgICAgICBoZWFsdGguaXNzdWVzID0gWydkYXRhYmFzZV9kaXNjb25uZWN0ZWQnXVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBoZWFsdGguc3RhdHVzID0gJ3VuaGVhbHRoeSdcbiAgICAgICAgaGVhbHRoLmlzc3VlcyA9IFsnZGF0YWJhc2VfZXJyb3InXVxuICAgICAgICBsb2dFcnJvcignRGF0YWJhc2UgaGVhbHRoIGNoZWNrIGZhaWxlZCcsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSlcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIGJhc2ljIHJlc291cmNlIHVzYWdlXG4gICAgICBjb25zdCBtZW1Vc2FnZSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKVxuICAgICAgaGVhbHRoLmRhdGFiYXNlID0gZGF0YWJhc2VTdGF0dXNcbiAgICAgIGhlYWx0aC5tZW1vcnlfbWIgPSBNYXRoLnJvdW5kKG1lbVVzYWdlLnJzcyAvIDEwMjQgLyAxMDI0KVxuICAgICAgaGVhbHRoLnJlc3BvbnNlX3RpbWVfbXMgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lXG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZVxuICAgICAgdHJhY2tBUElDYWxsKHJlcS5tZXRob2QsICcvYXBpL3N0YXR1cz9zaW1wbGU9dHJ1ZScsIGR1cmF0aW9uLCAyMDApXG4gICAgICBcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihoZWFsdGgpXG4gICAgfVxuXG4gICAgLy8gbG9nSW5mbygnQVBJIFN0YXR1cyBjaGVjayBpbml0aWF0ZWQnLCB7XG4gICAgLy8gICBpcDogU2VjdXJpdHlWYWxpZGF0b3IuZ2V0Q2xpZW50SVAocmVxKSxcbiAgICAvLyAgIHVzZXJBZ2VudDogcmVxLmhlYWRlcnNbJ3VzZXItYWdlbnQnXT8uc3Vic3RyaW5nKDAsIDUwKVxuICAgIC8vIH0pXG5cbiAgICAvLyBHZXQgc3lzdGVtIGhlYWx0aCBtZXRyaWNzXG4gICAgY29uc3QgaGVhbHRoTWV0cmljcyA9IGdldEhlYWx0aE1ldHJpY3MoKVxuICAgIFxuICAgIC8vIFRlc3QgZGF0YWJhc2UgY29ubmVjdGl2aXR5XG4gICAgbGV0IGRhdGFiYXNlU3RhdHVzID0gJ3Vua25vd24nXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRiQ29ubmVjdGVkID0gYXdhaXQgdGVzdFN1cGFiYXNlQ29ubmVjdGlvbigpXG4gICAgICBkYXRhYmFzZVN0YXR1cyA9IGRiQ29ubmVjdGVkID8gJ2Nvbm5lY3RlZCcgOiAnZGlzY29ubmVjdGVkJ1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBkYXRhYmFzZVN0YXR1cyA9ICdlcnJvcidcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHN0YXR1cyBjaGVjayBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICB9XG5cbiAgICAvLyBDaGVjayBBUEkgY29uZmlndXJhdGlvbiAod2l0aG91dCBleHBvc2luZyBrZXlzKVxuICAgIGNvbnN0IGFwaVN0YXR1cyA9IHtcbiAgICAgIGNvbXRyYWRlOiB7XG4gICAgICAgIGNvbmZpZ3VyZWQ6ICEhcHJvY2Vzcy5lbnYuQ09NVFJBREVfQVBJX0tFWSxcbiAgICAgICAgc3RhdHVzOiBwcm9jZXNzLmVudi5DT01UUkFERV9BUElfS0VZID8gJ3JlYWR5JyA6ICdub3RfY29uZmlndXJlZCdcbiAgICAgIH0sXG4gICAgICBzaGlwcG86IHtcbiAgICAgICAgY29uZmlndXJlZDogISFwcm9jZXNzLmVudi5TSElQUE9fQVBJX0tFWSxcbiAgICAgICAgc3RhdHVzOiBwcm9jZXNzLmVudi5TSElQUE9fQVBJX0tFWSA/ICdyZWFkeScgOiAnbm90X2NvbmZpZ3VyZWQnXG4gICAgICB9LFxuICAgICAgYW50aHJvcGljOiB7XG4gICAgICAgIGNvbmZpZ3VyZWQ6ICEhcHJvY2Vzcy5lbnYuQU5USFJPUElDX0FQSV9LRVksXG4gICAgICAgIHN0YXR1czogcHJvY2Vzcy5lbnYuQU5USFJPUElDX0FQSV9LRVkgPyAncmVhZHknIDogJ25vdF9jb25maWd1cmVkJ1xuICAgICAgfSxcbiAgICAgIHN0cmlwZToge1xuICAgICAgICBjb25maWd1cmVkOiAhIXByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZLFxuICAgICAgICBzdGF0dXM6IHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZID8gJ3JlYWR5JyA6ICdub3RfY29uZmlndXJlZCdcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBCdWlsZCBzdGF0dXMgcmVzcG9uc2VcbiAgICBjb25zdCBzdGF0dXMgPSB7XG4gICAgICBzdGF0dXM6ICdvcGVyYXRpb25hbCcsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGVudmlyb25tZW50OiBwcm9jZXNzLmVudi5OT0RFX0VOViB8fCAndW5rbm93bicsXG4gICAgICB2ZXJzaW9uOiBwcm9jZXNzLmVudi5ucG1fcGFja2FnZV92ZXJzaW9uIHx8ICcxLjAuMCcsXG4gICAgICB1cHRpbWU6IGhlYWx0aE1ldHJpY3MudXB0aW1lLFxuICAgICAgc3lzdGVtOiB7XG4gICAgICAgIGRhdGFiYXNlOiBkYXRhYmFzZVN0YXR1cyxcbiAgICAgICAgbWVtb3J5OiBoZWFsdGhNZXRyaWNzLm1lbW9yeSxcbiAgICAgICAgcmVxdWVzdHM6IGhlYWx0aE1ldHJpY3MucmVxdWVzdHMsXG4gICAgICAgIGFsZXJ0czogaGVhbHRoTWV0cmljcy5hY3RpdmVBbGVydHNcbiAgICAgIH0sXG4gICAgICBhcGlzOiBhcGlTdGF0dXMsXG4gICAgICBmZWF0dXJlczoge1xuICAgICAgICBtb25pdG9yaW5nOiAnZW5hYmxlZCcsXG4gICAgICAgIHNlY3VyaXR5OiAnZW5hYmxlZCcsXG4gICAgICAgIGNhY2hpbmc6ICdlbmFibGVkJyxcbiAgICAgICAgbG9nZ2luZzogJ2VuYWJsZWQnXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRGV0ZXJtaW5lIG92ZXJhbGwgc3RhdHVzXG4gICAgY29uc3QgaGFzRXJyb3JzID0gZGF0YWJhc2VTdGF0dXMgPT09ICdlcnJvcicgfHwgXG4gICAgICAgICAgICAgICAgICAgICBoZWFsdGhNZXRyaWNzLnJlcXVlc3RzLmVycm9yUmF0ZSA+IDEwIHx8XG4gICAgICAgICAgICAgICAgICAgICAhcHJvY2Vzcy5lbnYuQU5USFJPUElDX0FQSV9LRVkgfHxcbiAgICAgICAgICAgICAgICAgICAgICFwcm9jZXNzLmVudi5DT01UUkFERV9BUElfS0VZXG5cbiAgICBpZiAoaGFzRXJyb3JzKSB7XG4gICAgICBzdGF0dXMuc3RhdHVzID0gJ2RlZ3JhZGVkJ1xuICAgIH1cblxuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZVxuICAgIGNvbnN0IHN0YXR1c0NvZGUgPSBoYXNFcnJvcnMgPyAyMDAgOiAyMDAgLy8gQWx3YXlzIHJldHVybiAyMDAgZm9yIHN0YXR1cyBlbmRwb2ludFxuICAgIFxuICAgIHRyYWNrQVBJQ2FsbCgnR0VUJywgJy9hcGkvc3RhdHVzJywgZHVyYXRpb24sIHN0YXR1c0NvZGUpXG4gICAgXG4gICAgLy8gbG9nSW5mbygnQVBJIFN0YXR1cyBjaGVjayBjb21wbGV0ZWQnLCB7XG4gICAgLy8gICBzdGF0dXM6IHN0YXR1cy5zdGF0dXMsXG4gICAgLy8gICByZXNwb25zZVRpbWU6IGAke2R1cmF0aW9ufW1zYCxcbiAgICAvLyAgIGRhdGFiYXNlOiBkYXRhYmFzZVN0YXR1c1xuICAgIC8vIH0pXG5cbiAgICByZXMuc3RhdHVzKHN0YXR1c0NvZGUpLmpzb24oc3RhdHVzKVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgXG4gICAgbG9nRXJyb3IoJ0FQSSBTdGF0dXMgZW5kcG9pbnQgZXJyb3InLCB7XG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIHN0YWNrOiBlcnJvci5zdGFjayxcbiAgICAgIHJlc3BvbnNlVGltZTogYCR7ZHVyYXRpb259bXNgLFxuICAgICAgaXA6IFNlY3VyaXR5VmFsaWRhdG9yLmdldENsaWVudElQKHJlcSlcbiAgICB9KVxuXG4gICAgdHJhY2tBUElDYWxsKCdHRVQnLCAnL2FwaS9zdGF0dXMnLCBkdXJhdGlvbiwgNTAwLCBlcnJvcilcblxuICAgIC8vIERvbid0IGV4cG9zZSBpbnRlcm5hbCBlcnJvciBkZXRhaWxzXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBtZXNzYWdlOiAnVW5hYmxlIHRvIHJldHJpZXZlIHN5c3RlbSBzdGF0dXMnXG4gICAgfSlcbiAgfVxufSJdLCJuYW1lcyI6WyJhcHBseVNlY3VyaXR5SGVhZGVycyIsIlNlY3VyaXR5VmFsaWRhdG9yIiwidHJhY2tBUElDYWxsIiwiZ2V0SGVhbHRoTWV0cmljcyIsImxvZ0luZm8iLCJsb2dFcnJvciIsInRlc3RTdXBhYmFzZUNvbm5lY3Rpb24iLCJoYW5kbGVyIiwicmVxIiwicmVzIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsIm1ldGhvZCIsImR1cmF0aW9uIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwibWVzc2FnZSIsImlzU2ltcGxlSGVhbHRoQ2hlY2siLCJxdWVyeSIsInNpbXBsZSIsImhlYWx0aCIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwidmVyc2lvbiIsInByb2Nlc3MiLCJlbnYiLCJucG1fcGFja2FnZV92ZXJzaW9uIiwidXB0aW1lIiwiZW52aXJvbm1lbnQiLCJkYXRhYmFzZVN0YXR1cyIsImRiQ29ubmVjdGVkIiwiaXNzdWVzIiwibWVtVXNhZ2UiLCJtZW1vcnlVc2FnZSIsImRhdGFiYXNlIiwibWVtb3J5X21iIiwiTWF0aCIsInJvdW5kIiwicnNzIiwicmVzcG9uc2VfdGltZV9tcyIsImhlYWx0aE1ldHJpY3MiLCJjb25zb2xlIiwiYXBpU3RhdHVzIiwiY29tdHJhZGUiLCJjb25maWd1cmVkIiwiQ09NVFJBREVfQVBJX0tFWSIsInNoaXBwbyIsIlNISVBQT19BUElfS0VZIiwiYW50aHJvcGljIiwiQU5USFJPUElDX0FQSV9LRVkiLCJzdHJpcGUiLCJTVFJJUEVfU0VDUkVUX0tFWSIsInN5c3RlbSIsIm1lbW9yeSIsInJlcXVlc3RzIiwiYWxlcnRzIiwiYWN0aXZlQWxlcnRzIiwiYXBpcyIsImZlYXR1cmVzIiwibW9uaXRvcmluZyIsInNlY3VyaXR5IiwiY2FjaGluZyIsImxvZ2dpbmciLCJoYXNFcnJvcnMiLCJlcnJvclJhdGUiLCJzdGF0dXNDb2RlIiwic3RhY2siLCJyZXNwb25zZVRpbWUiLCJpcCIsImdldENsaWVudElQIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/status.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fstatus&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cstatus.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();