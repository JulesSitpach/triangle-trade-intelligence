"use strict";(()=>{var e={};e.id=5480,e.ids=[5480],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},855:(e,t,a)=>{a.r(t),a.d(t,{config:()=>u,default:()=>l,routeModule:()=>m});var r={};a.r(r),a.d(r,{default:()=>handler});var s=a(1802),i=a(7153),n=a(6249),o=a(2885),d=a(9475);let c=(0,o.createClient)("https://mrwitpgbcaxgnirqtavt.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function handler(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let{firstName:a,lastName:r,email:s,company:i,title:n,phone:o,businessType:l,importVolume:u,primaryCountry:m,inquiryType:p,message:f,urgency:g,source:_,estimatedSavings:y}=e.body;if(!a||!r||!s||!i||!l||!u)return t.status(400).json({error:"Missing required fields",required:["firstName","lastName","email","company","businessType","importVolume"]});try{(0,d.PN)("Processing enterprise contact request",{company:i,inquiryType:p,importVolume:u,businessType:l,source:_});let{data:e,error:h}=await c.from("enterprise_leads").insert({first_name:a,last_name:r,email:s,company:i,title:n,phone:o,business_type:l,import_volume:u,primary_country:m,inquiry_type:p,message:f,urgency:g,source:_,estimated_savings:y,status:"new",created_at:new Date().toISOString()}).select();if(h)return(0,d.H)("Error saving enterprise lead",{error:h}),t.status(500).json({error:"Failed to save lead information"});let v=function({importVolume:e,businessType:t,urgency:a,inquiryType:r,title:s}){let i;i=0+(({"Under $1M":10,"$1M - $5M":20,"$5M - $25M":30,"$25M - $100M":40,"Over $100M":40})[e]||0)+(({"Electronics & Technology":20,"Automotive & Transportation":18,"Manufacturing & Industrial":16,"Medical & Healthcare":15,"Consumer Goods":12,"Textiles & Apparel":10})[t]||8)+(({immediate:20,fast:15,standard:10})[a]||10)+(({enterprise:10,consultation:8,demo:6})[r]||6);let n=(s||"").toLowerCase();return["ceo","cfo","coo","president","vp","director","head","chief"].some(e=>n.includes(e))?i+=10:n.includes("manager")&&(i+=5),Math.min(i,100)}({importVolume:u,businessType:l,urgency:g,inquiryType:p,title:n});e&&e[0]&&await c.from("enterprise_leads").update({lead_score:v}).eq("id",e[0].id),(v>=80||"immediate"===g)&&await notifySalesTeam({lead:e[0],leadScore:v,estimatedSavings:y}),(0,d.PN)("Enterprise lead captured successfully",{leadId:e[0]?.id,company:i,leadScore:v,estimatedSavings:y}),t.status(200).json({success:!0,message:"Demo request received successfully",leadId:e[0]?.id,estimatedResponse:"immediate"===g?"4-6 hours":"12-24 hours"})}catch(e){(0,d.H)("Contact request processing error",{error:e.message,company:i,email:s}),t.status(500).json({error:"Failed to process contact request",message:"Please try again or contact us directly at enterprise@triangleintelligence.com"})}}async function notifySalesTeam({lead:e,leadScore:t,estimatedSavings:a}){try{(0,d.PN)("High-value lead notification",{leadId:e.id,company:e.company,leadScore:t,estimatedSavings:a,urgency:e.urgency}),await c.from("sales_notifications").insert({lead_id:e.id,notification_type:"high_value_lead",priority:"immediate"===e.urgency?"urgent":"high",message:`High-value lead: ${e.company} (${e.import_volume}) - Score: ${t}`,sent_at:new Date().toISOString()})}catch(t){(0,d.H)("Sales team notification failed",{error:t.message,leadId:e.id})}}let l=(0,n.l)(r,"default"),u=(0,n.l)(r,"config"),m=new s.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/contact-request",pathname:"/api/contact-request",bundlePath:"",filename:""},userland:r})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[4222,9475],()=>__webpack_exec__(855));module.exports=a})();