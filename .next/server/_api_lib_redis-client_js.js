"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_api_lib_redis-client_js";
exports.ids = ["_api_lib_redis-client_js"];
exports.modules = {

/***/ "(api)/./lib/redis-client.js":
/*!*****************************!*\
  !*** ./lib/redis-client.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RedisClient: () => (/* binding */ RedisClient),\n/* harmony export */   checkRedisHealth: () => (/* binding */ checkRedisHealth),\n/* harmony export */   getRedisClient: () => (/* binding */ getRedisClient),\n/* harmony export */   shouldUseFallbackMode: () => (/* binding */ shouldUseFallbackMode),\n/* harmony export */   shutdownRedis: () => (/* binding */ shutdownRedis)\n/* harmony export */ });\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/production-logger.js */ \"(api)/./lib/utils/production-logger.js\");\n/**\n * Redis Client for Triangle Intelligence Platform\n * Handles caching, rate limiting, and session management\n */ \n\nclass RedisClient {\n    constructor(){\n        this.redis = null;\n        this.isConnected = false;\n        this.connectionAttempts = 0;\n        this.maxRetries = 5;\n        this.retryDelayMs = 2000;\n    }\n    /**\n   * Initialize Redis connection with retry logic\n   */ async connect() {\n        if (this.isConnected && this.redis) {\n            return this.redis;\n        }\n        // Check if Redis should be enabled (can be disabled in development)\n        if (process.env.ENABLE_REDIS_RATE_LIMITING === \"false\") {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis rate limiting disabled via environment variable\");\n            throw new Error(\"Redis disabled - using memory fallback\");\n        }\n        let redisConfig;\n        // Use Redis URL if provided (for managed services like Upstash, ElastiCache)\n        if (process.env.REDIS_URL) {\n            redisConfig = {\n                connectionName: \"triangle-intelligence\",\n                retryDelayOnFailover: 100,\n                enableReadyCheck: true,\n                maxRetriesPerRequest: 3,\n                lazyConnect: true,\n                keepAlive: 30000,\n                connectTimeout: 10000,\n                commandTimeout: 5000\n            };\n            this.redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(process.env.REDIS_URL, redisConfig);\n        } else {\n            // Standard host/port configuration\n            redisConfig = {\n                host: process.env.REDIS_HOST || \"localhost\",\n                port: parseInt(process.env.REDIS_PORT || \"6379\"),\n                password: process.env.REDIS_PASSWORD,\n                db: parseInt(process.env.REDIS_DB || \"0\"),\n                connectionName: \"triangle-intelligence\",\n                retryDelayOnFailover: 100,\n                enableReadyCheck: true,\n                maxRetriesPerRequest: 3,\n                lazyConnect: true,\n                keepAlive: 30000,\n                connectTimeout: 10000,\n                commandTimeout: 5000\n            };\n            this.redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(redisConfig);\n        }\n        try {\n            // Event handlers\n            this.redis.on(\"connect\", ()=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis client connected successfully\", {\n                    host: redisConfig.host,\n                    port: redisConfig.port\n                });\n                this.isConnected = true;\n                this.connectionAttempts = 0;\n            });\n            this.redis.on(\"ready\", ()=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis client ready for operations\");\n            });\n            this.redis.on(\"error\", (error)=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Redis connection error\", {\n                    error: error.message,\n                    connectionAttempts: this.connectionAttempts\n                });\n                this.isConnected = false;\n            });\n            this.redis.on(\"close\", ()=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis connection closed\");\n                this.isConnected = false;\n            });\n            this.redis.on(\"reconnecting\", (ms)=>{\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Redis reconnecting\", {\n                    retryIn: ms\n                });\n            });\n            // Test connection\n            await this.redis.connect();\n            await this.redis.ping();\n            return this.redis;\n        } catch (error) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Failed to initialize Redis client\", {\n                error: error.message\n            });\n            this.connectionAttempts++;\n            if (this.connectionAttempts < this.maxRetries) {\n                (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(`Retrying Redis connection in ${this.retryDelayMs}ms`, {\n                    attempt: this.connectionAttempts,\n                    maxRetries: this.maxRetries\n                });\n                await new Promise((resolve)=>setTimeout(resolve, this.retryDelayMs));\n                return this.connect();\n            } else {\n                throw new Error(`Failed to connect to Redis after ${this.maxRetries} attempts: ${error.message}`);\n            }\n        }\n    }\n    /**\n   * Get Redis client (with automatic connection)\n   */ async getClient() {\n        if (!this.isConnected || !this.redis) {\n            await this.connect();\n        }\n        return this.redis;\n    }\n    /**\n   * Graceful shutdown\n   */ async disconnect() {\n        if (this.redis) {\n            (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)(\"Disconnecting Redis client\");\n            await this.redis.quit();\n            this.redis = null;\n            this.isConnected = false;\n        }\n    }\n    /**\n   * Health check\n   */ async healthCheck() {\n        try {\n            const client = await this.getClient();\n            const pong = await client.ping();\n            return {\n                status: \"healthy\",\n                response: pong,\n                connected: this.isConnected\n            };\n        } catch (error) {\n            return {\n                status: \"unhealthy\",\n                error: error.message,\n                connected: false\n            };\n        }\n    }\n    /**\n   * Check if fallback mode should be used\n   */ shouldUseFallback() {\n        // Use fallback if Redis is not available or connection failed too many times\n        return !this.isConnected || this.connectionAttempts >= this.maxRetries;\n    }\n}\n// Singleton instance\nconst redisClient = new RedisClient();\n/**\n * Get Redis client instance (singleton)\n */ async function getRedisClient() {\n    try {\n        return await redisClient.getClient();\n    } catch (error) {\n        (0,_utils_production_logger_js__WEBPACK_IMPORTED_MODULE_1__.logError)(\"Failed to get Redis client\", {\n            error: error.message\n        });\n        throw error;\n    }\n}\n/**\n * Check Redis health\n */ async function checkRedisHealth() {\n    return await redisClient.healthCheck();\n}\n/**\n * Check if should use memory fallback\n */ function shouldUseFallbackMode() {\n    return redisClient.shouldUseFallback();\n}\n/**\n * Graceful shutdown helper\n */ async function shutdownRedis() {\n    await redisClient.disconnect();\n}\n// Export the class for testing\n\n// Handle process shutdown\nprocess.on(\"SIGTERM\", shutdownRedis);\nprocess.on(\"SIGINT\", shutdownRedis);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRSxDQUFDLFVBQVV3QiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyaWFuZ2xlLWludGVsbGlnZW5jZS1wbGF0Zm9ybS8uL2xpYi9yZWRpcy1jbGllbnQuanM/ZjQwZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJlZGlzIENsaWVudCBmb3IgVHJpYW5nbGUgSW50ZWxsaWdlbmNlIFBsYXRmb3JtXG4gKiBIYW5kbGVzIGNhY2hpbmcsIHJhdGUgbGltaXRpbmcsIGFuZCBzZXNzaW9uIG1hbmFnZW1lbnRcbiAqL1xuXG5pbXBvcnQgUmVkaXMgZnJvbSAnaW9yZWRpcydcbmltcG9ydCB7IGxvZ0luZm8sIGxvZ0Vycm9yLCBsb2dEZWJ1ZyB9IGZyb20gJy4vdXRpbHMvcHJvZHVjdGlvbi1sb2dnZXIuanMnXG5cbmNsYXNzIFJlZGlzQ2xpZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yZWRpcyA9IG51bGxcbiAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2VcbiAgICB0aGlzLmNvbm5lY3Rpb25BdHRlbXB0cyA9IDBcbiAgICB0aGlzLm1heFJldHJpZXMgPSA1XG4gICAgdGhpcy5yZXRyeURlbGF5TXMgPSAyMDAwXG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBSZWRpcyBjb25uZWN0aW9uIHdpdGggcmV0cnkgbG9naWNcbiAgICovXG4gIGFzeW5jIGNvbm5lY3QoKSB7XG4gICAgaWYgKHRoaXMuaXNDb25uZWN0ZWQgJiYgdGhpcy5yZWRpcykge1xuICAgICAgcmV0dXJuIHRoaXMucmVkaXNcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBSZWRpcyBzaG91bGQgYmUgZW5hYmxlZCAoY2FuIGJlIGRpc2FibGVkIGluIGRldmVsb3BtZW50KVxuICAgIGlmIChwcm9jZXNzLmVudi5FTkFCTEVfUkVESVNfUkFURV9MSU1JVElORyA9PT0gJ2ZhbHNlJykge1xuICAgICAgbG9nSW5mbygnUmVkaXMgcmF0ZSBsaW1pdGluZyBkaXNhYmxlZCB2aWEgZW52aXJvbm1lbnQgdmFyaWFibGUnKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWRpcyBkaXNhYmxlZCAtIHVzaW5nIG1lbW9yeSBmYWxsYmFjaycpXG4gICAgfVxuXG4gICAgbGV0IHJlZGlzQ29uZmlnXG5cbiAgICAvLyBVc2UgUmVkaXMgVVJMIGlmIHByb3ZpZGVkIChmb3IgbWFuYWdlZCBzZXJ2aWNlcyBsaWtlIFVwc3Rhc2gsIEVsYXN0aUNhY2hlKVxuICAgIGlmIChwcm9jZXNzLmVudi5SRURJU19VUkwpIHtcbiAgICAgIHJlZGlzQ29uZmlnID0ge1xuICAgICAgICBjb25uZWN0aW9uTmFtZTogJ3RyaWFuZ2xlLWludGVsbGlnZW5jZScsXG4gICAgICAgIHJldHJ5RGVsYXlPbkZhaWxvdmVyOiAxMDAsXG4gICAgICAgIGVuYWJsZVJlYWR5Q2hlY2s6IHRydWUsXG4gICAgICAgIG1heFJldHJpZXNQZXJSZXF1ZXN0OiAzLFxuICAgICAgICBsYXp5Q29ubmVjdDogdHJ1ZSxcbiAgICAgICAga2VlcEFsaXZlOiAzMDAwMCxcbiAgICAgICAgY29ubmVjdFRpbWVvdXQ6IDEwMDAwLFxuICAgICAgICBjb21tYW5kVGltZW91dDogNTAwMFxuICAgICAgfVxuICAgICAgdGhpcy5yZWRpcyA9IG5ldyBSZWRpcyhwcm9jZXNzLmVudi5SRURJU19VUkwsIHJlZGlzQ29uZmlnKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTdGFuZGFyZCBob3N0L3BvcnQgY29uZmlndXJhdGlvblxuICAgICAgcmVkaXNDb25maWcgPSB7XG4gICAgICAgIGhvc3Q6IHByb2Nlc3MuZW52LlJFRElTX0hPU1QgfHwgJ2xvY2FsaG9zdCcsXG4gICAgICAgIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52LlJFRElTX1BPUlQgfHwgJzYzNzknKSxcbiAgICAgICAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LlJFRElTX1BBU1NXT1JELFxuICAgICAgICBkYjogcGFyc2VJbnQocHJvY2Vzcy5lbnYuUkVESVNfREIgfHwgJzAnKSxcbiAgICAgICAgY29ubmVjdGlvbk5hbWU6ICd0cmlhbmdsZS1pbnRlbGxpZ2VuY2UnLFxuICAgICAgICByZXRyeURlbGF5T25GYWlsb3ZlcjogMTAwLFxuICAgICAgICBlbmFibGVSZWFkeUNoZWNrOiB0cnVlLFxuICAgICAgICBtYXhSZXRyaWVzUGVyUmVxdWVzdDogMyxcbiAgICAgICAgbGF6eUNvbm5lY3Q6IHRydWUsXG4gICAgICAgIGtlZXBBbGl2ZTogMzAwMDAsXG4gICAgICAgIGNvbm5lY3RUaW1lb3V0OiAxMDAwMCxcbiAgICAgICAgY29tbWFuZFRpbWVvdXQ6IDUwMDBcbiAgICAgIH1cbiAgICAgIHRoaXMucmVkaXMgPSBuZXcgUmVkaXMocmVkaXNDb25maWcpXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEV2ZW50IGhhbmRsZXJzXG4gICAgICB0aGlzLnJlZGlzLm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICAgICAgICBsb2dJbmZvKCdSZWRpcyBjbGllbnQgY29ubmVjdGVkIHN1Y2Nlc3NmdWxseScsIHsgXG4gICAgICAgICAgaG9zdDogcmVkaXNDb25maWcuaG9zdCwgXG4gICAgICAgICAgcG9ydDogcmVkaXNDb25maWcucG9ydCBcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5pc0Nvbm5lY3RlZCA9IHRydWVcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uQXR0ZW1wdHMgPSAwXG4gICAgICB9KVxuXG4gICAgICB0aGlzLnJlZGlzLm9uKCdyZWFkeScsICgpID0+IHtcbiAgICAgICAgbG9nSW5mbygnUmVkaXMgY2xpZW50IHJlYWR5IGZvciBvcGVyYXRpb25zJylcbiAgICAgIH0pXG5cbiAgICAgIHRoaXMucmVkaXMub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7XG4gICAgICAgIGxvZ0Vycm9yKCdSZWRpcyBjb25uZWN0aW9uIGVycm9yJywgeyBcbiAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBjb25uZWN0aW9uQXR0ZW1wdHM6IHRoaXMuY29ubmVjdGlvbkF0dGVtcHRzIFxuICAgICAgICB9KVxuICAgICAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2VcbiAgICAgIH0pXG5cbiAgICAgIHRoaXMucmVkaXMub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICBsb2dJbmZvKCdSZWRpcyBjb25uZWN0aW9uIGNsb3NlZCcpXG4gICAgICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZVxuICAgICAgfSlcblxuICAgICAgdGhpcy5yZWRpcy5vbigncmVjb25uZWN0aW5nJywgKG1zKSA9PiB7XG4gICAgICAgIGxvZ0luZm8oJ1JlZGlzIHJlY29ubmVjdGluZycsIHsgcmV0cnlJbjogbXMgfSlcbiAgICAgIH0pXG5cbiAgICAgIC8vIFRlc3QgY29ubmVjdGlvblxuICAgICAgYXdhaXQgdGhpcy5yZWRpcy5jb25uZWN0KClcbiAgICAgIGF3YWl0IHRoaXMucmVkaXMucGluZygpXG5cbiAgICAgIHJldHVybiB0aGlzLnJlZGlzXG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nRXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIFJlZGlzIGNsaWVudCcsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSlcbiAgICAgIHRoaXMuY29ubmVjdGlvbkF0dGVtcHRzKytcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuY29ubmVjdGlvbkF0dGVtcHRzIDwgdGhpcy5tYXhSZXRyaWVzKSB7XG4gICAgICAgIGxvZ0luZm8oYFJldHJ5aW5nIFJlZGlzIGNvbm5lY3Rpb24gaW4gJHt0aGlzLnJldHJ5RGVsYXlNc31tc2AsIHtcbiAgICAgICAgICBhdHRlbXB0OiB0aGlzLmNvbm5lY3Rpb25BdHRlbXB0cyxcbiAgICAgICAgICBtYXhSZXRyaWVzOiB0aGlzLm1heFJldHJpZXNcbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCB0aGlzLnJldHJ5RGVsYXlNcykpXG4gICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3QoKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY29ubmVjdCB0byBSZWRpcyBhZnRlciAke3RoaXMubWF4UmV0cmllc30gYXR0ZW1wdHM6ICR7ZXJyb3IubWVzc2FnZX1gKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgUmVkaXMgY2xpZW50ICh3aXRoIGF1dG9tYXRpYyBjb25uZWN0aW9uKVxuICAgKi9cbiAgYXN5bmMgZ2V0Q2xpZW50KCkge1xuICAgIGlmICghdGhpcy5pc0Nvbm5lY3RlZCB8fCAhdGhpcy5yZWRpcykge1xuICAgICAgYXdhaXQgdGhpcy5jb25uZWN0KClcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucmVkaXNcbiAgfVxuXG4gIC8qKlxuICAgKiBHcmFjZWZ1bCBzaHV0ZG93blxuICAgKi9cbiAgYXN5bmMgZGlzY29ubmVjdCgpIHtcbiAgICBpZiAodGhpcy5yZWRpcykge1xuICAgICAgbG9nSW5mbygnRGlzY29ubmVjdGluZyBSZWRpcyBjbGllbnQnKVxuICAgICAgYXdhaXQgdGhpcy5yZWRpcy5xdWl0KClcbiAgICAgIHRoaXMucmVkaXMgPSBudWxsXG4gICAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2VcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGVhbHRoIGNoZWNrXG4gICAqL1xuICBhc3luYyBoZWFsdGhDaGVjaygpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgdGhpcy5nZXRDbGllbnQoKVxuICAgICAgY29uc3QgcG9uZyA9IGF3YWl0IGNsaWVudC5waW5nKClcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1czogJ2hlYWx0aHknLFxuICAgICAgICByZXNwb25zZTogcG9uZyxcbiAgICAgICAgY29ubmVjdGVkOiB0aGlzLmlzQ29ubmVjdGVkXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1czogJ3VuaGVhbHRoeScsXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICBjb25uZWN0ZWQ6IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGZhbGxiYWNrIG1vZGUgc2hvdWxkIGJlIHVzZWRcbiAgICovXG4gIHNob3VsZFVzZUZhbGxiYWNrKCkge1xuICAgIC8vIFVzZSBmYWxsYmFjayBpZiBSZWRpcyBpcyBub3QgYXZhaWxhYmxlIG9yIGNvbm5lY3Rpb24gZmFpbGVkIHRvbyBtYW55IHRpbWVzXG4gICAgcmV0dXJuICF0aGlzLmlzQ29ubmVjdGVkIHx8IHRoaXMuY29ubmVjdGlvbkF0dGVtcHRzID49IHRoaXMubWF4UmV0cmllc1xuICB9XG59XG5cbi8vIFNpbmdsZXRvbiBpbnN0YW5jZVxuY29uc3QgcmVkaXNDbGllbnQgPSBuZXcgUmVkaXNDbGllbnQoKVxuXG4vKipcbiAqIEdldCBSZWRpcyBjbGllbnQgaW5zdGFuY2UgKHNpbmdsZXRvbilcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFJlZGlzQ2xpZW50KCkge1xuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCByZWRpc0NsaWVudC5nZXRDbGllbnQoKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ0Vycm9yKCdGYWlsZWQgdG8gZ2V0IFJlZGlzIGNsaWVudCcsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSlcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgUmVkaXMgaGVhbHRoXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1JlZGlzSGVhbHRoKCkge1xuICByZXR1cm4gYXdhaXQgcmVkaXNDbGllbnQuaGVhbHRoQ2hlY2soKVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHNob3VsZCB1c2UgbWVtb3J5IGZhbGxiYWNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRVc2VGYWxsYmFja01vZGUoKSB7XG4gIHJldHVybiByZWRpc0NsaWVudC5zaG91bGRVc2VGYWxsYmFjaygpXG59XG5cbi8qKlxuICogR3JhY2VmdWwgc2h1dGRvd24gaGVscGVyXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaHV0ZG93blJlZGlzKCkge1xuICBhd2FpdCByZWRpc0NsaWVudC5kaXNjb25uZWN0KClcbn1cblxuLy8gRXhwb3J0IHRoZSBjbGFzcyBmb3IgdGVzdGluZ1xuZXhwb3J0IHsgUmVkaXNDbGllbnQgfVxuXG4vLyBIYW5kbGUgcHJvY2VzcyBzaHV0ZG93blxucHJvY2Vzcy5vbignU0lHVEVSTScsIHNodXRkb3duUmVkaXMpXG5wcm9jZXNzLm9uKCdTSUdJTlQnLCBzaHV0ZG93blJlZGlzKSJdLCJuYW1lcyI6WyJSZWRpcyIsImxvZ0luZm8iLCJsb2dFcnJvciIsImxvZ0RlYnVnIiwiUmVkaXNDbGllbnQiLCJjb25zdHJ1Y3RvciIsInJlZGlzIiwiaXNDb25uZWN0ZWQiLCJjb25uZWN0aW9uQXR0ZW1wdHMiLCJtYXhSZXRyaWVzIiwicmV0cnlEZWxheU1zIiwiY29ubmVjdCIsInByb2Nlc3MiLCJlbnYiLCJFTkFCTEVfUkVESVNfUkFURV9MSU1JVElORyIsIkVycm9yIiwicmVkaXNDb25maWciLCJSRURJU19VUkwiLCJjb25uZWN0aW9uTmFtZSIsInJldHJ5RGVsYXlPbkZhaWxvdmVyIiwiZW5hYmxlUmVhZHlDaGVjayIsIm1heFJldHJpZXNQZXJSZXF1ZXN0IiwibGF6eUNvbm5lY3QiLCJrZWVwQWxpdmUiLCJjb25uZWN0VGltZW91dCIsImNvbW1hbmRUaW1lb3V0IiwiaG9zdCIsIlJFRElTX0hPU1QiLCJwb3J0IiwicGFyc2VJbnQiLCJSRURJU19QT1JUIiwicGFzc3dvcmQiLCJSRURJU19QQVNTV09SRCIsImRiIiwiUkVESVNfREIiLCJvbiIsImVycm9yIiwibWVzc2FnZSIsIm1zIiwicmV0cnlJbiIsInBpbmciLCJhdHRlbXB0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZ2V0Q2xpZW50IiwiZGlzY29ubmVjdCIsInF1aXQiLCJoZWFsdGhDaGVjayIsImNsaWVudCIsInBvbmciLCJzdGF0dXMiLCJyZXNwb25zZSIsImNvbm5lY3RlZCIsInNob3VsZFVzZUZhbGxiYWNrIiwicmVkaXNDbGllbnQiLCJnZXRSZWRpc0NsaWVudCIsImNoZWNrUmVkaXNIZWFsdGgiLCJzaG91bGRVc2VGYWxsYmFja01vZGUiLCJzaHV0ZG93blJlZGlzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/redis-client.js\n");

/***/ })

};
;