"use strict";exports.id=4862,exports.ids=[4862],exports.modules={4862:(e,t,n)=>{n.d(t,{ZP:()=>d});var a=n(3309),o=n.n(a),r=n(2885);let s=new(o()),i=(0,r.createClient)("https://mrwitpgbcaxgnirqtavt.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY),c={ustr:{name:"US Trade Representative",url:"https://ustr.gov/rss.xml",keywords:["tariff","duty","China","Mexico","Canada","investigation","301","232","trade war"],priority:"HIGH"},whitehouse:{name:"White House Press Releases",url:"https://www.whitehouse.gov/feed/",keywords:["Trump","tariff","Canada","Mexico","trade deal","USMCA","NAFTA","China"],priority:"CRITICAL"},cbp:{name:"US Customs & Border Protection",url:"https://www.cbp.gov/newsroom/feeds/all-news-releases",keywords:["tariff","duty","trade","import","Canada","Mexico"],priority:"HIGH"},commerce:{name:"Commerce Department News",url:"https://www.commerce.gov/news/all-news/feed",keywords:["trade","tariff","antidumping","countervailing","China","investigation"],priority:"HIGH"}},l={immediate:["effective immediately","emergency","suspended","banned","blocked","urgent","breaking"],tariffs:["tariff","duty","rate","percent","%","antidumping","countervailing","levy","impose"],countries:["China","India","Vietnam","Taiwan","Mexico","Canada","European Union","EU","North Korea"],products:["electronic","solar","panel","automotive","textile","medical","steel","aluminum","lumber","energy"]};async function fetchFeed(e){let t=c[e];try{console.log(`ðŸ“¡ Fetching ${t.name} RSS feed...`);let n=await s.parseURL(t.url);return{source:e,sourceName:t.name,title:n.title,items:n.items||[],fetchedAt:new Date().toISOString()}}catch(e){return console.error(`âŒ Failed to fetch ${t.name}:`,e.message),null}}function analyzeItem(e,t){let n=`${e.title} ${e.contentSnippet||e.content||""}`.toLowerCase(),a={source:t.source,sourceName:t.sourceName,title:e.title,link:e.link,pubDate:e.pubDate||e.isoDate,content:e.contentSnippet||e.content||"",detected:{tariffs:[],countries:[],products:[],deadlines:[],urgencyKeywords:[]},relevanceScore:0,urgencyScore:0};l.tariffs.forEach(e=>{n.includes(e)&&(a.detected.tariffs.push(e),a.relevanceScore+=10)}),l.countries.forEach(e=>{n.includes(e.toLowerCase())&&(a.detected.countries.push(e),a.relevanceScore+=15)}),l.products.forEach(e=>{n.includes(e)&&(a.detected.products.push(e),a.relevanceScore+=8)}),l.immediate.forEach(e=>{n.includes(e)&&(a.detected.urgencyKeywords.push(e),a.urgencyScore+=20)});let o=n.match(/\d+\.?\d*\s*%/g);o&&(a.detected.tariffRates=o,a.relevanceScore+=20);let r=function(e){let t=[],n=e.match(/(january|february|march|april|may|june|july|august|september|october|november|december)\s+\d{1,2}(?:st|nd|rd|th)?(?:,?\s+\d{4})?/gi);n&&t.push(...n);let a=e.match(/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/g);return a&&t.push(...a),t}(n);r.length>0&&(a.detected.deadlines=r,a.urgencyScore+=10);let s=function(e){let t=[],n=e.matchAll(/(?:hs\s*)?(\d{4}(?:\.\d{2})?(?:\.\d{2})?)|chapters?\s+(\d{2})\s*-\s*(\d{2})/gi);for(let e of n)e[1]&&t.push(e[1]),e[2]&&e[3]&&t.push(`Chapters ${e[2]}-${e[3]}`);return t}(n);return(s.length>0&&(a.detected.hsCodes=s,a.relevanceScore+=25),a.relevanceScore>20)?a:null}async function matchToDatabase(e){if(!e.detected.hsCodes||0===e.detected.hsCodes.length)return null;let t=[];for(let n of e.detected.hsCodes){let e=n.replace(/[^\d]/g,"").substring(0,6),{data:a,error:o}=await i.from("trade_flows").select("*").like("hs_code",`${e}%`).limit(10);a&&a.length>0&&t.push({hsCode:e,tradeFlows:a,totalValue:a.reduce((e,t)=>e+(t.trade_value||0),0),affectedRoutes:a.length})}return t.length>0?t:null}async function generateSolutions(e,t){let n=[];for(let a of t){let t={type:"triangle_routing",route:`${e.detected.countries[0]||"Origin"} â†’ Mexico â†’ USA`,description:"USMCA triangle routing via Mexico manufacturing",hsCode:a.hsCode,estimatedSavings:calculateSavings(a.totalValue,e.detected.tariffRates),urgency:e.urgencyScore>30?"HIGH":"MEDIUM",implementation:"Contact Mexican manufacturing partners"},o={type:"triangle_routing",route:`${e.detected.countries[0]||"Origin"} â†’ Canada â†’ USA`,description:"USMCA triangle routing via Canada distribution",hsCode:a.hsCode,estimatedSavings:calculateSavings(a.totalValue,e.detected.tariffRates),urgency:e.urgencyScore>30?"HIGH":"MEDIUM",implementation:"Establish Canadian import entity"};n.push(t,o)}return n}function calculateSavings(e,t){if(!t||0===t.length)return 0;let n=t[0],a=parseFloat(n.replace("%",""))/100;return Math.round(e*a)}async function checkAllFeeds(){console.log("\uD83D\uDE80 Starting Trade Alert Detection...\n");let e=[];for(let t of Object.keys(c)){let n=await fetchFeed(t);if(n&&n.items)for(let t of(console.log(`
ðŸ“° Analyzing ${n.items.length} items from ${n.sourceName}...`),n.items.slice(0,10))){let a=analyzeItem(t,n);if(a){let t=await matchToDatabase(a);t&&(a.databaseMatches=t,a.solutions=await generateSolutions(a,t)),e.push(a),console.log(`
ðŸ”” ALERT DETECTED: ${a.title}`),console.log(`   Relevance: ${a.relevanceScore} | Urgency: ${a.urgencyScore}`),console.log(`   Countries: ${a.detected.countries.join(", ")||"None"}`),console.log(`   Products: ${a.detected.products.join(", ")||"None"}`),console.log(`   HS Codes: ${a.detected.hsCodes?.join(", ")||"None"}`),console.log(`   Tariff Rates: ${a.detected.tariffRates?.join(", ")||"None"}`),a.solutions&&a.solutions.length>0&&console.log(`   ðŸ’¡ SOLUTIONS GENERATED: ${a.solutions.length} triangle routes available`)}}}return console.log(`
âœ… Detection complete. Found ${e.length} relevant alerts.`),e}let d={governmentFeeds:c,fetchFeed,analyzeItem,matchToDatabase,generateSolutions,checkAllFeeds}}};